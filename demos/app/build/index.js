var Xn=Object.defineProperty;var Tt=(t,n)=>{for(var r in n)Xn(t,r,{get:n[r],enumerable:!0,configurable:!0,set:(o)=>n[r]=()=>o})};var _e={};Tt(_e,{state:()=>{{return Jn}},handler:()=>{{return er}},default:()=>{{return nr}},context:()=>{{return tr}},_static:()=>{{return Zn}}});var le={};Tt(le,{default:()=>{{return zn}}});var zn=`
  <section style="{ border: '2px solid gray', margin: '3rem', padding: '15px' }">
    <counter initial=state.initial
              on-update="value => console.log( value )">
      Count till 12
    </counter>

    <counter initial=1>
      Note: 10
    </counter>

    <p>I'm <span text="context.online ? 'Online' : 'Offline'"></span></p>

    <br><br>
    <button on-click="() => state.initial = 10">Reinitialize</button>
    <button title="Undo"
            style="background: black;color: white" 
            on-click="() => self.destroy()">Destroy</button>
    <br>
    <profile></profile>
  </section>
`;var pe={};Tt(pe,{default:()=>{{return Hn}}});var Hn=`
  <section>
    User Account ID: <span @text=input.query.userid></span>
  </section>
`;var de={};Tt(de,{default:()=>{{return Qn}},context:()=>{{return Wn}}});var Wn=["navigate"],Qn=`
  <section>
    <p>Product ID: <span @text=input.params.id></span></p>
    <p>Product Category: <span @text=input.query.category></span></p>

    <br>
    <button on-click(() => context.navigate('/') )>Go home</button>
  </section>
`;var Zn={routes:[{path:"/",template:le,default:!0},{path:"/account",template:pe},{path:"/product/:id",template:de}]},Jn={initial:3},tr=["online"],er={onRouteChange(...t){console.log("Route changed -- ",...t)},onPageNotFound(t){console.log(`<${t}> page not found`)}},nr=`
<main>
  <router routes=static.routes
          global
          on-after(onRouteChange, 'after')
          on-before(onRouteChange, 'before')
          on-not-found(onPageNotFound)></router>
  
  <footer></footer>
</main>
`;var he={};Tt(he,{stylesheet:()=>{{return ur}},state:()=>{{return ar}},handler:()=>{{return or}},default:()=>{{return cr}},context:()=>{{return ir}},_static:()=>{{return rr}}});var rr={limit:12},ir=["lang"],ar={count:0},or={onInput(){this.state.count=Number(this.input.initial)},handleClick(t){if(this.state.count>=this.static.limit)return;this.state.count++,this.emit("update",this.state.count)}},ur=`
  span { font: 14px arial; color: blue; }
`,cr=`
  <div>
    <{input.renderer}/>: 
    <span @text=state.count></span>
    <br>
    <button on-click(handleClick)>
      <span @text="Count"></span>
      (<span @text=context.lang></span>)
    </button>
  </div>
`;var ye={};Tt(ye,{stylesheet:()=>{{return fr}},default:()=>{{return lr}},context:()=>{{return sr}}});var sr=["getUser"],fr=`
  * { font-family: helvetica }
`,lr=`
  <async await( context.getUser, 'Peter Giligous' )>
    <loading>Preloading...</loading>
    <then [response]>
      <div>
        <ul style="{ border: '1px solid black', padding: '15px' }">
          <li @text=response.name></li>
          <li @text=response.email></li>
        </ul>

        <counter initial=5 on-update(value => console.log('procount --', value ))>By</counter>
      </div>
    </then>
    <catch [error]><span @text=error></span></catch>
  </async>
`;var ve={};Tt(ve,{default:()=>{{return dr}},_static:()=>{{return pr}}});var pr={content:"Nexted counter component"},dr=`
  <p>
    <small style="color:gray" @text=static.content>...</small>
  </p>
`;var we=(t)=>{t.register("counter",he),t.register("profile",ye),t.register("footer",ve)};var ot=function(t,n){if(t===n)return!1;if(typeof t!=="object"||typeof n!=="object")return!1;if(t===null||n===null)return!0;if(t instanceof Set){if(!(n instanceof Set))return!0;if(t.size!==n.size)return!0;if(Be(t)&&Be(n)){for(let l of t)if(!n.has(l))return!0;return!1}const c=new WeakMap;for(let l of t){let i=!1;if(typeof l!=="object"){if(n.has(l))i=!0}else for(let d of n){if(typeof d!=="object")continue;if(!c.has(l))c.set(l,new WeakMap);const y=c.get(l);if(y.has(d)){if(i=y.get(d),i)break;continue}const v=!ot(l,d);if(y.set(d,v),v){i=!0;break}}if(!i)return!0}return!1}if(t instanceof Map){if(!(n instanceof Map))return!0;if(t.size!==n.size)return!0;if(Ge(t)&&Ge(n)){for(let[l,i]of t)if(n.get(l)!==i)return!0;return!1}const c=new WeakMap;for(let[l,i]of t){if(typeof l!=="object"){if(!n.has(l))return!0;const v=n.get(l);if(typeof i!=="object"){if(i!==v)return!0;continue}if(typeof v!=="object"||ot(i,v))return!0;continue}let d=!1,y=!1;for(let[v,b]of n){if(typeof v!=="object")continue;if(!c.has(l))c.set(l,new WeakMap);const V=c.get(l);if(V.has(v)){const[R,U]=V.get(v);if(R){d=!0,y=U;break}continue}if(!ot(l,v)){if(d=!0,y=typeof i==="object"&&typeof b==="object"?!ot(i,b):i===b,V.set(v,[!0,y]),y)break}else V.set(v,[!1,!1])}if(!d||!y)return!0}return!1}if(Array.isArray(t)){if(!Array.isArray(n))return!0;if(t.length!==n.length)return!0;for(let c=0;c<t.length;c++){const l=t[c],i=n[c];if(l!==i&&(typeof l!=="object"||ot(l,i)))return!0}return!1}const r=Object.keys(t),o=Object.keys(n);if(r.length!==o.length)return!0;r.sort(),o.sort();const f=r.length;for(let c=0;c<f;c++)if(r[c]!==o[c])return!0;for(let c=0;c<f;c++){const l=r[c],i=t[l],d=n[l];if(i===d)continue;if(i instanceof Date){if(!(d instanceof Date)||String(i)!==String(d))return!0;continue}if(i instanceof RegExp){if(!(d instanceof RegExp)||i.source!==d.source||i.flags!==d.flags)return!0;continue}if(i instanceof Map){if(!(d instanceof Map)||ot(i,d))return!0;continue}if(i instanceof Set){if(!(d instanceof Set)||ot(i,d))return!0;continue}if(i instanceof Function){if(!(d instanceof Function))return!0;continue}if(typeof i==="object"){if(typeof d!=="object")return!0;if(i===t){if(d!==n)return!0}else if(ot(i,d))return!0}else return!0}return!1},Et=function(t,n){if(t===n)return!0;if(t==null||n==null)return t===n;const r=typeof t;if(r!==typeof n)return!1;if(r!=="object"){if(r==="number"&&isNaN(t)&&isNaN(n))return!0;return!1}if(t instanceof Date)return n instanceof Date&&t.getTime()===n.getTime();if(t instanceof RegExp)return n instanceof RegExp&&t.source===n.source&&t.flags===n.flags;if(t instanceof Error)return n instanceof Error&&t.name===n.name&&t.message===n.message&&(t.stack===n.stack||!t.stack&&!n.stack);if(typeof ArrayBuffer!=="undefined"&&ArrayBuffer.isView(t)){if(!ArrayBuffer.isView(n))return!1;if(t.byteLength!==n.byteLength)return!1;const l=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),i=new Uint8Array(n.buffer,n.byteOffset,n.byteLength);for(let d=0;d<l.length;d++)if(l[d]!==i[d])return!1;return!0}if(t instanceof Promise||t instanceof WeakMap||t instanceof WeakSet)return t===n;if(typeof t==="function"){if(typeof n!=="function")return!1;return t.toString()===n.toString()&&t.name===n.name}if(t.constructor!==n.constructor)return!1;if(t instanceof Map||t instanceof Set||Array.isArray(t)||Object.getPrototypeOf(t)===Object.prototype)return!ot(t,n);const o=Object.getPrototypeOf(t);if(o!==Object.getPrototypeOf(n))return!1;const f=Object.getOwnPropertyNames(t),c=Object.getOwnPropertyNames(n);if(f.length!==c.length)return!1;for(let l of f){if(!Object.prototype.hasOwnProperty.call(n,l))return!1;if(!Et(t[l],n[l]))return!1}if(o!==null&&o!==Object.prototype){const l=Object.getOwnPropertyNames(o),i=Object.getOwnPropertyNames(Object.getPrototypeOf(n));if(l.length!==i.length)return!1;for(let d of l){if(d==="constructor")continue;if(!Et(o[d],Object.getPrototypeOf(n)[d]))return!1}}return!0},nt=function(t,n=new WeakMap){if(t===null||typeof t!=="object"||t instanceof Promise)return t;if(n.has(t))return n.get(t);if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp)return new RegExp(t.source,t.flags);if(t instanceof Map){const f=new Map;return n.set(t,f),t.forEach((c,l)=>f.set(nt(l,n),nt(c,n))),f}if(t instanceof Set){const f=new Set;return n.set(t,f),t.forEach((c)=>f.add(nt(c,n))),f}if(Array.isArray(t)){const f=[];n.set(t,f);for(let c=0;c<t.length;c++)f[c]=nt(t[c],n);return f}if(ArrayBuffer.isView(t))return new t.constructor(t);const r=Object.create(Object.getPrototypeOf(t));n.set(t,r);const o=Object.getOwnPropertySymbols(t);for(let f of o)r[f]=nt(t[f],n);for(let f in t)if(Object.prototype.hasOwnProperty.call(t,f))r[f]=nt(t[f],n);return r},kr=function(t,n){if(!t||typeof t!=="object")throw new TypeError("Original argument must be an object");if(!n||typeof n!=="object")throw new TypeError("ToSet argument must be an object");if(!Object.keys(n).length)return{...t};function r(f,c,l){const i=c.split(/\.|\[|\]/).filter(Boolean);let d=f;for(let y=0;y<i.length;y++){const v=i[y],b=!isNaN(Number(v)),V=y===i.length-1,R=!isNaN(Number(i[y+1]));if(V){d[v]=l;continue}if(!(v in d))d[v]=R?[]:{};else if(R&&!Array.isArray(d[v]))d[v]=[];else if(!R&&Array.isArray(d[v]))d[v]={};d=d[v]}}const o=nt(t);try{for(let[f,c]of Object.entries(n)){if(typeof f!=="string")throw new TypeError(`Invalid path: ${f}`);if(!/^[a-zA-Z0-9_\-\[\].]+$/.test(f))throw new Error(`Invalid path format: ${f}`);r(o,f,c)}}catch(f){throw new Error(`Failed to assign value: ${f.message}`)}return o},un=function(t){return t.trim()},qt=function(t,n,r){return t.replace(n,r)},Er=function(t,n,r){return t.indexOf(n,r)},Dt=function(t,n){return t.charCodeAt(n)|0},Vt=function(t,n,r){return t.slice(n,r)},mt=function(t){return t.length},cn=function(t){return t.length},Gt=function(t,n){return n.push(t),t},xe=function(t,n,r,o,f,c,l,i){return{value:t,root:n,parent:r,type:o,props:f,children:c,line:Jt,column:Lt,length:l,return:"",siblings:i}},Pr=function(){return tt},Rr=function(){if(tt=dt>0?Dt(Ot,--dt):0,Lt--,tt===10)Lt=1,Jt--;return tt},yt=function(){if(tt=dt<fn?Dt(Ot,dt++):0,Lt++,tt===10)Lt=1,Jt++;return tt},xt=function(){return Dt(Ot,dt)},Yt=function(){return dt},Zt=function(t,n){return Vt(Ot,t,n)},Ft=function(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0},Nr=function(t){return Jt=Lt=1,fn=mt(Ot=t),dt=0,[]},jr=function(t){return Ot="",t},ge=function(t){return un(Zt(dt-1,be(t===91?t+2:t===40?t+1:t)))},Sr=function(t){while(tt=xt())if(tt<33)yt();else break;return Ft(t)>2||Ft(tt)>3?"":" "},Dr=function(t,n){while(--n&&yt())if(tt<48||tt>102||tt>57&&tt<65||tt>70&&tt<97)break;return Zt(t,Yt()+(n<6&&xt()==32&&yt()==32))},be=function(t){while(yt())switch(tt){case t:return dt;case 34:case 39:if(t!==34&&t!==39)be(tt);break;case 40:if(t===41)be(t);break;case 92:yt();break}return dt},Vr=function(t,n){while(yt())if(t+tt===57)break;else if(t+tt===84&&xt()===47)break;return"/*"+Zt(n,dt-1)+"*"+$e(t===47?t:yt())},Lr=function(t){while(!Ft(xt()))yt();return Zt(t,dt)},Or=function(t){return jr(Xt("",null,null,null,[""],t=Nr(t),0,[0],t))},Xt=function(t,n,r,o,f,c,l,i,d){var y=0,v=0,b=l,V=0,R=0,U=0,q=1,et=1,H=1,X=0,w="",F=f,K=c,x=o,S=w;while(et)switch(U=X,X=yt()){case 40:if(U!=108&&Dt(S,b-1)==58){if(Er(S+=qt(ge(X),"&","&\f"),"&\f",sn(y?i[y-1]:0))!=-1)H=-1;break}case 34:case 39:case 91:S+=ge(X);break;case 9:case 10:case 13:case 32:S+=Sr(U);break;case 92:S+=Dr(Yt()-1,7);continue;case 47:switch(xt()){case 42:case 47:if(Gt(Ir(Vr(yt(),Yt()),n,r,d),d),(Ft(U||1)==5||Ft(xt()||1)==5)&&mt(S)&&Vt(S,-1,void 0)!==" ")S+=" ";break;default:S+="/"}break;case 123*q:i[y++]=mt(S)*H;case 125*q:case 59:case 0:switch(X){case 0:case 125:et=0;case 59+v:if(H==-1)S=qt(S,/\f/g,"");if(R>0&&(mt(S)-b||q===0&&U===47))Gt(R>32?Ye(S+";",o,r,b-1,d):Ye(qt(S," ","")+";",o,r,b-2,d),d);break;case 59:S+=";";default:if(Gt(x=qe(S,n,r,y,v,f,i,w,F=[],K=[],b,c),c),X===123)if(v===0)Xt(S,n,x,x,F,c,b,i,K);else{switch(V){case 99:if(Dt(S,3)===110)break;case 108:if(Dt(S,2)===97)break;default:v=0;case 100:case 109:case 115:}if(v)Xt(t,x,x,o&&Gt(qe(t,x,x,0,0,f,i,w,f,F=[],b,K),K),f,K,b,i,o?F:K);else Xt(S,x,x,x,[""],K,0,i,K)}}y=v=R=0,q=H=1,w=S="",b=l;break;case 58:b=1+mt(S),R=U;default:if(q<1){if(X==123)--q;else if(X==125&&q++==0&&Rr()==125)continue}switch(S+=$e(X),X*q){case 38:H=v>0?1:(S+="\f",-1);break;case 44:i[y++]=(mt(S)-1)*H,H=1;break;case 64:if(xt()===45)S+=ge(yt());V=xt(),v=b=mt(w=S+=Lr(Yt())),X++;break;case 45:if(U===45&&mt(S)==2)q=0}}return c},qe=function(t,n,r,o,f,c,l,i,d,y,v,b){var V=f-1,R=f===0?c:[""],U=cn(R);for(var q=0,et=0,H=0;q<o;++q)for(var X=0,w=Vt(t,V+1,V=sn(et=l[q])),F=t;X<U;++X)if(F=un(et>0?R[X]+" "+w:qt(w,/&\f/g,R[X])))d[H++]=F;return xe(t,n,r,f===0?an:i,d,y,v,b)},Ir=function(t,n,r,o){return xe(t,n,r,rn,$e(Pr()),Vt(t,2,-2),0,o)},Ye=function(t,n,r,o,f){return xe(t,n,r,on,Vt(t,0,o),Vt(t,o+1,-1),o,f)},Ae=function(t,n){var r="";for(var o=0;o<t.length;o++)r+=n(t[o],o,t,n)||"";return r},Mr=function(t,n,r,o){switch(t.type){case Tr:if(t.children.length)break;case $r:case xr:case on:return t.return=t.return||t.value;case rn:return"";case Cr:return t.return=t.value+"{"+Ae(t.children,o)+"}";case an:if(!mt(t.value=t.props.join(",")))return""}return mt(r=Ae(t.children,o))?t.return=t.value+"{"+r+"}":""},Fr=function(t){var n=cn(t);return function(r,o,f,c){var l="";for(var i=0;i<n;i++)l+=t[i](r,o,f,c)||"";return l}},Gr=function(t){if(/\bstate\.|\binput\.|\bself\.|\bcontext\./.test(t))return!0;if(/[\+\*\/\%\(\)\{\}\[\]]|\?\s*:/.test(t))return!0;if(/\b[a-zA-Z_][a-zA-Z0-9_]*\.[a-zA-Z_]/.test(t))return!0;if(t.includes("{")&&t.includes("}"))return!0;return!1},Xe=function(t){let n=(t||"").trim().replace(/>\s*</g,"><").replace(/\s{2,}/g," ").replace(/[\r\n\t]/g,"").replace(/<([a-zA-Z0-9_-]+)([^>]*?)\s*\/>/g,"<$1$2></$1>").replace(/<\{([^}]+)\}\s*(.*?)\/>/g,'<lips dtag="$1" $2></lips>').replace(/(<>)([\s\S]*?)(<\/>)/g,'<lips fragment="true">$2</lips>').replace(/<if\(\s*(.*?)\s*\)>/g,'<if @by="$1">').replace(/<else-if\(\s*(.*?)\s*\)>/g,'<else-if @by="$1">').replace(/<switch\(\s*(.*?)\s*\)>/g,'<switch @by="$1">').replace(/<async await\(\s*(.*?)\s*\)>/g,`<async ${kt}await="$1">`).replace(/<log\(\s*(.*?)\s*\)>/g,'<log @args="$1">').replace(/\[(.*?)\]/g,(r)=>r.replace(/\s+/g,""));return n=Kr(n),n=wr(n),n},zt=function(t,n={maxSize:100}){const r=new Set,o=[{value:t,timestamp:Date.now()}];let f=0;const c=()=>{const i=Ht[Ht.length-1];return i&&qr(i,r),o[f].value},l=()=>{const i=[...r];if(He)for(let d of i)He.add(d);else for(let d of i)d.execute()};return[c,(i,d)=>{if(Object.is(o[f].value,i))return;if(f<o.length-1)o.splice(f+1);if(o.push({value:i,timestamp:Date.now(),metadata:d}),o.length>n.maxSize)o.shift(),f=Math.max(0,f-1);else f++;l()},{undo(){if(f>0)f--,l()},redo(){if(f<o.length-1)f++,l()},jumpTo(i){if(i>=0&&i<o.length&&i!==f)f=i,l()},getHistory(){return[...o]},getCurrentIndex(){return f},canUndo(){return f>0},canRedo(){return f<o.length-1},clear(){const i=o[0];o.length=0,o.push(i),f=0,l()}}]},pn=function(t){let n=!1;const r=()=>{if(n)throw new Error("Circular dependency detected");if(o.isDisposed)return;n=!0,ze(o),Ht.push(o);try{t()}finally{n=!1,Ht.pop()}},o={execute:r,dependencies:new Set,isDisposed:!1};return r(),{dispose:()=>{o.isDisposed=!0,ze(o)}}},_r=Object.create,{defineProperty:ke,getPrototypeOf:hr,getOwnPropertyNames:yr}=Object,vr=Object.prototype.hasOwnProperty,Wt=(t,n,r)=>{r=t!=null?_r(hr(t)):{};const o=n||!t||!t.__esModule?ke(r,"default",{value:t,enumerable:!0}):r;for(let f of yr(t))if(!vr.call(o,f))ke(o,f,{get:()=>t[f],enumerable:!0});return o},mr=(t,n)=>()=>(n||t((n={exports:{}}).exports,n),n.exports),Kt=(t,n)=>{for(var r in n)ke(t,r,{get:n[r],enumerable:!0,configurable:!0,set:(o)=>n[r]=()=>o})},Qt=mr((t,n)=>{(function(){var r=document,o=window,f=r.documentElement,c=r.createElement.bind(r),l=c("div"),i=c("table"),d=c("tbody"),y=c("tr"),v=Array.isArray,b=Array.prototype,V=b.concat,R=b.filter,U=b.indexOf,q=b.map,et=b.push,H=b.slice,X=b.some,w=b.splice,F=/^#(?:[\w-]|\\.|[^\x00-\xa0])*$/,K=/^\.(?:[\w-]|\\.|[^\x00-\xa0])*$/,x=/<.+>/,S=/^\w+$/;function p(e,a){var u=N(a);return!e||!u&&!G(a)&&!$(a)?[]:!u&&K.test(e)?a.getElementsByClassName(e.slice(1).replace(/\\/g,"")):!u&&S.test(e)?a.getElementsByTagName(e):a.querySelectorAll(e)}var j=function(){function e(a,u){if(!a)return;if(P(a))return a;var _=a;if(E(a)){var m=u||r;if(_=F.test(a)&&G(m)?m.getElementById(a.slice(1).replace(/\\/g,"")):x.test(a)?Pe(a):P(m)?m.find(a):E(m)?h(m).find(a):p(a,m),!_)return}else if(D(a))return this.ready(a);if(_.nodeType||_===o)_=[_];this.length=_.length;for(var A=0,L=this.length;A<L;A++)this[A]=_[A]}return e.prototype.init=function(a,u){return new e(a,u)},e}(),s=j.prototype,h=s.init;if(h.fn=h.prototype=s,s.length=0,s.splice=w,typeof Symbol==="function")s[Symbol.iterator]=b[Symbol.iterator];function P(e){return e instanceof j}function T(e){return!!e&&e===e.window}function G(e){return!!e&&e.nodeType===9}function N(e){return!!e&&e.nodeType===11}function $(e){return!!e&&e.nodeType===1}function O(e){return!!e&&e.nodeType===3}function C(e){return typeof e==="boolean"}function D(e){return typeof e==="function"}function E(e){return typeof e==="string"}function k(e){return e===void 0}function g(e){return e===null}function I(e){return!isNaN(parseFloat(e))&&isFinite(e)}function z(e){if(typeof e!=="object"||e===null)return!1;var a=Object.getPrototypeOf(e);return a===null||a===Object.prototype}h.isWindow=T,h.isFunction=D,h.isArray=v,h.isNumeric=I,h.isPlainObject=z;function M(e,a,u){if(u){var _=e.length;while(_--)if(a.call(e[_],_,e[_])===!1)return e}else if(z(e)){var m=Object.keys(e);for(var _=0,A=m.length;_<A;_++){var L=m[_];if(a.call(e[L],L,e[L])===!1)return e}}else for(var _=0,A=e.length;_<A;_++)if(a.call(e[_],_,e[_])===!1)return e;return e}h.each=M,s.each=function(e){return M(this,e)},s.empty=function(){return this.each(function(e,a){while(a.firstChild)a.removeChild(a.firstChild)})};function Y(){var e=[];for(var a=0;a<arguments.length;a++)e[a]=arguments[a];var u=C(e[0])?e.shift():!1,_=e.shift(),m=e.length;if(!_)return{};if(!m)return Y(u,h,_);for(var A=0;A<m;A++){var L=e[A];for(var B in L)if(u&&(v(L[B])||z(L[B]))){if(!_[B]||_[B].constructor!==L[B].constructor)_[B]=new L[B].constructor;Y(u,_[B],L[B])}else _[B]=L[B]}return _}h.extend=Y,s.extend=function(e){return Y(s,e)};var W=/\S+/g;function ut(e){return E(e)?e.match(W)||[]:[]}s.toggleClass=function(e,a){var u=ut(e),_=!k(a);return this.each(function(m,A){if(!$(A))return;M(u,function(L,B){if(_)a?A.classList.add(B):A.classList.remove(B);else A.classList.toggle(B)})})},s.addClass=function(e){return this.toggleClass(e,!0)},s.removeAttr=function(e){var a=ut(e);return this.each(function(u,_){if(!$(_))return;M(a,function(m,A){_.removeAttribute(A)})})};function Z(e,a){if(!e)return;if(E(e)){if(arguments.length<2){if(!this[0]||!$(this[0]))return;var u=this[0].getAttribute(e);return g(u)?void 0:u}if(k(a))return this;if(g(a))return this.removeAttr(e);return this.each(function(m,A){if(!$(A))return;A.setAttribute(e,a)})}for(var _ in e)this.attr(_,e[_]);return this}s.attr=Z,s.removeClass=function(e){if(arguments.length)return this.toggleClass(e,!1);return this.attr("class","")},s.hasClass=function(e){return!!e&&X.call(this,function(a){return $(a)&&a.classList.contains(e)})},s.get=function(e){if(k(e))return H.call(this);return e=Number(e),this[e<0?e+this.length:e]},s.eq=function(e){return h(this.get(e))},s.first=function(){return this.eq(0)},s.last=function(){return this.eq(-1)};function it(e){if(k(e))return this.get().map(function(a){return $(a)||O(a)?a.textContent:""}).join("");return this.each(function(a,u){if(!$(u))return;u.textContent=e})}s.text=it;function ct(e,a,u){if(!$(e))return;var _=o.getComputedStyle(e,null);return u?_.getPropertyValue(a)||void 0:_[a]||e.style[a]}function st(e,a){return parseInt(ct(e,a),10)||0}function Rt(e,a){return st(e,"border".concat(a?"Left":"Top","Width"))+st(e,"padding".concat(a?"Left":"Top"))+st(e,"padding".concat(a?"Right":"Bottom"))+st(e,"border".concat(a?"Right":"Bottom","Width"))}var pt={};function Nt(e){if(pt[e])return pt[e];var a=c(e);r.body.insertBefore(a,null);var u=ct(a,"display");return r.body.removeChild(a),pt[e]=u!=="none"?u:"block"}function jt(e){return ct(e,"display")==="none"}function It(e,a){var u=e&&(e.matches||e.webkitMatchesSelector||e.msMatchesSelector);return!!u&&!!a&&u.call(e,a)}function wt(e){return E(e)?function(a,u){return It(u,e)}:D(e)?e:P(e)?function(a,u){return e.is(u)}:!e?function(){return!1}:function(a,u){return u===e}}s.filter=function(e){var a=wt(e);return h(R.call(this,function(u,_){return a.call(u,_,u)}))};function bt(e,a){return!a?e:e.filter(a)}s.detach=function(e){return bt(this,e).each(function(a,u){if(u.parentNode)u.parentNode.removeChild(u)}),this};var kn=/^\s*<(\w+)[^>]*>/,bn=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,Ee={"*":l,tr:d,td:y,th:y,thead:i,tbody:i,tfoot:i};function Pe(e){if(!E(e))return[];if(bn.test(e))return[c(RegExp.$1)];var a=kn.test(e)&&RegExp.$1,u=Ee[a]||Ee["*"];return u.innerHTML=e,h(u.childNodes).detach().get()}h.parseHTML=Pe,s.has=function(e){var a=E(e)?function(u,_){return p(e,_).length}:function(u,_){return _.contains(e)};return this.filter(a)},s.not=function(e){var a=wt(e);return this.filter(function(u,_){return(!E(e)||$(_))&&!a.call(_,u,_)})};function gt(e,a,u,_){var m=[],A=D(a),L=_&&wt(_);for(var B=0,_t=e.length;B<_t;B++)if(A){var rt=a(e[B]);if(rt.length)et.apply(m,rt)}else{var ft=e[B][a];while(ft!=null){if(_&&L(-1,ft))break;m.push(ft),ft=u?ft[a]:null}}return m}function Re(e){if(e.multiple&&e.options)return gt(R.call(e.options,function(a){return a.selected&&!a.disabled&&!a.parentNode.disabled}),"value");return e.value||""}function An(e){if(!arguments.length)return this[0]&&Re(this[0]);return this.each(function(a,u){var _=u.multiple&&u.options;if(_||Ke.test(u.type)){var m=v(e)?q.call(e,String):g(e)?[]:[String(e)];if(_)M(u.options,function(A,L){L.selected=m.indexOf(L.value)>=0},!0);else u.checked=m.indexOf(u.value)>=0}else u.value=k(e)||g(e)?"":e})}s.val=An,s.is=function(e){var a=wt(e);return X.call(this,function(u,_){return a.call(u,_,u)})},h.guid=1;function vt(e){return e.length>1?R.call(e,function(a,u,_){return U.call(_,a)===u}):e}h.unique=vt,s.add=function(e,a){return h(vt(this.get().concat(h(e,a).get())))},s.children=function(e){return bt(h(vt(gt(this,function(a){return a.children}))),e)},s.parent=function(e){return bt(h(vt(gt(this,"parentNode"))),e)},s.index=function(e){var a=e?h(e)[0]:this[0],u=e?this:h(a).parent().children();return U.call(u,a)},s.closest=function(e){var a=this.filter(e);if(a.length)return a;var u=this.parent();if(!u.length)return a;return u.closest(e)},s.siblings=function(e){return bt(h(vt(gt(this,function(a){return h(a).parent().children().not(a)}))),e)},s.find=function(e){return h(vt(gt(this,function(a){return p(e,a)})))};var $n=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,xn=/^$|^module$|\/(java|ecma)script/i,Cn=["type","src","nonce","noModule"];function Tn(e,a){var u=h(e);u.filter("script").add(u.find("script")).each(function(_,m){if(xn.test(m.type)&&f.contains(m)){var A=c("script");A.text=m.textContent.replace($n,""),M(Cn,function(L,B){if(m[B])A[B]=m[B]}),a.head.insertBefore(A,null),a.head.removeChild(A)}})}function En(e,a,u,_,m){if(_)e.insertBefore(a,u?e.firstChild:null);else if(e.nodeName==="HTML")e.parentNode.replaceChild(a,e);else e.parentNode.insertBefore(a,u?e:e.nextSibling);if(m)Tn(a,e.ownerDocument)}function At(e,a,u,_,m,A,L,B){return M(e,function(_t,rt){M(h(rt),function(ft,Ct){M(h(a),function(ht,Bt){var ue=u?Ct:Bt,ce=u?Bt:Ct,lt=u?ft:ht;En(ue,!lt?ce:ce.cloneNode(!0),_,m,!lt)},B)},L)},A),a}s.after=function(){return At(arguments,this,!1,!1,!1,!0,!0)},s.append=function(){return At(arguments,this,!1,!1,!0)};function Pn(e){if(!arguments.length)return this[0]&&this[0].innerHTML;if(k(e))return this;var a=/<script[\s>]/.test(e);return this.each(function(u,_){if(!$(_))return;if(a)h(_).empty().append(e);else _.innerHTML=e})}s.html=Pn,s.appendTo=function(e){return At(arguments,this,!0,!1,!0)},s.wrapInner=function(e){return this.each(function(a,u){var _=h(u),m=_.contents();m.length?m.wrapAll(e):_.append(e)})},s.before=function(){return At(arguments,this,!1,!0)},s.wrapAll=function(e){var a=h(e),u=a[0];while(u.children.length)u=u.firstElementChild;return this.first().before(a),this.appendTo(u)},s.wrap=function(e){return this.each(function(a,u){var _=h(e)[0];h(u).wrapAll(!a?_:_.cloneNode(!0))})},s.insertAfter=function(e){return At(arguments,this,!0,!1,!1,!1,!1,!0)},s.insertBefore=function(e){return At(arguments,this,!0,!0)},s.prepend=function(){return At(arguments,this,!1,!0,!0,!0,!0)},s.prependTo=function(e){return At(arguments,this,!0,!0,!0,!1,!1,!0)},s.contents=function(){return h(vt(gt(this,function(e){return e.tagName==="IFRAME"?[e.contentDocument]:e.tagName==="TEMPLATE"?e.content.childNodes:e.childNodes})))},s.next=function(e,a,u){return bt(h(vt(gt(this,"nextElementSibling",a,u))),e)},s.nextAll=function(e){return this.next(e,!0)},s.nextUntil=function(e,a){return this.next(a,!0,e)},s.parents=function(e,a){return bt(h(vt(gt(this,"parentElement",!0,a))),e)},s.parentsUntil=function(e,a){return this.parents(a,e)},s.prev=function(e,a,u){return bt(h(vt(gt(this,"previousElementSibling",a,u))),e)},s.prevAll=function(e){return this.prev(e,!0)},s.prevUntil=function(e,a){return this.prev(a,!0,e)},s.map=function(e){return h(V.apply([],q.call(this,function(a,u){return e.call(a,u,a)})))},s.clone=function(){return this.map(function(e,a){return a.cloneNode(!0)})},s.offsetParent=function(){return this.map(function(e,a){var u=a.offsetParent;while(u&&ct(u,"position")==="static")u=u.offsetParent;return u||f})},s.slice=function(e,a){return h(H.call(this,e,a))};var Rn=/-([a-z])/g;function te(e){return e.replace(Rn,function(a,u){return u.toUpperCase()})}s.ready=function(e){var a=function(){return setTimeout(e,0,h)};if(r.readyState!=="loading")a();else r.addEventListener("DOMContentLoaded",a);return this},s.unwrap=function(){return this.parent().each(function(e,a){if(a.tagName==="BODY")return;var u=h(a);u.replaceWith(u.children())}),this},s.offset=function(){var e=this[0];if(!e)return;var a=e.getBoundingClientRect();return{top:a.top+o.pageYOffset,left:a.left+o.pageXOffset}},s.position=function(){var e=this[0];if(!e)return;var a=ct(e,"position")==="fixed",u=a?e.getBoundingClientRect():this.offset();if(!a){var _=e.ownerDocument,m=e.offsetParent||_.documentElement;while((m===_.body||m===_.documentElement)&&ct(m,"position")==="static")m=m.parentNode;if(m!==e&&$(m)){var A=h(m).offset();u.top-=A.top+st(m,"borderTopWidth"),u.left-=A.left+st(m,"borderLeftWidth")}}return{top:u.top-st(e,"marginTop"),left:u.left-st(e,"marginLeft")}};var Ne={class:"className",contenteditable:"contentEditable",for:"htmlFor",readonly:"readOnly",maxlength:"maxLength",tabindex:"tabIndex",colspan:"colSpan",rowspan:"rowSpan",usemap:"useMap"};s.prop=function(e,a){if(!e)return;if(E(e)){if(e=Ne[e]||e,arguments.length<2)return this[0]&&this[0][e];return this.each(function(_,m){m[e]=a})}for(var u in e)this.prop(u,e[u]);return this},s.removeProp=function(e){return this.each(function(a,u){delete u[Ne[e]||e]})};var Nn=/^--/;function ee(e){return Nn.test(e)}var ne={},jn=l.style,Sn=["webkit","moz","ms"];function Dn(e,a){if(a===void 0)a=ee(e);if(a)return e;if(!ne[e]){var u=te(e),_="".concat(u[0].toUpperCase()).concat(u.slice(1)),m="".concat(u," ").concat(Sn.join("".concat(_," "))).concat(_).split(" ");M(m,function(A,L){if(L in jn)return ne[e]=L,!1})}return ne[e]}var Vn={animationIterationCount:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0};function je(e,a,u){if(u===void 0)u=ee(e);return!u&&!Vn[e]&&I(a)?"".concat(a,"px"):a}function Ln(e,a){if(E(e)){var u=ee(e);if(e=Dn(e,u),arguments.length<2)return this[0]&&ct(this[0],e,u);if(!e)return this;return a=je(e,a,u),this.each(function(m,A){if(!$(A))return;if(u)A.style.setProperty(e,a);else A.style[e]=a})}for(var _ in e)this.css(_,e[_]);return this}s.css=Ln;function Se(e,a){try{return e(a)}catch(u){return a}}var On=/^\s+|\s+$/;function De(e,a){var u=e.dataset[a]||e.dataset[te(a)];if(On.test(u))return u;return Se(JSON.parse,u)}function In(e,a,u){u=Se(JSON.stringify,u),e.dataset[te(a)]=u}function Mn(e,a){if(!e){if(!this[0])return;var u={};for(var _ in this[0].dataset)u[_]=De(this[0],_);return u}if(E(e)){if(arguments.length<2)return this[0]&&De(this[0],e);if(k(a))return this;return this.each(function(m,A){In(A,e,a)})}for(var _ in e)this.data(_,e[_]);return this}s.data=Mn;function Ve(e,a){var u=e.documentElement;return Math.max(e.body["scroll".concat(a)],u["scroll".concat(a)],e.body["offset".concat(a)],u["offset".concat(a)],u["client".concat(a)])}M([!0,!1],function(e,a){M(["Width","Height"],function(u,_){var m="".concat(a?"outer":"inner").concat(_);s[m]=function(A){if(!this[0])return;if(T(this[0]))return a?this[0]["inner".concat(_)]:this[0].document.documentElement["client".concat(_)];if(G(this[0]))return Ve(this[0],_);return this[0]["".concat(a?"offset":"client").concat(_)]+(A&&a?st(this[0],"margin".concat(u?"Top":"Left"))+st(this[0],"margin".concat(u?"Bottom":"Right")):0)}})}),M(["Width","Height"],function(e,a){var u=a.toLowerCase();s[u]=function(_){if(!this[0])return k(_)?void 0:this;if(!arguments.length){if(T(this[0]))return this[0].document.documentElement["client".concat(a)];if(G(this[0]))return Ve(this[0],a);return this[0].getBoundingClientRect()[u]-Rt(this[0],!e)}var m=parseInt(_,10);return this.each(function(A,L){if(!$(L))return;var B=ct(L,"boxSizing");L.style[u]=je(u,m+(B==="border-box"?Rt(L,!e):0))})}});var Le="___cd";s.toggle=function(e){return this.each(function(a,u){if(!$(u))return;var _=jt(u),m=k(e)?_:e;if(m){if(u.style.display=u[Le]||"",jt(u))u.style.display=Nt(u.tagName)}else if(!_)u[Le]=ct(u,"display"),u.style.display="none"})},s.hide=function(){return this.toggle(!1)},s.show=function(){return this.toggle(!0)};var Oe="___ce",re=".",ie={focus:"focusin",blur:"focusout"},Ie={mouseenter:"mouseover",mouseleave:"mouseout"},Fn=/^(mouse|pointer|contextmenu|drag|drop|click|dblclick)/i;function ae(e){return Ie[e]||ie[e]||e}function oe(e){var a=e.split(re);return[a[0],a.slice(1).sort()]}s.trigger=function(e,a){if(E(e)){var u=oe(e),_=u[0],m=u[1],A=ae(_);if(!A)return this;var L=Fn.test(A)?"MouseEvents":"HTMLEvents";e=r.createEvent(L),e.initEvent(A,!0,!0),e.namespace=m.join(re),e.___ot=_}e.___td=a;var B=e.___ot in ie;return this.each(function(_t,rt){if(B&&D(rt[e.___ot]))rt["___i".concat(e.type)]=!0,rt[e.___ot](),rt["___i".concat(e.type)]=!1;rt.dispatchEvent(e)})};function Me(e){return e[Oe]=e[Oe]||{}}function Kn(e,a,u,_,m){var A=Me(e);A[a]=A[a]||[],A[a].push([u,_,m]),e.addEventListener(a,m)}function Fe(e,a){return!a||!X.call(a,function(u){return e.indexOf(u)<0})}function Ut(e,a,u,_,m){var A=Me(e);if(!a)for(a in A)Ut(e,a,u,_,m);else if(A[a])A[a]=A[a].filter(function(L){var B=L[0],_t=L[1],rt=L[2];if(m&&rt.guid!==m.guid||!Fe(B,u)||_&&_!==_t)return!0;e.removeEventListener(a,rt)})}s.off=function(e,a,u){var _=this;if(k(e))this.each(function(A,L){if(!$(L)&&!G(L)&&!T(L))return;Ut(L)});else if(!E(e))for(var m in e)this.off(m,e[m]);else{if(D(a))u=a,a="";M(ut(e),function(A,L){var B=oe(L),_t=B[0],rt=B[1],ft=ae(_t);_.each(function(Ct,ht){if(!$(ht)&&!G(ht)&&!T(ht))return;Ut(ht,ft,rt,a,u)})})}return this},s.remove=function(e){return bt(this,e).detach().off(),this},s.replaceWith=function(e){return this.before(e).remove()},s.replaceAll=function(e){return h(e).replaceWith(this),this};function wn(e,a,u,_,m){var A=this;if(!E(e)){for(var L in e)this.on(L,a,u,e[L],m);return this}if(!E(a))if(k(a)||g(a))a="";else if(k(u))u=a,a="";else _=u,u=a,a="";if(!D(_))_=u,u=void 0;if(!_)return this;return M(ut(e),function(B,_t){var rt=oe(_t),ft=rt[0],Ct=rt[1],ht=ae(ft),Bt=ft in Ie,ue=ft in ie;if(!ht)return;A.each(function(ce,lt){if(!$(lt)&&!G(lt)&&!T(lt))return;var se=function(at){if(at.target["___i".concat(at.type)])return at.stopImmediatePropagation();if(at.namespace&&!Fe(Ct,at.namespace.split(re)))return;if(!a&&(ue&&(at.target!==lt||at.___ot===ht)||Bt&&at.relatedTarget&&lt.contains(at.relatedTarget)))return;var fe=lt;if(a){var St=at.target;while(!It(St,a)){if(St===lt)return;if(St=St.parentNode,!St)return}fe=St}Object.defineProperty(at,"currentTarget",{configurable:!0,get:function(){return fe}}),Object.defineProperty(at,"delegateTarget",{configurable:!0,get:function(){return lt}}),Object.defineProperty(at,"data",{configurable:!0,get:function(){return u}});var Yn=_.call(fe,at,at.___td);if(m)Ut(lt,ht,Ct,a,se);if(Yn===!1)at.preventDefault(),at.stopPropagation()};se.guid=_.guid=_.guid||h.guid++,Kn(lt,ht,Ct,a,se)})}),this}s.on=wn;function Un(e,a,u,_){return this.on(e,a,u,_,!0)}s.one=Un;var Bn=/\r?\n/g;function Gn(e,a){return"&".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(a.replace(Bn,"\r\n")))}var qn=/file|reset|submit|button|image/i,Ke=/radio|checkbox/i;if(s.serialize=function(){var e="";return this.each(function(a,u){M(u.elements||[u],function(_,m){if(m.disabled||!m.name||m.tagName==="FIELDSET"||qn.test(m.type)||Ke.test(m.type)&&!m.checked)return;var A=Re(m);if(!k(A)){var L=v(A)?A:[A];M(L,function(B,_t){e+=Gn(m.name,_t)})}})}),e.slice(1)},typeof t!=="undefined")n.exports=h;else o.cash=o.$=h})()}),gr=Wt(Qt(),1);class We{default=window.navigator.language;LANGUAGE_DICTIONARIES={};setLang(t){if(this.default!==t)return this.default=t,!0;return!1}setDictionary(t,n){this.LANGUAGE_DICTIONARIES[t]=n}translate(t,n){if(n&&this.default==n)return{text:t,lang:this.default};n=n||this.default;const[r,o]=n.split("-");if(this.LANGUAGE_DICTIONARIES[r]&&t in this.LANGUAGE_DICTIONARIES[r]){if(typeof this.LANGUAGE_DICTIONARIES[r][t]==="object"){const f=this.LANGUAGE_DICTIONARIES[r][t];t=f[o||"*"]||f["*"]}else if(typeof this.LANGUAGE_DICTIONARIES[r][t]==="string")t=this.LANGUAGE_DICTIONARIES[r][t]}return{text:t,lang:n}}propagate(t){const n=this;function r(){const o=gr.default(this),f=o.html(),c=o.attr("title"),l=o.attr("placeholder");let i;if(!/<\//.test(f)&&o.text()){const{text:d,lang:y}=n.translate(o.text());o.text(d),i=y}if(c){const{text:d,lang:y}=n.translate(c);o.attr("title",d),i=y}if(l){const{text:d,lang:y}=n.translate(l);o.attr("placeholder",d),i=y}i&&o.attr("lang",i)}return t.children().each(r),t}}class Qe{pendingComponents=new Set;isPending=!1;callbacks=new Map;register(t,n){this.callbacks.set(t,n)}unregister(t){this.callbacks.delete(t)}queue(t){if(!this.callbacks.has(t))return;if(this.pendingComponents.add(t),!this.isPending)this.isPending=!0,this.schedule()}schedule(){Promise.resolve().then(()=>this.process())}process(){const t=Array.from(this.pendingComponents);this.pendingComponents.clear(),this.isPending=!1,t.forEach((n)=>{try{const r=this.callbacks.get(n);if(r)r()}catch(r){console.error(`Error updating component ${n}:`,r)}})}clear(){this.pendingComponents.clear(),this.isPending=!1}dispose(){this.pendingComponents.clear(),this.callbacks.clear(),this.isPending=!1}}class Ze{subscriptions=new Map;tick=new Qe;register(t,n){this.subscriptions.set(t,n),this.tick.register(t,n)}unregister(t){this.subscriptions.delete(t),this.tick.unregister(t)}queueUpdate(t){this.tick.queue(t)}dispose(){this.subscriptions.clear(),this.tick.dispose()}prepareForPotentialUnload(){this.tick.clear(),this.subscriptions.forEach((t,n)=>{this.subscriptions.set(n,()=>{})})}proxyState(t,n){const r=this,o=new WeakMap,f=(l)=>{if(l instanceof Map)l.forEach((d,y)=>l.set(y,c(d)));else if(Array.isArray(l))l.forEach((d,y)=>l[y]=c(d));else if(typeof l==="object")Object.entries(l).forEach(([d,y])=>l[d]=c(y));let i=new Proxy(l,{get(d,y){if(y==="toJSON")return function(){const b=(V)=>{if(!V||typeof V!=="object")return V;if(o.has(V)){const R=o.get(V);if(R instanceof Map){const q={};return R.forEach((et,H)=>q[typeof H==="object"?JSON.stringify(H):String(H)]=b(et)),q}if(Array.isArray(R))return R.map((q)=>b(q));const U={};return Object.entries(R).forEach(([q,et])=>U[q]=b(et)),U}if(typeof V.toJSON==="function"&&!o.has(V))return V.toJSON();return V};return b(i)};if(y==="reset")return function(){i=null};const v=d[y];if(l instanceof Map&&typeof v==="function")return function(...b){const V=y.toString();if(V==="set"&&b.length>=2)b[1]=c(b[1]);const R=v.apply(d,b);return["set","delete","clear"].includes(V)&&r.queueUpdate(t),R};if(Array.isArray(l)&&typeof v==="function")return function(...b){const V=y.toString();if(["push","unshift"].includes(V))b=b.map((U)=>c(U));else if(V==="splice"&&b.length>2)b=[b[0],b[1],...b.slice(2).map((U)=>c(U))];const R=v.apply(d,b);return["push","pop","shift","unshift","splice","sort","reverse","fill"].includes(V)&&r.queueUpdate(t),R};return v},set(d,y,v){if(d[y]===v)return!0;if(v instanceof Map&&d[y]instanceof Map){const b=d[y];return b.clear(),v.forEach((V,R)=>b.set(R,c(V))),r.queueUpdate(t),!0}return d[y]=c(v),r.queueUpdate(t),!0}});return o.set(i,l),i},c=(l)=>{if(!l)return l;return l instanceof Map||Array.isArray(l)||typeof l==="object"?f(l):l};return f(n)}}class Je{domObserver;observedComponents=new Map;TIMEOUT=1e4;constructor(){this.domObserver=new MutationObserver(()=>{this.observedComponents.forEach((t,n)=>{try{const r=n.node;if(!r){this.unwatch(n);return}if(t.type==="attach"&&document.contains(r[0]))this.unwatch(n),n.emit("component:attached",n),typeof n.onAttach=="function"&&n.onAttach.bind(n)();else if(t.type==="detach"&&!document.contains(r[0]))this.unwatch(n),n.emit("component:detached",n),typeof n.onDetach=="function"&&n.onDetach.bind(n)()}catch(r){console.log("DWS error --",r)}}),!this.observedComponents.size&&this.domObserver.disconnect()})}watch(t,n="attach"){const r=t.node;if(!r)return;if(n==="attach"&&document.contains(r[0])){t.emit("component:attached",t),typeof t.onAttach=="function"&&t.onAttach.bind(t)();return}if(n==="detach"&&!document.contains(r[0])){t.emit("component:detached",t),typeof t.onDetach=="function"&&t.onDetach.bind(t)();return}this.unwatch(t);const o=setTimeout(()=>{this.unwatch(t),t.emit(`component:${n}ment-timeout`,t)},this.TIMEOUT);this.observedComponents.set(t,{timeout:o,type:n}),this.observedComponents.size===1&&this.domObserver.observe(document.body,{childList:!0,subtree:!0}),n==="attach"&&t.once("component:attached",()=>this.watch(t,"detach"))}unwatch(t){const n=this.observedComponents.get(t);if(n)clearTimeout(n.timeout),this.observedComponents.delete(t);!this.observedComponents.size&&this.domObserver.disconnect()}dispose(){this.domObserver.disconnect(),this.observedComponents.forEach((t)=>clearTimeout(t.timeout)),this.observedComponents.clear()}}class tn{pending=new Set;isPending=!1;component;metrics={batchCount:0,updatesProcessed:0,lastBatchSize:0,avgBatchSize:"0.00"};constructor(t){this.component=t}queue(t){if(this.pending.add(t),this.component.benchmark.inc("dependencyUpdateCount"),!this.isPending)this.isPending=!0,this.scheduleProcessing()}scheduleProcessing(){Promise.resolve().then(()=>this.processQueue())}processQueue(){const t=Array.from(this.pending);if(this.metrics.batchCount++,this.metrics.lastBatchSize=t.length,this.metrics.updatesProcessed+=t.length,this.metrics.avgBatchSize=(this.metrics.updatesProcessed/this.metrics.batchCount).toFixed(2),this.pending.clear(),this.component.benchmark.trackBatch(t.length),this.applyUpdates(t),this.isPending=!1,this.pending.size>0)this.isPending=!0,this.scheduleProcessing()}applyUpdates(t){t.forEach(({dep:n,dependent:r})=>{try{const o=r.update(r.memo,"batch-updator");if(o)typeof o.memo==="object"&&this.component.FGUD.get(n)?.set(r.path,{...r,memo:o.memo}),typeof o.cleanup==="function"&&o.cleanup()}catch(o){console.error("Failed to update dependency --",o)}})}getMetrics(){return{batchCount:this.metrics.batchCount,lastBatchSize:this.metrics.lastBatchSize,avgBatchSize:this.metrics.avgBatchSize,totalUpdates:this.metrics.updatesProcessed}}}class en{options={emit:!0};__events={};__once_events={};constructor(t){if(t)this.options=t}on(t,n){if(!Array.isArray(this.__events[t]))this.__events[t]=[];return this.__events[t].push(n),this}once(t,n){if(!Array.isArray(this.__once_events[t]))this.__once_events[t]=[];return this.__once_events[t].push(n),this}off(t){return delete this.__events[t],delete this.__once_events[t],this}emit(t,...n){if(!this.options.emit)return;const r=n.map((o)=>typeof o.toJSON==="function"?o.toJSON():o);this.__events[t]?.forEach((o)=>o(...r)),this.__once_events[t]?.forEach((o)=>o(...r)),delete this.__once_events[t]}}var Q=Wt(Qt(),1),Ue=Wt(Qt(),1),Be=function(t){for(let n of t)if(typeof n==="object"&&n!==null)return!1;return!0},Ge=function(t){for(let[n,r]of t)if(typeof n==="object"&&n!==null||typeof r==="object"&&r!==null)return!1;return!0};Ue.default.fn.extend({attrs:function(){const t={},n=this[0];return n&&n.nodeType!==Node.TEXT_NODE&&Ue.default.each(n.attributes,function(){t[this.name]=this.value}),t}});var $t="syn:",kt="fn:",Mt="on-",J=/^\.\.\./,me=/^\[(.*?)\]$/,br=["@html","@text"];class nn{debug;initialStats={renderCount:0,elementCount:0,renderTime:0,avgRenderTime:0,maxRenderTime:0,componentCount:0,componentUpdateCount:0,partialCount:0,partialUpdateCount:0,memoryUsage:void 0,domOperations:0,domInsertsCount:0,domUpdatesCount:0,domRemovalsCount:0,dependencyTrackCount:0,dependencyUpdateCount:0,batchSize:0,batchCount:0,errorCount:0};stats=this.reset();renderStartTime=0;renderTimes=[];measurementCount=0;maxMeasurements=100;loggingInterval=10;autoSaveInterval;constructor(t=!1){if(this.debug=t,this.debug)this.autoSaveInterval=window.setInterval(()=>this.storeMetrics(),5000)}storeMetrics(){try{const t=JSON.parse(localStorage.getItem("lipsPerformanceMetrics")||"[]");t.push({timestamp:Date.now(),metrics:{...this.stats}}),t.length>100&&t.shift(),localStorage.setItem("lipsPerformanceMetrics",JSON.stringify(t))}catch(t){}}startRender(){if(!this.debug)return;this.renderStartTime=performance.now()}endRender(){if(!this.debug||this.renderStartTime===0)return;const t=performance.now()-this.renderStartTime;this.stats.renderTime=t,this.stats.maxRenderTime=Math.max(this.stats.maxRenderTime,t),this.renderTimes.push(t),this.renderTimes.length>this.maxMeasurements&&this.renderTimes.shift(),this.stats.avgRenderTime=this.renderTimes.reduce((n,r)=>n+r,0)/this.renderTimes.length,this.renderStartTime=0,this.measurementCount++}inc(t){if(!this.debug)return;if(typeof this.stats[t]==="number")this.stats[t]++}dec(t){if(!this.debug)return;if(typeof this.stats[t]==="number"&&this.stats[t]>0)this.stats[t]--}record(t,n){if(!this.debug)return;if(typeof this.stats[t]!=="undefined")this.stats[t]=n}add(t,n){if(!this.debug)return;if(typeof this.stats[t]==="number")this.stats[t]+=n}reset(){return this.renderTimes=[],this.measurementCount=0,this.stats=nt(this.initialStats)}log(){if(!this.debug)return;if(this.loggingInterval>1&&this.measurementCount%this.loggingInterval!==0)return;const t={"Render Count":this.stats.renderCount,"Element Count":this.stats.elementCount,"Avg Render Time (ms)":this.stats.avgRenderTime.toFixed(2),"Max Render Time (ms)":this.stats.maxRenderTime.toFixed(2)},n={"Component Count":this.stats.componentCount,"Component Updates":this.stats.componentUpdateCount},r={"Partial Count":this.stats.partialCount,"Partial Updates":this.stats.partialUpdateCount},o={"DOM Operations":this.stats.domOperations,"DOM Inserts":this.stats.domInsertsCount,"DOM Updates":this.stats.domUpdatesCount,"DOM Removals":this.stats.domRemovalsCount},f={"Dependencies Tracked":this.stats.dependencyTrackCount,"Dependency Updates":this.stats.dependencyUpdateCount},c={"Batch Count":this.stats.batchCount,"Avg Batch Size":this.stats.batchCount>0?(this.stats.batchSize/this.stats.batchCount).toFixed(2):"0"};console.group("Lips Framework Performance Metrics"),console.table(t),console.table(n),console.table(r),console.table(o),console.table(f),console.table(c),this.stats.memoryUsage&&console.log(`Memory Usage: ${this.stats.memoryUsage.toFixed(2)} MB`),this.stats.errorCount>0&&console.warn(`Errors encountered: ${this.stats.errorCount}`),console.groupEnd(),window.localStorage&&this.measurementCount%10===0&&this.storeMetrics()}trackMemory(){if(!this.debug||!window.performance?.memory)return;this.stats.memoryUsage=window.performance.memory.usedJSHeapSize/1048576}trackBatch(t){if(!this.debug)return;this.stats.batchCount++,this.stats.batchSize+=t}trackError(t){if(!this.debug)return;this.stats.errorCount++,console.error("Lips Framework Error:",t)}setLoggingInterval(t){if(!this.debug)return;this.loggingInterval=t}getSnapshot(){return nt(this.stats)}dispose(){if(!this.debug)return;this.autoSaveInterval&&clearInterval(this.autoSaveInterval)}}var Ar=Wt(Qt(),1),rn="comm",an="rule",on="decl",$r="@import",xr="@namespace",Cr="@keyframes",Tr="@layer",sn=Math.abs,$e=String.fromCharCode,Jt=1,Lt=1,fn=0,dt=0,tt=0,Ot="";class ln{nsp;settings;$head;constructor(t,n){if(typeof t!=="string")throw new Error("Undefined or invalid styles attachement element(s) namespace");this.nsp=t,this.$head=Ar.default("head"),this.settings=n||{},this.settings&&this.load(this.settings)}compile(t){try{return Ae(Or(t),Fr([Mr]))}catch(n){throw new Error(`Style compilation failed: ${n.message}`)}}waitForStyles(t){return new Promise((n)=>{const r=new MutationObserver(()=>{const o=document.querySelector(t);if(o&&getComputedStyle(o).cssText)r.disconnect(),n()});r.observe(document.documentElement,{attributes:!0,childList:!0,subtree:!0})})}async inject(t){if(!t)throw new Error("Invalid injection arguments");const n=`rel="${this.settings.meta?"@":""}${this.nsp}"`;t=this.settings.meta?t:`[rel="${this.nsp}"] { ${t} }`;try{const r=this.compile(t);if(!r)throw new Error(`<component:${this.nsp}> sheet compilation failed`);const o=document.createElement("style");o.setAttribute("rel",`${this.settings.meta?"@":""}${this.nsp}`),o.textContent=r;let f=0;const c=this.$head.find(`style[${n}]`);if(c.length)f=parseInt(c.attr("dindex"))+1,c.remove();return o.setAttribute("dindex",String(f)),this.settings.meta?document.head.prepend(o):document.head.appendChild(o),o}catch(r){throw new Error(`Style injection failed: ${r.message}`)}}async load(t){if(this.settings=t,typeof this.settings!=="object")throw new Error("Undefined styles settings");if(this.settings.sheet){const n=await this.inject(this.settings.sheet);await this.waitForStyles(`style[rel="${this.settings.meta?"@":""}${this.nsp}"]`)}}get(){}async clear(){const t=this.$head.find(`style[rel="${this.settings.meta?"@":""}${this.nsp}"]`);if(!t.length)return;const n=parseInt(t.attr("dindex"));n===0?t.remove():t.attr("dindex",String(n-1))}async custom(){return{}}async style(){return{}}}var Kr=function(t){const n=/on-([a-zA-Z-]+)\s*\(/g;let r=t,o;while((o=n.exec(t))!==null){const f=o[1],c=o.index+o[0].length;let l=1,i=c;while(i<t.length&&l>0){if(t[i]==="(")l++;if(t[i]===")")l--;i++}if(l===0){const d=t.slice(c,i-1).trim(),y=t.slice(0,o.index),v=`${Mt}${f}="${d}"`,b=t.slice(i);r=y+v+b,t=r,n.lastIndex=y.length+v.length}}return r},wr=function(t){const n=[];let r=t.replace(/<([a-zA-Z][a-zA-Z0-9_-]*)((?:[^>'"]*|'[^']*'|"[^"]*")*?)(?:\/?>)/g,(o,f,c)=>{return n.push(c),`<${f}##TAG_ATTRS_${n.length-1}##>`});for(let o=0;o<n.length;o++){const f=`##TAG_ATTRS_${o}##`,c=n[o],l=Ur(c);r=r.replace(f,l)}return r},Ur=function(t){let n="",r=0,o=!1,f="",c=0,l=0,i=0;while(r<t.length){const d=t[r];if((d==='"'||d==="'")&&(r===0||t[r-1]!=="\\")){if(!o)o=!0,f=d;else if(d===f)o=!1}if(!o){if(d==="(")l++;else if(d===")")l--;else if(d==="{")i++;else if(d==="}")i--}if(!o&&l===0&&i===0&&(d===" "||r===t.length-1)){let y=r;if(r===t.length-1)y=r+1;const v=t.substring(c,y).trim();if(v){const b=Br(v);n+=" "+b}c=r+1}r++}return n},Br=function(t){const n=t.indexOf("=");if(n===-1){if(t.startsWith("...")||t.startsWith("["))return t;return`:${t}="${!t.startsWith("!")}"`}let r=t.substring(0,n).trim(),o=t.substring(n+1).trim();if(r.startsWith("@"))return r=!br.includes(r)?r.slice(1):r,`:${r}=${o}`;if(r.startsWith(kt)||r.startsWith(Mt))return t;if(o.startsWith('"')&&o.endsWith('"')||o.startsWith("'")&&o.endsWith("'")){const f=o.substring(1,o.length-1);if(Gr(f))return`:${r}="${f}"`;return t}else return`:${r}="${o}"`},qr=function(t,n){if(t.isDisposed)return;n.add(t),t.dependencies.add(n)},ze=function(t){for(let n of t.dependencies)n.delete(t);t.dependencies.clear()},Ht=[],He=null;class Ce extends en{declaration;$=null;input;state;static;context;__name__;__path__;__template__;__previous;__stylesheet;__macros=new Map;__renderCache=new Map;FGUD=new Map;PCC=new Map;VER=[];prepath="0";debug=!1;isRendered=!1;__setInput;__setState;__getState;UQS;ICE;lips;benchmark;__path="";__pathCounter=0;__renderDepth=0;constructor(t,n,{input:r,state:o,context:f,_static:c,handler:l,stylesheet:i,macros:d,declaration:y},v){super();if(this.lips=v.lips,v?.debug)this.debug=v.debug;if(v?.prepath)this.prepath=v.prepath;if(this.__name__=t,this.__path__=`${this.prepath}/${this.__name__}`,this.__template__=Xe(n),this.declaration=y||{name:t},this.input=r||{},this.static=c||{},this.context={},this.state=this.lips.IUC.proxyState(this.__path__,o||{}),d&&this.setMacros(d),l&&this.setHandler(l),i&&this.setStylesheet(i),this.benchmark=new nn(this.debug),this.benchmark.inc("componentCount"),this.UQS=new tn(this),typeof this.onCreate=="function"&&this.onCreate.bind(this)(),this.emit("component:create",this),this.input&&Object.keys(this.input).length&&typeof this.onInput=="function")this.onInput.bind(this)(this.input),this.emit("component:input",this);this.__previous={input:nt(this.input),state:nt(this.state),context:nt(this.context)};const[b,V]=zt(this.input),[R,U]=zt(this.state),[q,et]=zt(this.context);this.__setInput=V,this.__setState=U,this.__getState=R,this.lips.IUC.register(this.__path__,()=>{ot(this.__previous?.state,this.state)&&this.__setState({...this.__getState(),...this.state})}),Array.isArray(f)&&f.length&&this.lips.useContext(f,(H)=>{if(!ot(this.context,H))return;et(H),this.context=H,typeof this.onContext=="function"&&this.onContext.bind(this)(),this.emit("component:context",this)}),this.ICE=pn(()=>{const H=b(),X=R(),w=this.context=q();if(!this.isRendered){this.benchmark.reset();const{$log:F}=this.render("",void 0,void 0,this.FGUD);this.$=F,!y?.syntax&&this.$?.each((K,x)=>typeof x.setAttribute=="function"&&x.setAttribute("rel",this.__name__)),this.isRendered=!0,typeof this.onMount=="function"&&this.onMount.bind(this)(),this.emit("component:mount",this),this.lips.watcher.watch(this)}else this.__updateDepNodes__({state:X,input:H,context:w},this.__previous),typeof this.onUpdate=="function"&&this.onUpdate.bind(this)(),this.emit("component:update",this),this.__previous={input:nt(H),state:nt(X),context:nt(w)},this.input=H;this.benchmark.log(),typeof this.onRender=="function"&&this.onRender.bind(this)(),this.emit("component:render",this)})}setContext(t,n){this.lips.setContext(t,n)}setInput(t){if(!ot(this.input,t))return;this.__setInput(t),typeof this.onInput=="function"&&this.onInput.bind(this)(t)}subInput(t){if(typeof t!=="object")throw new Error("Invalid sub input data argument");return this.setInput(kr(this.input,t)),this}setMacros(t){const n=Xe(t),r=Q.default(n);if(!r.length)return;const o=this;r.each(function(){const f=Q.default(this),{argv:c,attrs:l}=o.__getAttributes__(f);if(!Object.keys(l))throw new Error("Invalid macro component definition");if(!l.literals.name)throw new Error("Undefined macro `name` attribute.");if(o.__macros.get(l.literals.name))console.warn(`Duplicate macro <${l.literals.name}> will be override`);if(!f.contents()?.length)throw new Error("Invalid macro component definition. Template content expected.");o.__macros.set(l.literals.name,{argv:c,$node:f})})}setHandler(t){Object.entries(t).map(([n,r])=>this[n]=r.bind(this))}setStylesheet(t){const n={sheet:t,meta:this.__name__==="__ROOT__"};this.__stylesheet=new ln(this.__name__,n)}get node(){if(!this.$)throw new Error("node() is expected to be call after component get rendered");return this.$}find(t){return this.$?.find(t)}render(t,n,r={},o,f){const c=o||new Map,l=[];if(n&&!n.length)return console.warn("Undefined node element to render"),{$log:n,dependencies:c};this.benchmark.startRender();const i=this;let d=Q.default();function y(p){const j=v(p);return i.__pathCounter++,i.__path?`${i.__path}/${j}`:`${t?t+"/":"#"}${j}`}function v(p){return(p==="component"?"c":"")+i.__pathCounter}function b(p){return p!==null&&typeof p==="object"&&typeof p.mesh==="function"&&typeof p.update==="function"}function V(p){return p!==null&&typeof p==="object"&&typeof p.default&&typeof p.default==="string"}function R(p){if(!p.attr(":dtag")||p.prop("tagName")!=="LIPS")throw new Error("Invalid dynamic tag name");const j=p.attr(":dtag"),s=i.__evaluate__(j,r);if(b(s)||s===null)return X(p,j,s);else if(V(s))return w(p,{template:s});else return w(p,{name:s})}function U(p){const j=p.attr(":args"),s=y("log");if(!j)return;if(i.__evaluate__(`console.log(${j})`,r),i.__isReactive__(j,r))i.__extractExpressionDeps__(j,r).forEach((h)=>i.__trackDep__(c,h,{$fragment:null,path:s,update:(P)=>i.__evaluate__(`console.log(${j})`,P),memo:r,batch:!0}))}function q(p){const j=y("var"),{attrs:s}=i.__getAttributes__(p);if(!s)return;Object.entries(s.literals).forEach(([h,P])=>{if(r[h]&&r[h].type==="const")throw new Error(`Cannot override <const ${h}=[value]/> variable`);r[h]={value:P,type:"let"}}),Object.entries(s.expressions).forEach(([h,P])=>{if(J.test(h)){const T=(G,N)=>{const $=i.__evaluate__(h.replace(J,""),N||r);if(typeof $!=="object")throw new Error(`Invalid spread operator ${h}`);for(let O in $){if(r[O]&&r[O].type==="const")throw new Error(`Cannot override <const ${O}=[value]/> variable`);if(r[O]={value:$[O],type:"let"},N)N[O]=r[O],i.__updateVarDepNodes__(O,j,N)}if(G)return{memo:N}};i.__extractExpressionDeps__(h,r).forEach((G)=>i.__trackDep__(c,G,{$fragment:null,path:`${j}.${h}`,update:(N)=>T(!0,N),memo:r,batch:!0})),T()}else if(P){if(i.__isReactive__(P,r)){const T=i.__extractExpressionDeps__(P,r),G=(N,$)=>{if(r[h]&&r[h].type==="const")throw new Error(`Cannot override <const ${h}=[value]/> variable`);return N[h]=r[h]={value:i.__evaluate__(P,N),type:"let"},i.__updateVarDepNodes__(h,j,N),{memo:N}};T.forEach((N)=>i.__trackDep__(c,N,{$fragment:null,path:`${j}.${h}`,update:G,memo:r,batch:!0}))}if(r[h]&&r[h].type==="const")throw new Error(`Cannot override <const ${h}=[value]/> variable`);r[h]={value:i.__evaluate__(P,r),type:"let"}}}),i.benchmark.inc("elementCount")}function et(p){const{attrs:j}=i.__getAttributes__(p);if(!j)return;Object.entries(j.literals).forEach(([s,h])=>{if(r[s]&&r[s].type==="const")throw new Error(`<const ${s}=[value]/> variable already defined`);if(!h)return;r[s]={value:h,type:"const"}}),Object.entries(j.expressions).forEach(([s,h])=>{if(J.test(s)){const P=i.__evaluate__(s.replace(J,""),r);if(typeof P!=="object")throw new Error(`Invalid spread operator ${s}`);for(let T in P){if(r[T]&&r[T].type==="const")throw new Error(`<const ${T}=[value]/> by spread operator ${s}. [${T}] variable already defined`);r[T]={value:P[T],type:"const"}}}else{if(r[s]&&r[s].type==="const")throw new Error(`<const ${s}=[value]/> variable already defined`);if(!h)return;r[s]={value:i.__evaluate__(h,r),type:"const"}}}),i.benchmark.inc("elementCount")}function H(p){const j=y("element"),s=p.contents();let h=Q.default();if(s.length)h=h.add(i.__withPath__(j,()=>i.render(j,s,r,c,f).$log));return h}function X(p,j,s){const{attrs:h}=i.__getAttributes__(p),P=y("element"),T=i.__getBoundaries__(P);let G=Q.default(T.start),N={},$=s;if($){h.literals&&Object.entries(h.literals).forEach(([C,D])=>N[C]={type:"arg",value:D}),h.expressions&&Object.entries(h.expressions).forEach(([C,D])=>{if(!$)return;if(J.test(C)){const E=i.__evaluate__(C.replace(J,""),r);if(typeof E!=="object")throw new Error(`Invalid spread operator ${C}`);for(let k in E){if(k!=="#"&&!$.argv.includes(k))continue;N[k]={type:"arg",value:E[k]}}}else{if(C!=="#"&&!$.argv.includes(C))return;N[C]={type:"arg",value:D?i.__evaluate__(D,r):!0}}});const O=$.mesh(N);if(O&&O.length)G=G.add(O);h.expressions&&Object.entries(h.expressions).forEach(([C,D])=>{if(!$)return;if(J.test(C)&&i.__isReactive__(C,r)){const E=i.__extractExpressionDeps__(C,r),k=(g,I)=>{if(!$)return;const z={},M=i.__evaluate__(C.replace(J,""),g);if(typeof M!=="object")throw new Error(`Invalid spread operator ${C}`);const Y=[];for(let W in M){if(W!=="#"&&!$.argv.includes(W))continue;N[W]=z[W]={type:"arg",value:M[W]},(!g[W]||!Et(M[W],g[W].value))&&Y.push(W)}Y.length&&$.update(Y,z,T)};E.forEach((g)=>i.__trackDep__(c,g,{$fragment:null,boundaries:T,path:`${P}.${C}`,update:k,memo:r,batch:!0}))}else if((C==="#"||$.argv.includes(C))&&i.__isReactive__(D,r)){const E=i.__extractExpressionDeps__(D,r),k=(g,I)=>{if(!$)return;const z=N[C]={type:"arg",value:D?i.__evaluate__(D,g):!0};$.update([C],{[C]:z},T)};E.forEach((g)=>i.__trackDep__(c,g,{$fragment:null,boundaries:T,path:`${P}.${C}`,update:k,memo:r,batch:!0}))}})}if(i.__isReactive__(j,r)){const O=(C,D)=>{const E=i.__evaluate__(j,C);let k;if(V(E))k=w(p,{template:E});else if(b(E))N="#"in N?{...C,...N["#"].value}:{...C,...N},$=E,k=$?$.mesh(N):null;if(!document.contains(T.start)||!document.contains(T.end))throw new Error("Dynamic element boundaries not found");const g=[];let I=T.start.nextSibling;while(I&&I!==T.end)g.push(I),I=I.nextSibling;Q.default(g).remove(),k&&Q.default(T.start).after(k)};i.__extractExpressionDeps__(j,r).forEach((C)=>i.__trackDep__(c,C,{$fragment:null,boundaries:T,path:P,update:O,batch:!0,memo:{...r,...N}}))}return G=G.add(T.end),G}function w(p,j){let s,h;if(j?.template)s=j.template,h=v("component");else{if(h=j?.name||p.prop("tagName")?.toLowerCase(),!h)throw new Error("Invalid component");if(h===i.__name__)throw new Error("Render component within itself is forbidden");s=i.lips.import(h)}if(!s||!h)throw new Error(`<${h}> template not found`);const P=y("component"),T=i.__getBoundaries__(P),{argv:G,attrs:N,events:$}=i.__getAttributes__(p),O={};let C={},D=Q.default(T.start),E=i.PCC.get(P);N.literals&&Object.entries(N.literals).forEach(([g,I])=>{if(g=="key")return;C[g]=I}),N.functions&&Object.entries(N.functions).forEach(([g,I])=>{C[g]=i.__evaluateFunction__(I,[],r),s.declaration?.syntax?O[$t+kt+g]=I:O[kt+g]=I}),N.expressions&&Object.entries(N.expressions).forEach(([g,I])=>{if(g=="key")return;if(J.test(g)){const z=i.__evaluate__(g.replace(J,""),r);if(typeof z!=="object")throw new Error(`Invalid spread operator ${g}`);for(let M in z)C[M]=z[M]}else C[g]=I?i.__evaluate__(I,r):!0;s.declaration?.syntax?O[$t+g]=I:O[g]=I});const k=p.contents();if(k.length){if(C={...C,...i.__meshwire__({$node:p,fragmentPath:P,fragmentBoundaries:T,meshPath:null,argv:G,scope:r,xmlns:f,useAttributes:!0,declaration:s.declaration},O)},s.declaration){if(s.declaration.tags)Object.entries(s.declaration?.tags).forEach(([g,{type:I,many:z}])=>{switch(I){case"nexted":{let M=p.next(g);if(!M.length)return;if(z){C[g]=[];let Y=0,W=!1;while(!W){if(C[g].push(i.__meshwire__({$node:M,meshPath:`${g}[${Y}]`,fragmentPath:P,fragmentBoundaries:T,argv:G,scope:r,xmlns:f,useAttributes:!0,declaration:s.declaration},O)),!M.next(g).length){W=!0;break}M=M.next(g),Y++}}else C[g]=i.__meshwire__({$node:M,meshPath:g,fragmentPath:P,fragmentBoundaries:T,argv:G,scope:r,xmlns:f,useAttributes:!0,declaration:s.declaration},O)}break;case"child":{const M=p.children(g);if(z)C[g]=[],M.each(function(Y){const W=Q.default(this),{argv:ut}=i.__getAttributes__(W);C[g].push(i.__meshwire__({$node:W,meshPath:`${g}[${Y}]`,fragmentPath:P,fragmentBoundaries:T,argv:ut,scope:r,xmlns:f,useAttributes:!0,declaration:s.declaration},O))});else if(p.children(g).first().length){const Y=p.children(g).first(),{argv:W}=i.__getAttributes__(Y);C[g]=i.__meshwire__({$node:Y,meshPath:g,fragmentPath:P,fragmentBoundaries:T,argv:W,scope:r,xmlns:f,useAttributes:!0,declaration:s.declaration},O)}}break}});else if(s.declaration.contents)C.__contents__=k}}if(E)E.setInput(nt(C)),D=D.add(E.node);else{const{declaration:g,state:I,_static:z,handler:M,context:Y,default:W,stylesheet:ut}=s;E=new Ce(h,W||"",{state:nt(I),input:nt(C),context:Y,_static:nt(z),handler:M,stylesheet:ut,declaration:g},{debug:i.debug,lips:i.lips,prepath:P}),D=D.add(E.node),i.PCC.set(P,E),Object.entries($).forEach(([Z,it])=>!!E&&i.__attachEvent__(E,Z,it,r)),O&&Object.entries(O).forEach(([Z,it])=>{let ct=!1,st=!1;if(Z.startsWith($t))ct=!0,Z=Z.replace($t,"");if(Z.startsWith(kt))st=!0,Z=Z.replace(kt,"");if(J.test(Z)){const Rt=(pt)=>{const Nt={},jt=i.__evaluate__(Z.replace(J,""),pt);if(typeof jt!=="object")throw new Error(`Invalid spread operator ${Z}`);for(let It in jt)Nt[It]=jt[It];E?.subInput(Nt)};if(i.__isReactive__(Z,r))i.__extractExpressionDeps__(it,r).forEach((pt)=>i.__trackDep__(c,pt,{$fragment:null,boundaries:T,path:`${P}.${Z}`,update:Rt,syntax:ct,memo:r,batch:!0}))}else{const Rt=(pt)=>{const Nt=st?i.__evaluateFunction__(it,[],pt):it?i.__evaluate__(it,pt):!0;E?.subInput({[Z]:Nt})};if(i.__isReactive__(it,r))i.__extractExpressionDeps__(it,r).forEach((pt)=>i.__trackDep__(c,pt,{$fragment:null,boundaries:T,path:`${P}.${Z}`,update:Rt,syntax:ct,memo:r,batch:!0}))}}),D=D.add(T.end)}return i.benchmark.inc("componentCount"),D}function F(p){const j=p.prop("tagName")?.toLowerCase();if(!j)throw new Error("Invalid macro rendering call");const s=i.__macros.get(j);if(!s)throw new Error("Macro component not found");const h=y("macro"),P=i.__getBoundaries__(h),{attrs:T}=i.__getAttributes__(p),G={};let N={},$={},O=Q.default(P.start);if(T.literals&&Object.entries(T.literals).forEach(([k,g])=>N[k]={value:g,type:"arg"}),T.expressions&&Object.entries(T.expressions).forEach(([k,g])=>{if(J.test(k)){const I=i.__evaluate__(k.replace(J,""),r);if(typeof I!=="object")throw new Error(`Invalid spread operator ${k}`);for(let z in I)if($[z]=I[z],s.argv.includes(z))N[z]={value:I[z],type:"arg"};G[k]=g}else{const I=g?i.__evaluate__(g,r):!0;if($[k]=I,s.argv.includes(k))N[k]={value:I,type:"arg"};if(s.argv.includes(k))G[k]=g}s.argv.forEach((I)=>{if(N[I]!==void 0)return;N[I]={value:!1,type:"arg"}})}),s.argv.includes("__"))N.__={value:$,type:"arg"};const C={$node:s.$node,meshPath:null,fragmentPath:h,fragmentBoundaries:P,argv:s.argv,scope:r,xmlns:f,useAttributes:!0},D=i.__meshwire__(C,G),E=D.renderer.mesh(N);return O=O.add(E),G&&Object.entries(G).forEach(([k,g])=>{let I=!1;if(new RegExp(`^${$t}`).test(k))I=!0,k=k.replace($t,"");if(J.test(k)){if(!i.__isReactive__(k,r))return;const z=i.__extractExpressionDeps__(k,r),M=(Y)=>{const W={},ut=i.__evaluate__(k.replace(J,""),Y);if(typeof ut!=="object")throw new Error(`Invalid spread operator ${k}`);const Z=[];for(let it in ut)W[it]={value:ut[it],type:"arg"},(!Y[it]||!Et(ut[it],Y[it].value))&&Z.push(it);return Z.length&&D.renderer.update(Z,W),{memo:{...Y,...W}}};z.forEach((Y)=>i.__trackDep__(c,Y,{$fragment:null,boundaries:P,path:`${h}.${k}`,update:M,syntax:I,memo:{...r,...N},batch:!0}))}else if(i.__isReactive__(g,r)){const z=i.__extractExpressionDeps__(g,r),M=(Y)=>{const W=Y[k]={value:g?i.__evaluate__(g,Y):!0,type:"arg"};return D.renderer.update([k],{[k]:W}),{memo:Y}};z.forEach((Y)=>i.__trackDep__(c,Y,{$fragment:null,boundaries:P,path:`${h}.${k}`,update:M,syntax:I,memo:{...r,...N},batch:!0}))}}),O=O.add(P.end),i.benchmark.inc("elementCount"),O}function K(p){if(!p.length||!p.prop("tagName"))return p;const j=p.is("svg")||f,s=j?Q.default(document.createElementNS("http://www.w3.org/2000/svg",p.prop("tagName").toLowerCase())):Q.default(`<${p.prop("tagName").toLowerCase()}/>`),h=p.contents(),P=y("element");h.length&&s.append(i.__withPath__(P,()=>i.render(P+".n",h,r,c,j).$log));const{attrs:T,events:G}=i.__getAttributes__(p);T.literals&&Object.entries(T.literals).forEach(([$,O])=>s.attr($,O));const N=($,O=!1)=>{$&&Object.entries($).forEach(([C,D])=>{switch(C){case"@html":{const E=(k)=>{s.html(i.__evaluate__(D,k))};if(E(r),O&&i.__isReactive__(D,r))i.__extractExpressionDeps__(D,r).forEach((k)=>i.__trackDep__(c,k,{$fragment:s,path:`${P}.${C}`,update:E,memo:r,batch:!0}))}break;case"@text":{const E=(k)=>{let g=i.__evaluate__(D,k);if(!p.is("[no-translate]")){const{text:I}=i.lips.i18n.translate(g);g=I}s.text(g)};if(E(r),O&&i.__isReactive__(D,r))i.__extractExpressionDeps__(D,r).forEach((k)=>i.__trackDep__(c,k,{$fragment:s,path:`${P}.${C}`,update:E,memo:r,batch:!0}))}break;case"style":{const E=(k)=>{const g=i.__evaluate__(D,k);if(typeof g==="object"){let I="";Object.entries(g).forEach(([z,M])=>I+=`${z}:${M};`),I.length&&s.attr("style",I)}else s.attr("style",g)};if(E(r),O&&i.__isReactive__(D,r))i.__extractExpressionDeps__(D,r).forEach((k)=>i.__trackDep__(c,k,{$fragment:s,path:`${P}.${C}`,update:E,memo:r,batch:!0}))}break;default:{const E=(k)=>{const g=D?i.__evaluate__(D,k):D!==void 0?D:!0;g===void 0||g===!1?s.removeAttr(C):s.attr(C,g)};if(E(r),O&&i.__isReactive__(D,r))i.__extractExpressionDeps__(D,r).forEach((k)=>i.__trackDep__(c,k,{$fragment:s,path:`${P}.${C}`,update:E,memo:r,batch:!0}))}}})};return T.expressions&&Object.keys(T.expressions).forEach(($)=>{if(!J.test($))return;const O=(C)=>{const D={},E=i.__evaluate__($.replace(J,""),C);if(typeof E!=="object")throw new Error(`Invalid spread operator ${$}`);for(let k in E)D[k]=E[k];N(D)};if(delete T.expressions[$],O(r),$&&i.__isReactive__($,r))i.__extractExpressionDeps__($,r).forEach((C)=>i.__trackDep__(c,C,{$fragment:s,path:`${P}.${$}`,update:O,memo:r,batch:!0}))}),N(T.expressions,!0),G&&Object.entries(G).forEach(([$,O])=>{l.push({_event:$,$fragment:s,instruction:O,scope:r})}),i.benchmark.inc("elementCount"),i.benchmark.inc("domInsertsCount"),s}function x(p){const j=y("element"),s=p.text(),h=Q.default(document.createTextNode(i.__interpolate__(s,r)));if(s&&i.__isReactive__(s,r)){const P=i.__extractTextDeps__(s,r),T=(G)=>{const N=i.__interpolate__(s,G);if(!h[0])return;h[0].textContent=N};P.forEach((G)=>i.__trackDep__(c,G,{path:j,$fragment:h,update:T,memo:r,batch:P.length>1}))}return i.benchmark.inc("elementCount"),i.benchmark.inc("domInsertsCount"),h}function S(p){if(p.get(0)?.nodeType===Node.COMMENT_NODE)return p;if(p.get(0)?.nodeType===Node.TEXT_NODE)return x(p);if(p.is("let"))return q(p);else if(p.is("const"))return et(p);else if(p.is("lips")&&p.is("[fragment]"))return H(p);else if(p.is("lips")&&p.attr(":dtag"))return R(p);else if(p.is("log"))return U(p);else if(i.__macros.has(p.prop("tagName")?.toLowerCase()))return F(p);else if(p.is("if, for, switch, async")||i.lips.has(p.prop("tagName")?.toLowerCase()))return w(p);else if(p.is("else-if, else"))return;return K(p)}try{this.__renderDepth++,n=n||Q.default(this.__template__),n.each(function(){const p=S(Q.default(this));if(p)d=d.add(p)}),l.forEach(({$fragment:p,_event:j,instruction:s,scope:h})=>{this.__attachEvent__(p,j,s,h)}),i.benchmark.inc("renderCount")}catch(p){console.error("Rendering Failed --",p),i.benchmark.trackError(p)}finally{if(this.__renderDepth--,this.benchmark.endRender(),this.benchmark.trackMemory(),this.__renderDepth===0)this.__path="",this.__pathCounter=0}return{$log:d,dependencies:c,events:l}}destroy(){this.ICE.dispose(),this.benchmark.dispose(),this.lips.IUC.unregister(this.__path__),this.lips.watcher.unwatch(this),this.VER.forEach(({element:t,_event:n})=>this.__detachEvent__(t,n)),this.VER=[];for(let t in this.PCC){const n=this.PCC.get(t);n?.destroy(),n?.delete(t)}if(this.$?.remove(),this.PCC?.clear(),this.FGUD?.clear(),this.state.reset(),this.__macros.clear(),this.__stylesheet?.clear(),this.__previous=null,this.state=null,this.input=null,this.context=null,this.$)this.$.each((t,n)=>{Q.default(n).off()}),this.$=null}__meshwire__(t,n){const r=this,{$node:o,meshPath:f,fragmentPath:c,fragmentBoundaries:l,argv:i,scope:d,xmlns:y,declaration:v,useAttributes:b}=t;let V,R=[];const U=[],q=(w,F,K)=>{const x=`${c}.${f||"r"}${K!==void 0?`[${K}]`:""}`,{$log:S,dependencies:p,events:j}=r.render(x,w,{...d,...F},void 0,y);if(U.push(x),p?.forEach((s,h)=>{if(!r.FGUD?.has(h))r.FGUD.set(h,new Map);s.forEach((P,T)=>{P.partial?.length?P.partial.push(x):P.partial=[x],r.FGUD.get(h)?.set(T,P)})}),r.benchmark.inc("partialCount"),K!==void 0){const s=r.__getBoundaries__(x);R[K]={argvalues:F,boundaries:s};let h=Q.default(s.start);return h=h.add(S),h=h.add(s.end),h}return S},et=(w,F,K)=>{if(r.benchmark.startRender(),w.forEach((x)=>{const S=r.FGUD.get(x);if(!S)return;S.forEach((p)=>{const j=U.find((s)=>p.partial?.find((h)=>s==h));if(!p.partial||!j)return;if(K!==void 0&&!j.endsWith(`r[${K}]`))return;if(l?.start&&!document.contains(l.start)){console.warn(`${f} -- partial boundaries missing in the DOM`),S.delete(p.path);return}if(p.memo?.[x]&&F?.[x]&&Et(p.memo[x],F[x]))return;if(p.memo={...d,...p.memo,...F},p.batch)r.UQS.queue({dep:x,dependent:p});else{const s=p.update(p.memo,"mesh-partial-updator");if(s)typeof s.memo==="object"&&S.set(p.path,{...p,memo:s.memo}),typeof s.cleanup==="function"&&s.cleanup()}r.benchmark.inc("dependencyUpdateCount")}),!S.size&&r.FGUD.delete(x)}),K!==void 0&&R[K])R[K].argvalues=F;r.benchmark.inc("partialUpdateCount"),r.benchmark.endRender()},H=(w)=>{if(!R[w])return;const F=R[w].boundaries;if(delete R[w],!document.contains(F.start)||!document.contains(F.end)){console.warn(`Partial mesh item<${w}> boundaries missing`);return}const K=[];let x=F.start.nextSibling;while(x&&x!==F.end)K.push(x),x=x.nextSibling;Q.default(K).remove(),F.start.remove(),F.end.remove()},X={renderer:{path:f,argv:i,mesh(w,F=!1){if(V=o.contents(),!V?.length)return null;if(v?.iterator){const K=w?.["#"].value;if(!Array.isArray(w?.["#"].value))throw new Error("Invalid iterator argvalues");if(!K.length)return null;let x=Q.default();return K.forEach((S,p)=>{if(!V?.length)return null;x=x.add(q(V,S,p))}),x}else return q(V,w)},update(w,F,K){if(!U.length)return;if(K=K||l,v?.iterator){const x=F?.["#"].value;if(!Array.isArray(x))return;if(Array.isArray(R)){if(R.length===x.length){for(let p=0;p<x.length;p++)!Et(R[p].argvalues,x[p])&&et(Object.keys(x[p]),x[p],p);return}const S=Math.min(R.length,x.length);for(let p=0;p<S;p++)et(Object.keys(x[p]),x[p],p);if(x.length>R.length){if(!V?.length)return;for(let p=R.length;p<x.length;p++){const j=q(V,x[p],p);Q.default(K.end).before(j)}}else if(x.length<R.length)for(let p=x.length;p<R.length;p++)H(p)}}else et(w,F)}}};if(b&&f){const{attrs:w}=r.__getAttributes__(o);w.literals&&Object.entries(w.literals).forEach(([F,K])=>X[F]=K),w.expressions&&Object.entries(w.expressions).forEach(([F,K])=>{if(J.test(F)){const x=r.__evaluate__(F.replace(J,""),d);if(typeof x!=="object")throw new Error(`Invalid spread operator ${F}`);for(let S in x)X[S]=x[S];n[`${v?.syntax?$t:""}${f}.${F}`]=K}else X[F]=K?r.__evaluate__(K,d):!0,n[`${v?.syntax?$t:""}${f}.${F}`]=K})}return X}__getBoundaries__(t){return this.benchmark.inc("domOperations"),this.benchmark.inc("domInsertsCount"),{start:document.createComment(`s:${this.prepath}.${t}`),end:document.createComment(`e:${this.prepath}.${t}`)}}__getAttributes__(t){const n=t.attrs(),r={},o={literals:{},functions:{},expressions:{}};let f=[];return n&&Object.entries(n).forEach(([c,l])=>{if(c==":dtag")return;if(c.startsWith(":")||c.startsWith(kt)||c.startsWith(Mt)||J.test(c)||me.test(c))if(me.test(c)){const[i,d]=c.match(me)||[];f=d.split(",")}else if(c.startsWith(Mt))r[c.replace(Mt,"")]=l;else if(c.startsWith(kt))o.functions[c.replace(kt,"")]=l;else{if(c.startsWith(":"))c=c.slice(1,c.length);o.expressions[c]=l||""}else o.literals[c]=l}),{argv:f,events:r,attrs:o}}__withPath__(t,n){const r=this.__path;this.__path=t;const o=n();return this.__path=r,o}__getPathParent__(t){const n=t.split("/");return n.pop(),n.join("/")}__hasSamePathParent__(t,n){return t.startsWith(n)}__evaluate__(t,n){try{t=t.trim();const r=this.state.toJSON();if(n){const o={};for(let c in n)o[c]=n[c].value;const f=`with( scope ){ return ${t}; }`;return new Function("self","input","state","static","context","scope",f)(this,this.input,r,this.static,this.context,o||{})}else{const o=`return ${t}`;return new Function("self","input","state","static","context",o)(this,this.input,r,this.static,this.context)}}catch(r){return t}}__evaluateFunction__(t,n,r){if(/(\s*\w+|\s*\([^)]*\)|\s*)\s*=>\s*(\s*\{[^}]*\}|\s*[^\n;"]+)/g.test(t))return this.__evaluate__(t,r)(...n);else{let[o,...f]=t.split(/\s*,\s*/),c;if(o=this.__evaluate__(o,r),typeof o==="function")c=o;else{if(typeof this[o]!=="function")throw new Error(`Undefined <${o}> handler method`);c=this[o].bind(this)}if(typeof c!=="function")throw new Error(`Expected <${o}> to be a function or handler method`);let l=f.map((i)=>this.__evaluate__(i,r));if(n.length)l=[...l,...n];return c(...l)}}__interpolate__(t,n){return t.replace(/{\s*([^{}]+)\s*}/g,(r,o)=>this.__evaluate__(o,n))}__attachEvent__(t,n,r,o){t.on(n,(...f)=>this.__evaluateFunction__(r,f,o)),this.VER.push({element:t,_event:n}),this.benchmark.inc("domUpdatesCount"),this.benchmark.inc("domRemovalsCount")}__detachEvent__(t,n){t.off(n),this.benchmark.inc("domOperations"),this.benchmark.inc("domRemovalsCount")}__extractTextDeps__(t,n){const r=new Set;return(t.match(/{\s*([^{}]+)\s*}/g)||[]).forEach((o)=>{const f=o.replace(/[{}]/g,"").trim();this.__extractExpressionDeps__(f,n).forEach((c)=>r.add(c))}),Array.from(r)}__extractExpressionDeps__(t,n){const r=/\b(state|input|context)(?:\.[a-zA-Z_]\w*)+(?=\[|\.|$|\s|;|,|\))/g,o=/\b(self)(?:\.[a-zA-Z_]\w*)+(?=\()/g;let f=[...Array.from(t.matchAll(r)),...Array.from(t.matchAll(o))];if(n&&Object.keys(n).length){const c=new RegExp(`\\b(${Object.keys(n).join("|")})`,"g");f=[...f,...Array.from(t.matchAll(c))]}return[...new Set(f.map((c)=>c[0]))]}__isReactive__(t,n){if(/(state|input|context|self)\.[\w.]+/.test(t))return!0;if(n&&Object.keys(n).length&&new RegExp(Object.keys(n).join("|")).test(t))return!0;return!1}__trackDep__(t,n,r){if(r.memo&&r.memo[n]&&r.memo[n].type==="let")r.haslet=!0;!t.has(n)&&t.set(n,new Map),t.get(n)?.set(r.path,r),this.benchmark.inc("dependencyTrackCount")}__valueDep__(t,n){return n.reduce((r,o)=>r?.[o],t)}__shouldUpdate__(t,n,r,o){if(t==="self")return!0;const f=this.__valueDep__(o[t],n),c=this.__valueDep__(r[t],n);return!Et(f,c)}__updateDepNodes__(t,n){if(!this.FGUD?.size)return;this.benchmark.inc("componentUpdateCount"),this.benchmark.startRender(),this.FGUD.forEach((r,o)=>{const[f,...c]=o.split(".");if(!this.__shouldUpdate__(f,c,t,n))return;r.forEach((l)=>{const{path:i,batch:d,$fragment:y,boundaries:v,update:b,memo:V,syntax:R}=l;try{if(!R&&(v?.start&&!document.contains(v.start))||y!==null&&!y.closest("body").length){r.delete(i);return}if(d)this.UQS.queue({dep:o,dependent:l});else{const U=b(V,"main-updator");if(U)typeof U.memo==="object"&&r.set(i,{...l,memo:U.memo}),typeof U.cleanup==="function"&&U.cleanup()}this.benchmark.inc("dependencyUpdateCount")}catch(U){console.error("failed to update dependency nodes --",U);return}}),!r.size&&this.FGUD?.delete(o)}),this.benchmark.endRender()}__updateVarDepNodes__(t,n,r){if(!this.FGUD?.size)return;this.benchmark.inc("partialUpdateCount"),this.benchmark.startRender(),this.FGUD.get(t)?.forEach((o,f)=>{if(!o.haslet||!this.__hasSamePathParent__(f,this.__getPathParent__(n)))return;if(o.memo={...o.memo,...r},o.batch)this.UQS.queue({dep:t,dependent:o});else{const c=o.update(o.memo,"var-partial-updator");typeof c?.cleanup==="function"&&c.cleanup()}}),this.benchmark.endRender()}appendTo(t){const n=typeof t=="string"?Q.default(t):t;return this.$?.length&&n.append(this.$),this.benchmark.inc("domOperations"),this}prependTo(t){const n=typeof t=="string"?Q.default(t):t;return this.$?.length&&n.prepend(this.$),this.benchmark.inc("domOperations"),this}replaceWith(t){const n=typeof t=="string"?Q.default(t):t;return this.$?.length&&n.replaceWith(this.$),this.benchmark.inc("domOperations"),this}}var dn={};Kt(dn,{state:()=>{return Xr},handler:()=>{return zr},default:()=>{return Hr},declaration:()=>{return Yr}});var Yr={name:"if",syntax:!0,tags:{"else-if":{type:"nexted",many:!0,optional:!0},else:{type:"nexted",optional:!0}}},Xr={renderer:null},zr={onInput(){if(!this.input.renderer)return;if(this.input.by)this.state.renderer=this.input.renderer;else{let t=!1;if(Array.isArray(this.input["else-if"])&&this.input["else-if"].length)this.input["else-if"].forEach((n)=>{if(t||!n.by)return;this.state.renderer=n.renderer,t=!0});if(!t)this.state.renderer=this.input.else?this.input.else.renderer:null}}},Hr="<{state.renderer}/>",_n={};Kt(_n,{state:()=>{return Qr},handler:()=>{return Jr},default:()=>{return ti},declaration:()=>{return Wr},_static:()=>{return Zr}});var Wr={name:"for",syntax:!0,iterator:!0},Qr={argvlist:null},Zr={lastInput:null,processingBatch:!1},Jr={onInput(){if(this.static.processingBatch)return;if(!this.input.renderer)throw new Error("Undefined mesh renderer");let{in:t,from:n,to:r}=this.input;if(t===void 0&&n===void 0)throw new Error("Invalid <for> arguments");this.static.processingBatch=!0;try{if(n!==void 0){if(n=parseFloat(String(n)),r==null)throw new Error("Expected <from> <to> attributes of the for loop to be defined");if(r=parseFloat(String(r)),n===r)throw new Error("<from> and <to> attribute cannot have the same value");const o=n<r,f=Math.abs(r-n)+1;if(this.state.argvlist&&Array.isArray(this.state.argvlist)&&this.state.argvlist.length===f){const[l]=this.input.renderer.argv;if(l){let i=n,d=!0;for(let y=0;y<this.state.argvlist.length;y++){if(this.state.argvlist[y][l].value!==i){d=!1;break}i=o?i+1:i-1}if(d)return;i=n;for(let y=0;y<this.state.argvlist.length;y++)this.state.argvlist[y][l].value=i,i=o?i+1:i-1;return}}const c=[];for(let l=n;o?l<=r:l>=r;o?l++:l--){const i={},[d]=this.input.renderer.argv;if(d)i[d]={value:l,type:"arg"};c.push(i)}this.state.argvlist=c}else if(Array.isArray(t)){if(this.state.argvlist&&this.static.lastInput&&this.input.in===this.static.lastInput)return;if(!t.length){console.warn("empty for loop <in> attribute Array value"),this.state.argvlist=[];return}if(this.static.lastInput=t,this.state.argvlist&&Array.isArray(this.state.argvlist)&&this.state.argvlist.length===t.length){const[c,l]=this.input.renderer.argv;for(let i=0;i<t.length;i++){const d=this.state.argvlist[i];if(c)d[c].value=t[i]}return}const o=[];let f=0;for(let c of t){const l={},[i,d]=this.input.renderer.argv;if(i)l[i]={value:c,type:"arg"};if(d)l[d]={value:f,type:"arg"};o.push(l),f++}this.state.argvlist=o}else if(t instanceof Map){if(this.state.argvlist&&this.static.lastInput&&this.input.in===this.static.lastInput)return;if(!t.size){console.warn("empty for loop <in> attribute Map value"),this.state.argvlist=[];return}if(this.static.lastInput=t,this.state.argvlist&&Array.isArray(this.state.argvlist)&&this.state.argvlist.length===t.size){const[c,l,i]=this.input.renderer.argv;let d=0;for(let[y,v]of t){const b=this.state.argvlist[d];if(c)b[c].value=y;if(l)b[l].value=v;d++}return}const o=[];let f=0;for(let[c,l]of t){const i={},[d,y,v]=this.input.renderer.argv;if(d)i[d]={value:c,type:"arg"};if(y)i[y]={value:l,type:"arg"};if(v)i[v]={value:f,type:"arg"};o.push(i),f++}this.state.argvlist=o}else if(typeof t=="object"){if(this.state.argvlist&&this.static.lastInput&&this.input.in===this.static.lastInput)return;if(!Object.keys(t).length){console.warn("empty for loop <in> attribute Object value"),this.state.argvlist=[];return}this.static.lastInput=t;const o=Object.keys(t);if(this.state.argvlist&&Array.isArray(this.state.argvlist)&&this.state.argvlist.length===o.length){const[l,i,d]=this.input.renderer.argv;for(let y=0;y<o.length;y++){const v=o[y],b=this.state.argvlist[y];if(l)b[l].value=v;if(i)b[i].value=t[v]}return}const f=[];let c=0;for(let l in t){const i={},[d,y,v]=this.input.renderer.argv;if(d)i[d]={value:l,type:"arg"};if(y)i[y]={value:t[l],type:"arg"};if(v)i[v]={value:c,type:"arg"};f.push(i),c++}this.state.argvlist=f}}finally{this.static.processingBatch=!1}},updateItems(t){if(!this.input.renderer)throw new Error("Undefined mesh renderer");if(!Array.isArray(t)||!this.state.argvlist)return;this.static.processingBatch=!0;try{const[n]=this.input.renderer?.argv;if(!n)return;for(let{index:r,value:o}of t)if(r>=0&&r<this.state.argvlist.length)this.state.argvlist[r][n].value=o}finally{this.static.processingBatch=!1}},updateProperty(t,n){if(!this.input.renderer)throw new Error("Undefined mesh renderer");if(!this.state.argvlist)return;this.static.processingBatch=!0;try{for(let r=0;r<this.state.argvlist.length;r++){const o=this.state.argvlist[r];if(o[t])o[t].value=typeof n==="function"?n(o[t].value,r):n}}finally{this.static.processingBatch=!1}}},ti="<{input.renderer} #=state.argvlist/>",hn={};Kt(hn,{state:()=>{return ni},handler:()=>{return ri},default:()=>{return ii},declaration:()=>{return ei}});var ei={name:"async",syntax:!0,tags:{then:{type:"child"},catch:{type:"child",optional:!0},loading:{type:"child",optional:!0}}},ni={renderer:null,props:{}},ri={onInput(){if(!this.input.await)throw new Error("Undefined async <await> attribute");if(!(this.input.await instanceof Promise))throw new Error("Expected async <await> attribute value to be a function");if(this.input.loading)this.state.renderer=this.input.loading.renderer,this.state.props={};this.input.await.then((t)=>{if(!this.input.then)return;this.state.renderer=this.input.then.renderer;const[n]=this.input.then.renderer.argv;this.state.props={[n]:{value:t,type:"arg"}}}).catch((t)=>{if(!this.input.catch)return;this.state.renderer=this.input.catch.renderer;const[n]=this.input.then.renderer.argv;this.state.props={[n]:{value:t,type:"arg"}}})}},ii="<{state.renderer} #=state.props/>",yn={};Kt(yn,{state:()=>{return oi},handler:()=>{return ui},default:()=>{return ci},declaration:()=>{return ai}});var ai={name:"switch",syntax:!0,tags:{case:{type:"child",many:!0},default:{type:"child"}}},oi={renderer:null},ui={onInput(){let t=[];for(let n of this.input.case)if(n.is==this.input.by||Array.isArray(n.is)&&n.is.includes(this.input.by))Array.isArray(n.is)?t=[...new Set([...t,...n.is])]:t.push(n.is),this.state.renderer=n.renderer;if(!t.includes(this.input.by))this.state.renderer=this.input.default?this.input.default.renderer:null}},ci="<{state.renderer}/>",vn={};Kt(vn,{state:()=>{return fi},handler:()=>{return di},default:()=>{return _i},context:()=>{return pi},_static:()=>{return li}});var si=function(t){const n={};return t.split("&").map((r)=>{const[o,f]=r.split("=");n[o]=f}),n},fi={page:null,params:{},query:{}},li={global:!1,routes:[],defaultPath:null,currentPath:null,currentRoute:null},pi=["navigate"],di={onInput(){if(!this.input.routes)return;if(this.input.global)this.static.global=this.input.global;if(this.static.routes=this.input.routes.map(({path:t,template:n,default:r})=>{if(r)this.static.defaultPath=t;const o=t.match(/:[^\/]*(\/|$)/gi)||[],f=t.replaceAll("/","\\/").replaceAll(/:[^\/]*(\/|$)/gi,"([^\\/]+)(?:\\/|$)");return{path:t,template:n,default:r,pathVars:o,pathRegex:new RegExp(`${f}$`,"i")}}),this.input.global){const t=window.location.pathname;this.static.defaultPath=this.static.defaultPath&&t=="/"&&t!==this.static.defaultPath?this.static.defaultPath:t?t+window.location.search:this.static.routes[0].path}},onAttach(){if(this.input.global)window.navigate=this.navigate.bind(this),window.addEventListener("popstate",(t)=>t.state&&this.navigate(t.state.path,!0));this.setContext("navigate",this.navigate.bind(this)),this.static.defaultPath&&this.navigate(this.static.defaultPath)},navigate(t,n){!n&&this.static.global&&history.pushState({path:t},"",t);const r=t.split("?");t=r[0];const o=r[1]?si(r[1]):{};let f=null;if(this.static.currentRoute)f={path:this.static.currentRoute.path,params:this.state.params},this.emit("before",{fromState:f,toState:{path:t,query:o}});const c=this.match(t);if(!c){this.static.currentRoute=null,this.state.params={},this.state.query={},this.emit("not-found",t);return}const{route:l,params:i}=c;this.emit("after",{fromState:f,toState:{path:l.path,params:i,query:o}}),this.static.currentPath=t,this.static.currentRoute=l,this.state.params=i,this.state.query=o,this.state.page=l.template},match(t){const n={};let r=!1;for(let o of this.static.routes){const{pathVars:f,pathRegex:c}=o,l=t.match(c);if(l!==null&&l.index===0){for(let i=0;i+1<l.length&&i<f.length;i++)n[f[i].replaceAll(/[\/:]/g,"")]=l[i+1];r=o;break}}return r?{route:r,params:n}:!1}},_i="<{state.page} params=state.params query=state.query/>";class Te{debug=!1;store={};__root;i18n=new We;watcher;IUC;__setContext;__getContext;constructor(t){if(t?.debug)this.debug=t.debug;this.watcher=new Je,this.IUC=new Ze;const[n,r]=zt(t?.context||{});this.__setContext=r,this.__getContext=n,this.register("if",dn),this.register("for",_n),this.register("async",hn),this.register("switch",yn),this.register("router",vn)}register(t,n){return this.store[t]=n,this}unregister(t){return delete this.store[t],this}has(t){return t in this.store}import(t){if(!this.has(t))throw new Error(`<${t}> component not found`);if(!this.store[t].declaration?.syntax&&!this.store[t].default)throw new Error(`Invalid <${t}> component`);return this.store[t]}render(t,n,r){const{default:o,...f}=n,c={debug:this.debug,prepath:"0",lips:this},l=new Ce(t,o||"",{...f,input:r},c);return window.addEventListener("beforeunload",()=>{return this.dispose(),l.destroy(),null}),window.addEventListener("pagehide",(i)=>{!i.persisted&&this.dispose()}),document.addEventListener("visibilitychange",()=>{if(document.visibilityState!=="hidden")return;this.IUC.prepareForPotentialUnload()}),l}root(t,n){return this.__root=this.render("__ROOT__",t),this.__root.appendTo(n),this.__root}language(t){this.i18n.setLang(t)&&this.__root?.rerender()}setContext(t,n){const r=this.__getContext();if(typeof t==="string"){const o={...r,[t]:n};ot(r,o)&&this.__setContext(o)}else if(!Array.isArray(t)){const o={...r,...t};ot(r,o)&&this.__setContext(o)}else throw new Error("Invalid context data")}getContext(){return this.__getContext()}useContext(t,n){if(!t.length)return;pn(()=>{const r=this.__getContext();if(!r)return;const o=Object.fromEntries(t.map((f)=>[f,r[f]]));o&&typeof n==="function"&&Object.keys(o).length&&n(o)})}dispose(){this.watcher?.dispose(),this.__root?.destroy()}}var mn={Undo:"Undo",Redo:"Redo",Reinitialize:"Reinitialize",Settings:"Settings",Link:"Link","Device Screens":{"*":"Device Screens",UK:"Media Devices"},Bold:"Bold",Count:"Count"};var gn={Undo:"Annuler",Redo:"Refaire",Reinitialize:"R\xE9initialiser",Settings:"Param\xEAtre",Link:"Lien","Device Screens":"Dispositifs",Bold:"Gras",Button:"Bouton",Count:"Compter"};var Pt=new Te;Pt.setContext({lang:"en-US",online:!0,getUser(t){return new Promise((n,r)=>{setTimeout(()=>n({name:t,email:"g.peter@mail.com"}),3000)})}});Pt.i18n.setDictionary("en",mn);Pt.i18n.setDictionary("fr",gn);we(Pt);Pt.root(_e,"body");setTimeout(()=>{Pt.setContext("online",!1)},5000);setTimeout(()=>window.navigate("/account?userid=1001"),2000);setTimeout(()=>window.navigate("/account?userid=20"),5000);setTimeout(()=>Pt.getContext().navigate("/product/00009?category=phone"),8000);

//# debugId=1AFB8FC56A4412F964756e2164756e21
