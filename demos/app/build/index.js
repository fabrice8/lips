var zn=Object.defineProperty;var Tt=(t,n)=>{for(var r in n)zn(t,r,{get:n[r],enumerable:!0,configurable:!0,set:(s)=>n[r]=()=>s})};var fe={};Tt(fe,{state:()=>{{return Jn}},handler:()=>{{return er}},default:()=>{{return nr}},context:()=>{{return tr}},_static:()=>{{return Zn}}});var le={};Tt(le,{default:()=>{{return Xn}}});var Xn=`
  <section style="{ border: '2px solid gray', margin: '3rem', padding: '15px' }">
    <counter initial=state.initial
              on-update="value => console.log( value )">
      Count till 12
    </counter>

    <counter initial=1>
      Note: 10
    </counter>

    <p>I'm <span text="context.online ? 'Online' : 'Offline'"></span></p>

    <br><br>
    <button on-click="() => state.initial = 10">Reinitialize</button>
    <button title="Undo"
            style="background: black;color: white" 
            on-click="() => self.destroy()">Destroy</button>
    <br>
    <profile></profile>
  </section>
`;var pe={};Tt(pe,{default:()=>{{return Hn}}});var Hn=`
  <section>
    User Account ID: <span @text=input.query.userid></span>
  </section>
`;var de={};Tt(de,{default:()=>{{return Qn}},context:()=>{{return Wn}}});var Wn=["navigate"],Qn=`
  <section>
    <p>Product ID: <span @text=input.params.id></span></p>
    <p>Product Category: <span @text=input.query.category></span></p>

    <br>
    <button on-click(() => context.navigate('/') )>Go home</button>
  </section>
`;var Zn={routes:[{path:"/",template:le,default:!0},{path:"/account",template:pe},{path:"/product/:id",template:de}]},Jn={initial:3},tr=["online"],er={onRouteChange(...t){console.log("Route changed -- ",...t)},onPageNotFound(t){console.log(`<${t}> page not found`)}},nr=`
<main>
  <router routes=static.routes
          global
          on-after(onRouteChange, 'after')
          on-before(onRouteChange, 'before')
          on-not-found(onPageNotFound)></router>
  
  <footer></footer>
</main>
`;var he={};Tt(he,{stylesheet:()=>{{return ur}},state:()=>{{return ir}},handler:()=>{{return sr}},default:()=>{{return ar}},context:()=>{{return or}},_static:()=>{{return rr}}});var rr={limit:12},or=["lang"],ir={count:0},sr={onInput(){this.state.count=Number(this.input.initial)},handleClick(t){if(this.state.count>=this.static.limit)return;this.state.count++,this.emit("update",this.state.count)}},ur=`
  span { font: 14px arial; color: blue; }
`,ar=`
  <div>
    <{input.renderer}/>: 
    <span @text=state.count></span>
    <br>
    <button on-click(handleClick)>
      <span @text="Count"></span>
      (<span @text=context.lang></span>)
    </button>
  </div>
`;var _e={};Tt(_e,{stylesheet:()=>{{return lr}},default:()=>{{return pr}},context:()=>{{return cr}}});var cr=["getUser"],lr=`
  * { font-family: helvetica }
`,pr=`
  <async await( context.getUser, 'Peter Giligous' )>
    <loading>Preloading...</loading>
    <then [response]>
      <div>
        <ul style="{ border: '1px solid black', padding: '15px' }">
          <li @text=response.name></li>
          <li @text=response.email></li>
        </ul>

        <counter initial=5 on-update(value => console.log('procount --', value ))>By</counter>
      </div>
    </then>
    <catch [error]><span @text=error></span></catch>
  </async>
`;var me={};Tt(me,{default:()=>{{return fr}},_static:()=>{{return dr}}});var dr={content:"Nexted counter component"},fr=`
  <p>
    <small style="color:gray" @text=static.content>...</small>
  </p>
`;var Ge=(t)=>{t.register("counter",he),t.register("profile",_e),t.register("footer",me)};var st=function(t,n){if(t===n)return!1;if(typeof t!=="object"||typeof n!=="object")return!1;if(t===null||n===null)return!0;if(t instanceof Set){if(!(n instanceof Set))return!0;if(t.size!==n.size)return!0;if(Ue(t)&&Ue(n)){for(let l of t)if(!n.has(l))return!0;return!1}const a=new WeakMap;for(let l of t){let o=!1;if(typeof l!=="object"){if(n.has(l))o=!0}else for(let d of n){if(typeof d!=="object")continue;if(!a.has(l))a.set(l,new WeakMap);const m=a.get(l);if(m.has(d)){if(o=m.get(d),o)break;continue}const b=!st(l,d);if(m.set(d,b),b){o=!0;break}}if(!o)return!0}return!1}if(t instanceof Map){if(!(n instanceof Map))return!0;if(t.size!==n.size)return!0;if(Be(t)&&Be(n)){for(let[l,o]of t)if(n.get(l)!==o)return!0;return!1}const a=new WeakMap;for(let[l,o]of t){if(typeof l!=="object"){if(!n.has(l))return!0;const b=n.get(l);if(typeof o!=="object"){if(o!==b)return!0;continue}if(typeof b!=="object"||st(o,b))return!0;continue}let d=!1,m=!1;for(let[b,g]of n){if(typeof b!=="object")continue;if(!a.has(l))a.set(l,new WeakMap);const V=a.get(l);if(V.has(b)){const[N,M]=V.get(b);if(N){d=!0,m=M;break}continue}if(!st(l,b)){if(d=!0,m=typeof o==="object"&&typeof g==="object"?!st(o,g):o===g,V.set(b,[!0,m]),m)break}else V.set(b,[!1,!1])}if(!d||!m)return!0}return!1}if(Array.isArray(t)){if(!Array.isArray(n))return!0;if(t.length!==n.length)return!0;for(let a=0;a<t.length;a++){const l=t[a],o=n[a];if(l!==o&&(typeof l!=="object"||st(l,o)))return!0}return!1}const r=Object.keys(t),s=Object.keys(n);if(r.length!==s.length)return!0;r.sort(),s.sort();const c=r.length;for(let a=0;a<c;a++)if(r[a]!==s[a])return!0;for(let a=0;a<c;a++){const l=r[a],o=t[l],d=n[l];if(o===d)continue;if(o instanceof Date){if(!(d instanceof Date)||String(o)!==String(d))return!0;continue}if(o instanceof RegExp){if(!(d instanceof RegExp)||o.source!==d.source||o.flags!==d.flags)return!0;continue}if(o instanceof Map){if(!(d instanceof Map)||st(o,d))return!0;continue}if(o instanceof Set){if(!(d instanceof Set)||st(o,d))return!0;continue}if(o instanceof Function){if(!(d instanceof Function))return!0;continue}if(typeof o==="object"){if(typeof d!=="object")return!0;if(o===t){if(d!==n)return!0}else if(st(o,d))return!0}else return!0}return!1},$t=function(t,n){if(t===n)return!0;if(t==null||n==null)return t===n;const r=typeof t;if(r!==typeof n)return!1;if(r!=="object"){if(r==="number"&&isNaN(t)&&isNaN(n))return!0;return!1}if(t instanceof Date)return n instanceof Date&&t.getTime()===n.getTime();if(t instanceof RegExp)return n instanceof RegExp&&t.source===n.source&&t.flags===n.flags;if(t instanceof Error)return n instanceof Error&&t.name===n.name&&t.message===n.message&&(t.stack===n.stack||!t.stack&&!n.stack);if(typeof ArrayBuffer!=="undefined"&&ArrayBuffer.isView(t)){if(!ArrayBuffer.isView(n))return!1;if(t.byteLength!==n.byteLength)return!1;const l=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),o=new Uint8Array(n.buffer,n.byteOffset,n.byteLength);for(let d=0;d<l.length;d++)if(l[d]!==o[d])return!1;return!0}if(t instanceof Promise||t instanceof WeakMap||t instanceof WeakSet)return t===n;if(typeof t==="function"){if(typeof n!=="function")return!1;return t.toString()===n.toString()&&t.name===n.name}if(t.constructor!==n.constructor)return!1;if(t instanceof Map||t instanceof Set||Array.isArray(t)||Object.getPrototypeOf(t)===Object.prototype)return!st(t,n);const s=Object.getPrototypeOf(t);if(s!==Object.getPrototypeOf(n))return!1;const c=Object.getOwnPropertyNames(t),a=Object.getOwnPropertyNames(n);if(c.length!==a.length)return!1;for(let l of c){if(!Object.prototype.hasOwnProperty.call(n,l))return!1;if(!$t(t[l],n[l]))return!1}if(s!==null&&s!==Object.prototype){const l=Object.getOwnPropertyNames(s),o=Object.getOwnPropertyNames(Object.getPrototypeOf(n));if(l.length!==o.length)return!1;for(let d of l){if(d==="constructor")continue;if(!$t(s[d],Object.getPrototypeOf(n)[d]))return!1}}return!0},et=function(t,n=new WeakMap){if(t===null||typeof t!=="object"||t instanceof Promise)return t;if(n.has(t))return n.get(t);if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp)return new RegExp(t.source,t.flags);if(t instanceof Map){const c=new Map;return n.set(t,c),t.forEach((a,l)=>c.set(et(l,n),et(a,n))),c}if(t instanceof Set){const c=new Set;return n.set(t,c),t.forEach((a)=>c.add(et(a,n))),c}if(Array.isArray(t)){const c=[];n.set(t,c);for(let a=0;a<t.length;a++)c[a]=et(t[a],n);return c}if(ArrayBuffer.isView(t))return new t.constructor(t);const r=Object.create(Object.getPrototypeOf(t));n.set(t,r);const s=Object.getOwnPropertySymbols(t);for(let c of s)r[c]=et(t[c],n);for(let c in t)if(Object.prototype.hasOwnProperty.call(t,c))r[c]=et(t[c],n);return r},Ar=function(t,n){if(!t||typeof t!=="object")throw new TypeError("Original argument must be an object");if(!n||typeof n!=="object")throw new TypeError("ToSet argument must be an object");if(!Object.keys(n).length)return{...t};function r(c,a,l){const o=a.split(/\.|\[|\]/).filter(Boolean);let d=c;for(let m=0;m<o.length;m++){const b=o[m],g=!isNaN(Number(b)),V=m===o.length-1,N=!isNaN(Number(o[m+1]));if(V){d[b]=l;continue}if(!(b in d))d[b]=N?[]:{};else if(N&&!Array.isArray(d[b]))d[b]=[];else if(!N&&Array.isArray(d[b]))d[b]={};d=d[b]}}const s=et(t);try{for(let[c,a]of Object.entries(n)){if(typeof c!=="string")throw new TypeError(`Invalid path: ${c}`);if(!/^[a-zA-Z0-9_\-\[\].]+$/.test(c))throw new Error(`Invalid path format: ${c}`);r(s,c,a)}}catch(c){throw new Error(`Failed to assign value: ${c.message}`)}return s},un=function(t){return t.trim()},Bt=function(t,n,r){return t.replace(n,r)},$r=function(t,n,r){return t.indexOf(n,r)},Nt=function(t,n){return t.charCodeAt(n)|0},St=function(t,n,r){return t.slice(n,r)},vt=function(t){return t.length},an=function(t){return t.length},Ut=function(t,n){return n.push(t),t},ge=function(t,n,r,s,c,a,l,o){return{value:t,root:n,parent:r,type:s,props:c,children:a,line:Zt,column:jt,length:l,return:"",siblings:o}},Pr=function(){return J},Rr=function(){if(J=lt>0?Nt(Vt,--lt):0,jt--,J===10)jt=1,Zt--;return J},ht=function(){if(J=lt<ln?Nt(Vt,lt++):0,jt++,J===10)jt=1,Zt++;return J},Et=function(){return Nt(Vt,lt)},Yt=function(){return lt},Qt=function(t,n){return St(Vt,t,n)},wt=function(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0},Nr=function(t){return Zt=jt=1,ln=vt(Vt=t),lt=0,[]},Sr=function(t){return Vt="",t},be=function(t){return un(Qt(lt-1,Ae(t===91?t+2:t===40?t+1:t)))},jr=function(t){while(J=Et())if(J<33)ht();else break;return wt(t)>2||wt(J)>3?"":" "},Vr=function(t,n){while(--n&&ht())if(J<48||J>102||J>57&&J<65||J>70&&J<97)break;return Qt(t,Yt()+(n<6&&Et()==32&&ht()==32))},Ae=function(t){while(ht())switch(J){case t:return lt;case 34:case 39:if(t!==34&&t!==39)Ae(J);break;case 40:if(t===41)Ae(t);break;case 92:ht();break}return lt},Lr=function(t,n){while(ht())if(t+J===57)break;else if(t+J===84&&Et()===47)break;return"/*"+Qt(n,lt-1)+"*"+xe(t===47?t:ht())},Dr=function(t){while(!wt(Et()))ht();return Qt(t,lt)},Or=function(t){return Sr(qt("",null,null,null,[""],t=Nr(t),0,[0],t))},qt=function(t,n,r,s,c,a,l,o,d){var m=0,b=0,g=l,V=0,N=0,M=0,Y=1,tt=1,z=1,B=0,U="",w=c,F=a,T=s,f=U;while(tt)switch(M=B,B=ht()){case 40:if(M!=108&&Nt(f,g-1)==58){if($r(f+=Bt(be(B),"&","&\f"),"&\f",cn(m?o[m-1]:0))!=-1)z=-1;break}case 34:case 39:case 91:f+=be(B);break;case 9:case 10:case 13:case 32:f+=jr(M);break;case 92:f+=Vr(Yt()-1,7);continue;case 47:switch(Et()){case 42:case 47:if(Ut(Ir(Lr(ht(),Yt()),n,r,d),d),(wt(M||1)==5||wt(Et()||1)==5)&&vt(f)&&St(f,-1,void 0)!==" ")f+=" ";break;default:f+="/"}break;case 123*Y:o[m++]=vt(f)*z;case 125*Y:case 59:case 0:switch(B){case 0:case 125:tt=0;case 59+b:if(z==-1)f=Bt(f,/\f/g,"");if(N>0&&(vt(f)-g||Y===0&&M===47))Ut(N>32?qe(f+";",s,r,g-1,d):qe(Bt(f," ","")+";",s,r,g-2,d),d);break;case 59:f+=";";default:if(Ut(T=Ye(f,n,r,m,b,c,o,U,w=[],F=[],g,a),a),B===123)if(b===0)qt(f,n,T,T,w,a,g,o,F);else{switch(V){case 99:if(Nt(f,3)===110)break;case 108:if(Nt(f,2)===97)break;default:b=0;case 100:case 109:case 115:}if(b)qt(t,T,T,s&&Ut(Ye(t,T,T,0,0,c,o,U,c,w=[],g,F),F),c,F,g,o,s?w:F);else qt(f,T,T,T,[""],F,0,o,F)}}m=b=N=0,Y=z=1,U=f="",g=l;break;case 58:g=1+vt(f),N=M;default:if(Y<1){if(B==123)--Y;else if(B==125&&Y++==0&&Rr()==125)continue}switch(f+=xe(B),B*Y){case 38:z=b>0?1:(f+="\f",-1);break;case 44:o[m++]=(vt(f)-1)*z,z=1;break;case 64:if(Et()===45)f+=be(ht());V=Et(),b=g=vt(U=f+=Dr(Yt())),B++;break;case 45:if(M===45&&vt(f)==2)Y=0}}return a},Ye=function(t,n,r,s,c,a,l,o,d,m,b,g){var V=c-1,N=c===0?a:[""],M=an(N);for(var Y=0,tt=0,z=0;Y<s;++Y)for(var B=0,U=St(t,V+1,V=cn(tt=l[Y])),w=t;B<M;++B)if(w=un(tt>0?N[B]+" "+U:Bt(U,/&\f/g,N[B])))d[z++]=w;return ge(t,n,r,c===0?on:o,d,m,b,g)},Ir=function(t,n,r,s){return ge(t,n,r,rn,xe(Pr()),St(t,2,-2),0,s)},qe=function(t,n,r,s,c){return ge(t,n,r,sn,St(t,0,s),St(t,s+1,-1),s,c)},ke=function(t,n){var r="";for(var s=0;s<t.length;s++)r+=n(t[s],s,t,n)||"";return r},wr=function(t,n,r,s){switch(t.type){case Tr:if(t.children.length)break;case gr:case Er:case sn:return t.return=t.return||t.value;case rn:return"";case Cr:return t.return=t.value+"{"+ke(t.children,s)+"}";case on:if(!vt(t.value=t.props.join(",")))return""}return vt(r=ke(t.children,s))?t.return=t.value+"{"+r+"}":""},Fr=function(t){var n=an(t);return function(r,s,c,a){var l="";for(var o=0;o<n;o++)l+=t[o](r,s,c,a)||"";return l}},Br=function(t){if(/\bstate\.|\binput\.|\bself\.|\bcontext\./.test(t))return!0;if(/[\+\*\/\%\(\)\{\}\[\]]|\?\s*:/.test(t))return!0;if(/\b[a-zA-Z_][a-zA-Z0-9_]*\.[a-zA-Z_]/.test(t))return!0;if(t.includes("{")&&t.includes("}"))return!0;return!1},ze=function(t){let n=(t||"").trim().replace(/>\s*</g,"><").replace(/\s{2,}/g," ").replace(/[\r\n\t]/g,"").replace(/<([a-zA-Z0-9_-]+)([^>]*?)\s*\/>/g,"<$1$2></$1>").replace(/<\{([^}]+)\}\s*(.*?)\/>/g,'<lips dtag="$1" $2></lips>').replace(/(<>)([\s\S]*?)(<\/>)/g,'<lips fragment="true">$2</lips>').replace(/<if\(\s*(.*?)\s*\)>/g,'<if @by="$1">').replace(/<else-if\(\s*(.*?)\s*\)>/g,'<else-if @by="$1">').replace(/<switch\(\s*(.*?)\s*\)>/g,'<switch @by="$1">').replace(/<async await\(\s*(.*?)\s*\)>/g,`<async ${yt}await="$1">`).replace(/<log\(\s*(.*?)\s*\)>/g,'<log @args="$1">').replace(/\[(.*?)\]/g,(r)=>r.replace(/\s+/g,""));return n=Mr(n),n=Gr(n),n},zt=function(t,n={maxSize:100}){const r=new Set,s=[{value:t,timestamp:Date.now()}];let c=0;const a=()=>{const o=Xt[Xt.length-1];return o&&Yr(o,r),s[c].value},l=()=>{const o=[...r];if(He)for(let d of o)He.add(d);else for(let d of o)d.execute()};return[a,(o,d)=>{if(Object.is(s[c].value,o))return;if(c<s.length-1)s.splice(c+1);if(s.push({value:o,timestamp:Date.now(),metadata:d}),s.length>n.maxSize)s.shift(),c=Math.max(0,c-1);else c++;l()},{undo(){if(c>0)c--,l()},redo(){if(c<s.length-1)c++,l()},jumpTo(o){if(o>=0&&o<s.length&&o!==c)c=o,l()},getHistory(){return[...s]},getCurrentIndex(){return c},canUndo(){return c>0},canRedo(){return c<s.length-1},clear(){const o=s[0];s.length=0,s.push(o),c=0,l()}}]},dn=function(t){let n=!1;const r=()=>{if(n)throw new Error("Circular dependency detected");if(s.isDisposed)return;n=!0,Xe(s),Xt.push(s);try{t()}finally{n=!1,Xt.pop()}},s={execute:r,dependencies:new Set,isDisposed:!1};return r(),{dispose:()=>{s.isDisposed=!0,Xe(s)}}},hr=Object.create,{defineProperty:ye,getPrototypeOf:_r,getOwnPropertyNames:mr}=Object,vr=Object.prototype.hasOwnProperty,Ht=(t,n,r)=>{r=t!=null?hr(_r(t)):{};const s=n||!t||!t.__esModule?ye(r,"default",{value:t,enumerable:!0}):r;for(let c of mr(t))if(!vr.call(s,c))ye(s,c,{get:()=>t[c],enumerable:!0});return s},br=(t,n)=>()=>(n||t((n={exports:{}}).exports,n),n.exports),Ft=(t,n)=>{for(var r in n)ye(t,r,{get:n[r],enumerable:!0,configurable:!0,set:(s)=>n[r]=()=>s})},Wt=br((t,n)=>{(function(){var r=document,s=window,c=r.documentElement,a=r.createElement.bind(r),l=a("div"),o=a("table"),d=a("tbody"),m=a("tr"),b=Array.isArray,g=Array.prototype,V=g.concat,N=g.filter,M=g.indexOf,Y=g.map,tt=g.push,z=g.slice,B=g.some,U=g.splice,w=/^#(?:[\w-]|\\.|[^\x00-\xa0])*$/,F=/^\.(?:[\w-]|\\.|[^\x00-\xa0])*$/,T=/<.+>/,f=/^\w+$/;function A(e,i){var u=D(i);return!e||!u&&!R(i)&&!C(i)?[]:!u&&F.test(e)?i.getElementsByClassName(e.slice(1).replace(/\\/g,"")):!u&&f.test(e)?i.getElementsByTagName(e):i.querySelectorAll(e)}var v=function(){function e(i,u){if(!i)return;if(P(i))return i;var h=i;if(x(i)){var k=u||r;if(h=w.test(i)&&R(k)?k.getElementById(i.slice(1).replace(/\\/g,"")):T.test(i)?Pe(i):P(k)?k.find(i):x(k)?_(k).find(i):A(i,k),!h)return}else if(S(i))return this.ready(i);if(h.nodeType||h===s)h=[h];this.length=h.length;for(var E=0,L=this.length;E<L;E++)this[E]=h[E]}return e.prototype.init=function(i,u){return new e(i,u)},e}(),p=v.prototype,_=p.init;if(_.fn=_.prototype=p,p.length=0,p.splice=U,typeof Symbol==="function")p[Symbol.iterator]=g[Symbol.iterator];function P(e){return e instanceof v}function G(e){return!!e&&e===e.window}function R(e){return!!e&&e.nodeType===9}function D(e){return!!e&&e.nodeType===11}function C(e){return!!e&&e.nodeType===1}function $(e){return!!e&&e.nodeType===3}function I(e){return typeof e==="boolean"}function S(e){return typeof e==="function"}function x(e){return typeof e==="string"}function y(e){return e===void 0}function j(e){return e===null}function X(e){return!isNaN(parseFloat(e))&&isFinite(e)}function H(e){if(typeof e!=="object"||e===null)return!1;var i=Object.getPrototypeOf(e);return i===null||i===Object.prototype}_.isWindow=G,_.isFunction=S,_.isArray=b,_.isNumeric=X,_.isPlainObject=H;function O(e,i,u){if(u){var h=e.length;while(h--)if(i.call(e[h],h,e[h])===!1)return e}else if(H(e)){var k=Object.keys(e);for(var h=0,E=k.length;h<E;h++){var L=k[h];if(i.call(e[L],L,e[L])===!1)return e}}else for(var h=0,E=e.length;h<E;h++)if(i.call(e[h],h,e[h])===!1)return e;return e}_.each=O,p.each=function(e){return O(this,e)},p.empty=function(){return this.each(function(e,i){while(i.firstChild)i.removeChild(i.firstChild)})};function q(){var e=[];for(var i=0;i<arguments.length;i++)e[i]=arguments[i];var u=I(e[0])?e.shift():!1,h=e.shift(),k=e.length;if(!h)return{};if(!k)return q(u,_,h);for(var E=0;E<k;E++){var L=e[E];for(var K in L)if(u&&(b(L[K])||H(L[K]))){if(!h[K]||h[K].constructor!==L[K].constructor)h[K]=new L[K].constructor;q(u,h[K],L[K])}else h[K]=L[K]}return h}_.extend=q,p.extend=function(e){return q(p,e)};var _t=/\S+/g;function W(e){return x(e)?e.match(_t)||[]:[]}p.toggleClass=function(e,i){var u=W(e),h=!y(i);return this.each(function(k,E){if(!C(E))return;O(u,function(L,K){if(h)i?E.classList.add(K):E.classList.remove(K);else E.classList.toggle(K)})})},p.addClass=function(e){return this.toggleClass(e,!0)},p.removeAttr=function(e){var i=W(e);return this.each(function(u,h){if(!C(h))return;O(i,function(k,E){h.removeAttribute(E)})})};function rt(e,i){if(!e)return;if(x(e)){if(arguments.length<2){if(!this[0]||!C(this[0]))return;var u=this[0].getAttribute(e);return j(u)?void 0:u}if(y(i))return this;if(j(i))return this.removeAttr(e);return this.each(function(k,E){if(!C(E))return;E.setAttribute(e,i)})}for(var h in e)this.attr(h,e[h]);return this}p.attr=rt,p.removeClass=function(e){if(arguments.length)return this.toggleClass(e,!1);return this.attr("class","")},p.hasClass=function(e){return!!e&&B.call(this,function(i){return C(i)&&i.classList.contains(e)})},p.get=function(e){if(y(e))return z.call(this);return e=Number(e),this[e<0?e+this.length:e]},p.eq=function(e){return _(this.get(e))},p.first=function(){return this.eq(0)},p.last=function(){return this.eq(-1)};function Lt(e){if(y(e))return this.get().map(function(i){return C(i)||$(i)?i.textContent:""}).join("");return this.each(function(i,u){if(!C(u))return;u.textContent=e})}p.text=Lt;function ct(e,i,u){if(!C(e))return;var h=s.getComputedStyle(e,null);return u?h.getPropertyValue(i)||void 0:h[i]||e.style[i]}function it(e,i){return parseInt(ct(e,i),10)||0}function pt(e,i){return it(e,"border".concat(i?"Left":"Top","Width"))+it(e,"padding".concat(i?"Left":"Top"))+it(e,"padding".concat(i?"Right":"Bottom"))+it(e,"border".concat(i?"Right":"Bottom","Width"))}var At={};function Dt(e){if(At[e])return At[e];var i=a(e);r.body.insertBefore(i,null);var u=ct(i,"display");return r.body.removeChild(i),At[e]=u!=="none"?u:"block"}function Ot(e){return ct(e,"display")==="none"}function Te(e,i){var u=e&&(e.matches||e.webkitMatchesSelector||e.msMatchesSelector);return!!u&&!!i&&u.call(e,i)}function Mt(e){return x(e)?function(i,u){return Te(u,e)}:S(e)?e:P(e)?function(i,u){return e.is(u)}:!e?function(){return!1}:function(i,u){return u===e}}p.filter=function(e){var i=Mt(e);return _(N.call(this,function(u,h){return i.call(u,h,u)}))};function kt(e,i){return!i?e:e.filter(i)}p.detach=function(e){return kt(this,e).each(function(i,u){if(u.parentNode)u.parentNode.removeChild(u)}),this};var An=/^\s*<(\w+)[^>]*>/,kn=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,$e={"*":l,tr:d,td:m,th:m,thead:o,tbody:o,tfoot:o};function Pe(e){if(!x(e))return[];if(kn.test(e))return[a(RegExp.$1)];var i=An.test(e)&&RegExp.$1,u=$e[i]||$e["*"];return u.innerHTML=e,_(u.childNodes).detach().get()}_.parseHTML=Pe,p.has=function(e){var i=x(e)?function(u,h){return A(e,h).length}:function(u,h){return h.contains(e)};return this.filter(i)},p.not=function(e){var i=Mt(e);return this.filter(function(u,h){return(!x(e)||C(h))&&!i.call(h,u,h)})};function bt(e,i,u,h){var k=[],E=S(i),L=h&&Mt(h);for(var K=0,dt=e.length;K<dt;K++)if(E){var nt=i(e[K]);if(nt.length)tt.apply(k,nt)}else{var ut=e[K][i];while(ut!=null){if(h&&L(-1,ut))break;k.push(ut),ut=u?ut[i]:null}}return k}function Re(e){if(e.multiple&&e.options)return bt(N.call(e.options,function(i){return i.selected&&!i.disabled&&!i.parentNode.disabled}),"value");return e.value||""}function xn(e){if(!arguments.length)return this[0]&&Re(this[0]);return this.each(function(i,u){var h=u.multiple&&u.options;if(h||Me.test(u.type)){var k=b(e)?Y.call(e,String):j(e)?[]:[String(e)];if(h)O(u.options,function(E,L){L.selected=k.indexOf(L.value)>=0},!0);else u.checked=k.indexOf(u.value)>=0}else u.value=y(e)||j(e)?"":e})}p.val=xn,p.is=function(e){var i=Mt(e);return B.call(this,function(u,h){return i.call(u,h,u)})},_.guid=1;function mt(e){return e.length>1?N.call(e,function(i,u,h){return M.call(h,i)===u}):e}_.unique=mt,p.add=function(e,i){return _(mt(this.get().concat(_(e,i).get())))},p.children=function(e){return kt(_(mt(bt(this,function(i){return i.children}))),e)},p.parent=function(e){return kt(_(mt(bt(this,"parentNode"))),e)},p.index=function(e){var i=e?_(e)[0]:this[0],u=e?this:_(i).parent().children();return M.call(u,i)},p.closest=function(e){var i=this.filter(e);if(i.length)return i;var u=this.parent();if(!u.length)return i;return u.closest(e)},p.siblings=function(e){return kt(_(mt(bt(this,function(i){return _(i).parent().children().not(i)}))),e)},p.find=function(e){return _(mt(bt(this,function(i){return A(e,i)})))};var gn=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,En=/^$|^module$|\/(java|ecma)script/i,Cn=["type","src","nonce","noModule"];function Tn(e,i){var u=_(e);u.filter("script").add(u.find("script")).each(function(h,k){if(En.test(k.type)&&c.contains(k)){var E=a("script");E.text=k.textContent.replace(gn,""),O(Cn,function(L,K){if(k[K])E[K]=k[K]}),i.head.insertBefore(E,null),i.head.removeChild(E)}})}function $n(e,i,u,h,k){if(h)e.insertBefore(i,u?e.firstChild:null);else if(e.nodeName==="HTML")e.parentNode.replaceChild(i,e);else e.parentNode.insertBefore(i,u?e:e.nextSibling);if(k)Tn(i,e.ownerDocument)}function xt(e,i,u,h,k,E,L,K){return O(e,function(dt,nt){O(_(nt),function(ut,Ct){O(_(i),function(ft,Kt){var se=u?Ct:Kt,ue=u?Kt:Ct,at=u?ut:ft;$n(se,!at?ue:ue.cloneNode(!0),h,k,!at)},K)},L)},E),i}p.after=function(){return xt(arguments,this,!1,!1,!1,!0,!0)},p.append=function(){return xt(arguments,this,!1,!1,!0)};function Pn(e){if(!arguments.length)return this[0]&&this[0].innerHTML;if(y(e))return this;var i=/<script[\s>]/.test(e);return this.each(function(u,h){if(!C(h))return;if(i)_(h).empty().append(e);else h.innerHTML=e})}p.html=Pn,p.appendTo=function(e){return xt(arguments,this,!0,!1,!0)},p.wrapInner=function(e){return this.each(function(i,u){var h=_(u),k=h.contents();k.length?k.wrapAll(e):h.append(e)})},p.before=function(){return xt(arguments,this,!1,!0)},p.wrapAll=function(e){var i=_(e),u=i[0];while(u.children.length)u=u.firstElementChild;return this.first().before(i),this.appendTo(u)},p.wrap=function(e){return this.each(function(i,u){var h=_(e)[0];_(u).wrapAll(!i?h:h.cloneNode(!0))})},p.insertAfter=function(e){return xt(arguments,this,!0,!1,!1,!1,!1,!0)},p.insertBefore=function(e){return xt(arguments,this,!0,!0)},p.prepend=function(){return xt(arguments,this,!1,!0,!0,!0,!0)},p.prependTo=function(e){return xt(arguments,this,!0,!0,!0,!1,!1,!0)},p.contents=function(){return _(mt(bt(this,function(e){return e.tagName==="IFRAME"?[e.contentDocument]:e.tagName==="TEMPLATE"?e.content.childNodes:e.childNodes})))},p.next=function(e,i,u){return kt(_(mt(bt(this,"nextElementSibling",i,u))),e)},p.nextAll=function(e){return this.next(e,!0)},p.nextUntil=function(e,i){return this.next(i,!0,e)},p.parents=function(e,i){return kt(_(mt(bt(this,"parentElement",!0,i))),e)},p.parentsUntil=function(e,i){return this.parents(i,e)},p.prev=function(e,i,u){return kt(_(mt(bt(this,"previousElementSibling",i,u))),e)},p.prevAll=function(e){return this.prev(e,!0)},p.prevUntil=function(e,i){return this.prev(i,!0,e)},p.map=function(e){return _(V.apply([],Y.call(this,function(i,u){return e.call(i,u,i)})))},p.clone=function(){return this.map(function(e,i){return i.cloneNode(!0)})},p.offsetParent=function(){return this.map(function(e,i){var u=i.offsetParent;while(u&&ct(u,"position")==="static")u=u.offsetParent;return u||c})},p.slice=function(e,i){return _(z.call(this,e,i))};var Rn=/-([a-z])/g;function Jt(e){return e.replace(Rn,function(i,u){return u.toUpperCase()})}p.ready=function(e){var i=function(){return setTimeout(e,0,_)};if(r.readyState!=="loading")i();else r.addEventListener("DOMContentLoaded",i);return this},p.unwrap=function(){return this.parent().each(function(e,i){if(i.tagName==="BODY")return;var u=_(i);u.replaceWith(u.children())}),this},p.offset=function(){var e=this[0];if(!e)return;var i=e.getBoundingClientRect();return{top:i.top+s.pageYOffset,left:i.left+s.pageXOffset}},p.position=function(){var e=this[0];if(!e)return;var i=ct(e,"position")==="fixed",u=i?e.getBoundingClientRect():this.offset();if(!i){var h=e.ownerDocument,k=e.offsetParent||h.documentElement;while((k===h.body||k===h.documentElement)&&ct(k,"position")==="static")k=k.parentNode;if(k!==e&&C(k)){var E=_(k).offset();u.top-=E.top+it(k,"borderTopWidth"),u.left-=E.left+it(k,"borderLeftWidth")}}return{top:u.top-it(e,"marginTop"),left:u.left-it(e,"marginLeft")}};var Ne={class:"className",contenteditable:"contentEditable",for:"htmlFor",readonly:"readOnly",maxlength:"maxLength",tabindex:"tabIndex",colspan:"colSpan",rowspan:"rowSpan",usemap:"useMap"};p.prop=function(e,i){if(!e)return;if(x(e)){if(e=Ne[e]||e,arguments.length<2)return this[0]&&this[0][e];return this.each(function(h,k){k[e]=i})}for(var u in e)this.prop(u,e[u]);return this},p.removeProp=function(e){return this.each(function(i,u){delete u[Ne[e]||e]})};var Nn=/^--/;function te(e){return Nn.test(e)}var ee={},Sn=l.style,jn=["webkit","moz","ms"];function Vn(e,i){if(i===void 0)i=te(e);if(i)return e;if(!ee[e]){var u=Jt(e),h="".concat(u[0].toUpperCase()).concat(u.slice(1)),k="".concat(u," ").concat(jn.join("".concat(h," "))).concat(h).split(" ");O(k,function(E,L){if(L in Sn)return ee[e]=L,!1})}return ee[e]}var Ln={animationIterationCount:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0};function Se(e,i,u){if(u===void 0)u=te(e);return!u&&!Ln[e]&&X(i)?"".concat(i,"px"):i}function Dn(e,i){if(x(e)){var u=te(e);if(e=Vn(e,u),arguments.length<2)return this[0]&&ct(this[0],e,u);if(!e)return this;return i=Se(e,i,u),this.each(function(k,E){if(!C(E))return;if(u)E.style.setProperty(e,i);else E.style[e]=i})}for(var h in e)this.css(h,e[h]);return this}p.css=Dn;function je(e,i){try{return e(i)}catch(u){return i}}var On=/^\s+|\s+$/;function Ve(e,i){var u=e.dataset[i]||e.dataset[Jt(i)];if(On.test(u))return u;return je(JSON.parse,u)}function In(e,i,u){u=je(JSON.stringify,u),e.dataset[Jt(i)]=u}function wn(e,i){if(!e){if(!this[0])return;var u={};for(var h in this[0].dataset)u[h]=Ve(this[0],h);return u}if(x(e)){if(arguments.length<2)return this[0]&&Ve(this[0],e);if(y(i))return this;return this.each(function(k,E){In(E,e,i)})}for(var h in e)this.data(h,e[h]);return this}p.data=wn;function Le(e,i){var u=e.documentElement;return Math.max(e.body["scroll".concat(i)],u["scroll".concat(i)],e.body["offset".concat(i)],u["offset".concat(i)],u["client".concat(i)])}O([!0,!1],function(e,i){O(["Width","Height"],function(u,h){var k="".concat(i?"outer":"inner").concat(h);p[k]=function(E){if(!this[0])return;if(G(this[0]))return i?this[0]["inner".concat(h)]:this[0].document.documentElement["client".concat(h)];if(R(this[0]))return Le(this[0],h);return this[0]["".concat(i?"offset":"client").concat(h)]+(E&&i?it(this[0],"margin".concat(u?"Top":"Left"))+it(this[0],"margin".concat(u?"Bottom":"Right")):0)}})}),O(["Width","Height"],function(e,i){var u=i.toLowerCase();p[u]=function(h){if(!this[0])return y(h)?void 0:this;if(!arguments.length){if(G(this[0]))return this[0].document.documentElement["client".concat(i)];if(R(this[0]))return Le(this[0],i);return this[0].getBoundingClientRect()[u]-pt(this[0],!e)}var k=parseInt(h,10);return this.each(function(E,L){if(!C(L))return;var K=ct(L,"boxSizing");L.style[u]=Se(u,k+(K==="border-box"?pt(L,!e):0))})}});var De="___cd";p.toggle=function(e){return this.each(function(i,u){if(!C(u))return;var h=Ot(u),k=y(e)?h:e;if(k){if(u.style.display=u[De]||"",Ot(u))u.style.display=Dt(u.tagName)}else if(!h)u[De]=ct(u,"display"),u.style.display="none"})},p.hide=function(){return this.toggle(!1)},p.show=function(){return this.toggle(!0)};var Oe="___ce",ne=".",re={focus:"focusin",blur:"focusout"},Ie={mouseenter:"mouseover",mouseleave:"mouseout"},Fn=/^(mouse|pointer|contextmenu|drag|drop|click|dblclick)/i;function oe(e){return Ie[e]||re[e]||e}function ie(e){var i=e.split(ne);return[i[0],i.slice(1).sort()]}p.trigger=function(e,i){if(x(e)){var u=ie(e),h=u[0],k=u[1],E=oe(h);if(!E)return this;var L=Fn.test(E)?"MouseEvents":"HTMLEvents";e=r.createEvent(L),e.initEvent(E,!0,!0),e.namespace=k.join(ne),e.___ot=h}e.___td=i;var K=e.___ot in re;return this.each(function(dt,nt){if(K&&S(nt[e.___ot]))nt["___i".concat(e.type)]=!0,nt[e.___ot](),nt["___i".concat(e.type)]=!1;nt.dispatchEvent(e)})};function we(e){return e[Oe]=e[Oe]||{}}function Mn(e,i,u,h,k){var E=we(e);E[i]=E[i]||[],E[i].push([u,h,k]),e.addEventListener(i,k)}function Fe(e,i){return!i||!B.call(i,function(u){return e.indexOf(u)<0})}function Gt(e,i,u,h,k){var E=we(e);if(!i)for(i in E)Gt(e,i,u,h,k);else if(E[i])E[i]=E[i].filter(function(L){var K=L[0],dt=L[1],nt=L[2];if(k&&nt.guid!==k.guid||!Fe(K,u)||h&&h!==dt)return!0;e.removeEventListener(i,nt)})}p.off=function(e,i,u){var h=this;if(y(e))this.each(function(E,L){if(!C(L)&&!R(L)&&!G(L))return;Gt(L)});else if(!x(e))for(var k in e)this.off(k,e[k]);else{if(S(i))u=i,i="";O(W(e),function(E,L){var K=ie(L),dt=K[0],nt=K[1],ut=oe(dt);h.each(function(Ct,ft){if(!C(ft)&&!R(ft)&&!G(ft))return;Gt(ft,ut,nt,i,u)})})}return this},p.remove=function(e){return kt(this,e).detach().off(),this},p.replaceWith=function(e){return this.before(e).remove()},p.replaceAll=function(e){return _(e).replaceWith(this),this};function Gn(e,i,u,h,k){var E=this;if(!x(e)){for(var L in e)this.on(L,i,u,e[L],k);return this}if(!x(i))if(y(i)||j(i))i="";else if(y(u))u=i,i="";else h=u,u=i,i="";if(!S(h))h=u,u=void 0;if(!h)return this;return O(W(e),function(K,dt){var nt=ie(dt),ut=nt[0],Ct=nt[1],ft=oe(ut),Kt=ut in Ie,se=ut in re;if(!ft)return;E.each(function(ue,at){if(!C(at)&&!R(at)&&!G(at))return;var ae=function(ot){if(ot.target["___i".concat(ot.type)])return ot.stopImmediatePropagation();if(ot.namespace&&!Fe(Ct,ot.namespace.split(ne)))return;if(!i&&(se&&(ot.target!==at||ot.___ot===ft)||Kt&&ot.relatedTarget&&at.contains(ot.relatedTarget)))return;var ce=at;if(i){var Rt=ot.target;while(!Te(Rt,i)){if(Rt===at)return;if(Rt=Rt.parentNode,!Rt)return}ce=Rt}Object.defineProperty(ot,"currentTarget",{configurable:!0,get:function(){return ce}}),Object.defineProperty(ot,"delegateTarget",{configurable:!0,get:function(){return at}}),Object.defineProperty(ot,"data",{configurable:!0,get:function(){return u}});var qn=h.call(ce,ot,ot.___td);if(k)Gt(at,ft,Ct,i,ae);if(qn===!1)ot.preventDefault(),ot.stopPropagation()};ae.guid=h.guid=h.guid||_.guid++,Mn(at,ft,Ct,i,ae)})}),this}p.on=Gn;function Kn(e,i,u,h){return this.on(e,i,u,h,!0)}p.one=Kn;var Un=/\r?\n/g;function Bn(e,i){return"&".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(i.replace(Un,"\r\n")))}var Yn=/file|reset|submit|button|image/i,Me=/radio|checkbox/i;if(p.serialize=function(){var e="";return this.each(function(i,u){O(u.elements||[u],function(h,k){if(k.disabled||!k.name||k.tagName==="FIELDSET"||Yn.test(k.type)||Me.test(k.type)&&!k.checked)return;var E=Re(k);if(!y(E)){var L=b(E)?E:[E];O(L,function(K,dt){e+=Bn(k.name,dt)})}})}),e.slice(1)},typeof t!=="undefined")n.exports=_;else s.cash=s.$=_})()}),yr=Ht(Wt(),1);class We{default=window.navigator.language;LANGUAGE_DICTIONARIES={};setLang(t){if(this.default!==t)return this.default=t,!0;return!1}setDictionary(t,n){this.LANGUAGE_DICTIONARIES[t]=n}translate(t,n){if(n&&this.default==n)return{text:t,lang:this.default};n=n||this.default;const[r,s]=n.split("-");if(this.LANGUAGE_DICTIONARIES[r]&&t in this.LANGUAGE_DICTIONARIES[r]){if(typeof this.LANGUAGE_DICTIONARIES[r][t]==="object"){const c=this.LANGUAGE_DICTIONARIES[r][t];t=c[s||"*"]||c["*"]}else if(typeof this.LANGUAGE_DICTIONARIES[r][t]==="string")t=this.LANGUAGE_DICTIONARIES[r][t]}return{text:t,lang:n}}propagate(t){const n=this;function r(){const s=yr.default(this),c=s.html(),a=s.attr("title"),l=s.attr("placeholder");let o;if(!/<\//.test(c)&&s.text()){const{text:d,lang:m}=n.translate(s.text());s.text(d),o=m}if(a){const{text:d,lang:m}=n.translate(a);s.attr("title",d),o=m}if(l){const{text:d,lang:m}=n.translate(l);s.attr("placeholder",d),o=m}o&&s.attr("lang",o)}return t.children().each(r),t}}class Qe{pendingComponents=new Set;isPending=!1;callbacks=new Map;register(t,n){this.callbacks.set(t,n)}unregister(t){this.callbacks.delete(t)}queue(t){if(!this.callbacks.has(t))return;if(this.pendingComponents.add(t),!this.isPending)this.isPending=!0,this.schedule()}schedule(){Promise.resolve().then(()=>this.process())}process(){const t=Array.from(this.pendingComponents);this.pendingComponents.clear(),this.isPending=!1,t.forEach((n)=>{try{const r=this.callbacks.get(n);if(r)r()}catch(r){console.error(`Error updating component ${n}:`,r)}})}clear(){this.pendingComponents.clear(),this.isPending=!1}dispose(){this.pendingComponents.clear(),this.callbacks.clear(),this.isPending=!1}}class Ze{subscriptions=new Map;tick=new Qe;register(t,n){this.subscriptions.set(t,n),this.tick.register(t,n)}unregister(t){this.subscriptions.delete(t),this.tick.unregister(t)}queueUpdate(t){this.tick.queue(t)}dispose(){this.subscriptions.clear(),this.tick.dispose()}prepareForPotentialUnload(){this.tick.clear(),this.subscriptions.forEach((t,n)=>{this.subscriptions.set(n,()=>{})})}proxyState(t,n){const r=this,s=new WeakMap,c=(l)=>{if(l instanceof Map)l.forEach((d,m)=>l.set(m,a(d)));else if(Array.isArray(l))l.forEach((d,m)=>l[m]=a(d));else if(typeof l==="object")Object.entries(l).forEach(([d,m])=>l[d]=a(m));let o=new Proxy(l,{get(d,m){if(m==="toJSON")return function(){const g=(V)=>{if(!V||typeof V!=="object")return V;if(s.has(V)){const N=s.get(V);if(N instanceof Map){const Y={};return N.forEach((tt,z)=>Y[typeof z==="object"?JSON.stringify(z):String(z)]=g(tt)),Y}if(Array.isArray(N))return N.map((Y)=>g(Y));const M={};return Object.entries(N).forEach(([Y,tt])=>M[Y]=g(tt)),M}if(typeof V.toJSON==="function"&&!s.has(V))return V.toJSON();return V};return g(o)};if(m==="reset")return function(){o=null};const b=d[m];if(l instanceof Map&&typeof b==="function")return function(...g){const V=m.toString();if(V==="set"&&g.length>=2)g[1]=a(g[1]);const N=b.apply(d,g);return["set","delete","clear"].includes(V)&&r.queueUpdate(t),N};if(Array.isArray(l)&&typeof b==="function")return function(...g){const V=m.toString();if(["push","unshift"].includes(V))g=g.map((M)=>a(M));else if(V==="splice"&&g.length>2)g=[g[0],g[1],...g.slice(2).map((M)=>a(M))];const N=b.apply(d,g);return["push","pop","shift","unshift","splice","sort","reverse","fill"].includes(V)&&r.queueUpdate(t),N};return b},set(d,m,b){if(d[m]===b)return!0;if(b instanceof Map&&d[m]instanceof Map){const g=d[m];return g.clear(),b.forEach((V,N)=>g.set(N,a(V))),r.queueUpdate(t),!0}return d[m]=a(b),r.queueUpdate(t),!0}});return s.set(o,l),o},a=(l)=>{if(!l)return l;return l instanceof Map||Array.isArray(l)||typeof l==="object"?c(l):l};return c(n)}}class Je{domObserver;observedComponents=new Map;TIMEOUT=1e4;constructor(){this.domObserver=new MutationObserver(()=>{this.observedComponents.forEach((t,n)=>{try{const r=n.node;if(!r){this.unwatch(n);return}if(t.type==="attach"&&document.contains(r[0]))this.unwatch(n),n.emit("component:attached",n),typeof n.onAttach=="function"&&n.onAttach.bind(n)();else if(t.type==="detach"&&!document.contains(r[0]))this.unwatch(n),n.emit("component:detached",n),typeof n.onDetach=="function"&&n.onDetach.bind(n)()}catch(r){console.log("DWS error --",r)}}),!this.observedComponents.size&&this.domObserver.disconnect()})}watch(t,n="attach"){const r=t.node;if(!r)return;if(n==="attach"&&document.contains(r[0])){t.emit("component:attached",t),typeof t.onAttach=="function"&&t.onAttach.bind(t)();return}if(n==="detach"&&!document.contains(r[0])){t.emit("component:detached",t),typeof t.onDetach=="function"&&t.onDetach.bind(t)();return}this.unwatch(t);const s=setTimeout(()=>{this.unwatch(t),t.emit(`component:${n}ment-timeout`,t)},this.TIMEOUT);this.observedComponents.set(t,{timeout:s,type:n}),this.observedComponents.size===1&&this.domObserver.observe(document.body,{childList:!0,subtree:!0}),n==="attach"&&t.once("component:attached",()=>this.watch(t,"detach"))}unwatch(t){const n=this.observedComponents.get(t);if(n)clearTimeout(n.timeout),this.observedComponents.delete(t);!this.observedComponents.size&&this.domObserver.disconnect()}dispose(){this.domObserver.disconnect(),this.observedComponents.forEach((t)=>clearTimeout(t.timeout)),this.observedComponents.clear()}}class tn{pending=new Set;isPending=!1;component;metrics={batchCount:0,updatesProcessed:0,lastBatchSize:0,avgBatchSize:"0.00"};constructor(t){this.component=t}queue(t){if(this.pending.add(t),this.component.benchmark.inc("dependencyUpdateCount"),!this.isPending)this.isPending=!0,this.scheduleProcessing()}scheduleProcessing(){Promise.resolve().then(()=>this.processQueue())}processQueue(){const t=Array.from(this.pending);if(this.metrics.batchCount++,this.metrics.lastBatchSize=t.length,this.metrics.updatesProcessed+=t.length,this.metrics.avgBatchSize=(this.metrics.updatesProcessed/this.metrics.batchCount).toFixed(2),this.pending.clear(),this.component.benchmark.trackBatch(t.length),this.applyUpdates(t),this.isPending=!1,this.pending.size>0)this.isPending=!0,this.scheduleProcessing()}applyUpdates(t){t.forEach(({dep:n,dependent:r})=>{try{const s=r.update(r.memo,"batch-updator");if(s)typeof s.memo==="object"&&this.component.FGUD.get(n)?.set(r.path,{...r,memo:s.memo}),typeof s.cleanup==="function"&&s.cleanup()}catch(s){console.error("Failed to update dependency --",s)}})}getMetrics(){return{batchCount:this.metrics.batchCount,lastBatchSize:this.metrics.lastBatchSize,avgBatchSize:this.metrics.avgBatchSize,totalUpdates:this.metrics.updatesProcessed}}}class en{options={emit:!0};__events={};__once_events={};constructor(t){if(t)this.options=t}on(t,n){if(!Array.isArray(this.__events[t]))this.__events[t]=[];return this.__events[t].push(n),this}once(t,n){if(!Array.isArray(this.__once_events[t]))this.__once_events[t]=[];return this.__once_events[t].push(n),this}off(t){return delete this.__events[t],delete this.__once_events[t],this}emit(t,...n){if(!this.options.emit)return;const r=n.map((s)=>typeof s.toJSON==="function"?s.toJSON():s);this.__events[t]?.forEach((s)=>s(...r)),this.__once_events[t]?.forEach((s)=>s(...r)),delete this.__once_events[t]}}var Q=Ht(Wt(),1),Ke=Ht(Wt(),1),Ue=function(t){for(let n of t)if(typeof n==="object"&&n!==null)return!1;return!0},Be=function(t){for(let[n,r]of t)if(typeof n==="object"&&n!==null||typeof r==="object"&&r!==null)return!1;return!0};Ke.default.fn.extend({attrs:function(){const t={},n=this[0];return n&&n.nodeType!==Node.TEXT_NODE&&Ke.default.each(n.attributes,function(){t[this.name]=this.value}),t}});var gt="syn:",yt="fn:",It="on-",Z=/^\.\.\./,ve=/^\[(.*?)\]$/,kr=["@html","@text"];class nn{debug;initialStats={renderCount:0,elementCount:0,renderTime:0,avgRenderTime:0,maxRenderTime:0,componentCount:0,componentUpdateCount:0,partialCount:0,partialUpdateCount:0,memoryUsage:void 0,domOperations:0,domInsertsCount:0,domUpdatesCount:0,domRemovalsCount:0,dependencyTrackCount:0,dependencyUpdateCount:0,batchSize:0,batchCount:0,errorCount:0};stats=this.reset();renderStartTime=0;renderTimes=[];measurementCount=0;maxMeasurements=100;loggingInterval=10;autoSaveInterval;constructor(t=!1){if(this.debug=t,this.debug)this.autoSaveInterval=window.setInterval(()=>this.storeMetrics(),5000)}storeMetrics(){try{const t=JSON.parse(localStorage.getItem("lipsPerformanceMetrics")||"[]");t.push({timestamp:Date.now(),metrics:{...this.stats}}),t.length>100&&t.shift(),localStorage.setItem("lipsPerformanceMetrics",JSON.stringify(t))}catch(t){}}startRender(){if(!this.debug)return;this.renderStartTime=performance.now()}endRender(){if(!this.debug||this.renderStartTime===0)return;const t=performance.now()-this.renderStartTime;this.stats.renderTime=t,this.stats.maxRenderTime=Math.max(this.stats.maxRenderTime,t),this.renderTimes.push(t),this.renderTimes.length>this.maxMeasurements&&this.renderTimes.shift(),this.stats.avgRenderTime=this.renderTimes.reduce((n,r)=>n+r,0)/this.renderTimes.length,this.renderStartTime=0,this.measurementCount++}inc(t){if(!this.debug)return;if(typeof this.stats[t]==="number")this.stats[t]++}dec(t){if(!this.debug)return;if(typeof this.stats[t]==="number"&&this.stats[t]>0)this.stats[t]--}record(t,n){if(!this.debug)return;if(typeof this.stats[t]!=="undefined")this.stats[t]=n}add(t,n){if(!this.debug)return;if(typeof this.stats[t]==="number")this.stats[t]+=n}reset(){return this.renderTimes=[],this.measurementCount=0,this.stats=et(this.initialStats)}log(){if(!this.debug)return;if(this.loggingInterval>1&&this.measurementCount%this.loggingInterval!==0)return;const t={"Render Count":this.stats.renderCount,"Element Count":this.stats.elementCount,"Avg Render Time (ms)":this.stats.avgRenderTime.toFixed(2),"Max Render Time (ms)":this.stats.maxRenderTime.toFixed(2)},n={"Component Count":this.stats.componentCount,"Component Updates":this.stats.componentUpdateCount},r={"Partial Count":this.stats.partialCount,"Partial Updates":this.stats.partialUpdateCount},s={"DOM Operations":this.stats.domOperations,"DOM Inserts":this.stats.domInsertsCount,"DOM Updates":this.stats.domUpdatesCount,"DOM Removals":this.stats.domRemovalsCount},c={"Dependencies Tracked":this.stats.dependencyTrackCount,"Dependency Updates":this.stats.dependencyUpdateCount},a={"Batch Count":this.stats.batchCount,"Avg Batch Size":this.stats.batchCount>0?(this.stats.batchSize/this.stats.batchCount).toFixed(2):"0"};console.group("Lips Framework Performance Metrics"),console.table(t),console.table(n),console.table(r),console.table(s),console.table(c),console.table(a),this.stats.memoryUsage&&console.log(`Memory Usage: ${this.stats.memoryUsage.toFixed(2)} MB`),this.stats.errorCount>0&&console.warn(`Errors encountered: ${this.stats.errorCount}`),console.groupEnd(),window.localStorage&&this.measurementCount%10===0&&this.storeMetrics()}trackMemory(){if(!this.debug||!window.performance?.memory)return;this.stats.memoryUsage=window.performance.memory.usedJSHeapSize/1048576}trackBatch(t){if(!this.debug)return;this.stats.batchCount++,this.stats.batchSize+=t}trackError(t){if(!this.debug)return;this.stats.errorCount++,console.error("Lips Framework Error:",t)}setLoggingInterval(t){if(!this.debug)return;this.loggingInterval=t}getSnapshot(){return et(this.stats)}dispose(){if(!this.debug)return;this.autoSaveInterval&&clearInterval(this.autoSaveInterval)}}var xr=Ht(Wt(),1),rn="comm",on="rule",sn="decl",gr="@import",Er="@namespace",Cr="@keyframes",Tr="@layer",cn=Math.abs,xe=String.fromCharCode,Zt=1,jt=1,ln=0,lt=0,J=0,Vt="";class pn{nsp;settings;$head;constructor(t,n){if(typeof t!=="string")throw new Error("Undefined or invalid styles attachement element(s) namespace");this.nsp=t,this.$head=xr.default("head"),this.settings=n||{},this.settings&&this.load(this.settings)}compile(t){try{return ke(Or(t),Fr([wr]))}catch(n){throw new Error(`Style compilation failed: ${n.message}`)}}waitForStyles(t){return new Promise((n)=>{const r=new MutationObserver(()=>{const s=document.querySelector(t);if(s&&getComputedStyle(s).cssText)r.disconnect(),n()});r.observe(document.documentElement,{attributes:!0,childList:!0,subtree:!0})})}async inject(t){if(!t)throw new Error("Invalid injection arguments");const n=`rel="${this.settings.meta?"@":""}${this.nsp}"`;t=this.settings.meta?t:`[rel="${this.nsp}"] { ${t} }`;try{const r=this.compile(t);if(!r)throw new Error(`<component:${this.nsp}> sheet compilation failed`);const s=document.createElement("style");s.setAttribute("rel",`${this.settings.meta?"@":""}${this.nsp}`),s.textContent=r;let c=0;const a=this.$head.find(`style[${n}]`);if(a.length)c=parseInt(a.attr("dindex"))+1,a.remove();return s.setAttribute("dindex",String(c)),this.settings.meta?document.head.prepend(s):document.head.appendChild(s),s}catch(r){throw new Error(`Style injection failed: ${r.message}`)}}async load(t){if(this.settings=t,typeof this.settings!=="object")throw new Error("Undefined styles settings");if(this.settings.sheet){const n=await this.inject(this.settings.sheet);await this.waitForStyles(`style[rel="${this.settings.meta?"@":""}${this.nsp}"]`)}}get(){}async clear(){const t=this.$head.find(`style[rel="${this.settings.meta?"@":""}${this.nsp}"]`);if(!t.length)return;const n=parseInt(t.attr("dindex"));n===0?t.remove():t.attr("dindex",String(n-1))}async custom(){return{}}async style(){return{}}}var Mr=function(t){const n=/on-([a-zA-Z-]+)\s*\(/g;let r=t,s;while((s=n.exec(t))!==null){const c=s[1],a=s.index+s[0].length;let l=1,o=a;while(o<t.length&&l>0){if(t[o]==="(")l++;if(t[o]===")")l--;o++}if(l===0){const d=t.slice(a,o-1).trim(),m=t.slice(0,s.index),b=`${It}${c}="${d}"`,g=t.slice(o);r=m+b+g,t=r,n.lastIndex=m.length+b.length}}return r},Gr=function(t){const n=[];let r=t.replace(/<([a-zA-Z][a-zA-Z0-9_-]*)((?:[^>'"]*|'[^']*'|"[^"]*")*?)(?:\/?>)/g,(s,c,a)=>{return n.push(a),`<${c}##TAG_ATTRS_${n.length-1}##>`});for(let s=0;s<n.length;s++){const c=`##TAG_ATTRS_${s}##`,a=n[s],l=Kr(a);r=r.replace(c,l)}return r},Kr=function(t){let n="",r=0,s=!1,c="",a=0,l=0,o=0;while(r<t.length){const d=t[r];if((d==='"'||d==="'")&&(r===0||t[r-1]!=="\\")){if(!s)s=!0,c=d;else if(d===c)s=!1}if(!s){if(d==="(")l++;else if(d===")")l--;else if(d==="{")o++;else if(d==="}")o--}if(!s&&l===0&&o===0&&(d===" "||r===t.length-1)){let m=r;if(r===t.length-1)m=r+1;const b=t.substring(a,m).trim();if(b){const g=Ur(b);n+=" "+g}a=r+1}r++}return n},Ur=function(t){const n=t.indexOf("=");if(n===-1){if(t.startsWith("...")||t.startsWith("["))return t;return`:${t}="${!t.startsWith("!")}"`}let r=t.substring(0,n).trim(),s=t.substring(n+1).trim();if(r.startsWith("@"))return r=!kr.includes(r)?r.slice(1):r,`:${r}=${s}`;if(r.startsWith(yt)||r.startsWith(It))return t;if(s.startsWith('"')&&s.endsWith('"')||s.startsWith("'")&&s.endsWith("'")){const c=s.substring(1,s.length-1);if(Br(c))return`:${r}="${c}"`;return t}else return`:${r}="${s}"`},Yr=function(t,n){if(t.isDisposed)return;n.add(t),t.dependencies.add(n)},Xe=function(t){for(let n of t.dependencies)n.delete(t);t.dependencies.clear()},Xt=[],He=null;class Ee extends en{declaration;$=null;input;state;static;context;__name__;__path__;__template__;__previous;__stylesheet;__macros=new Map;__renderCache=new Map;FGUD=new Map;PCC=new Map;VER=[];prepath="0";debug=!1;isRendered=!1;__setInput;__setState;__getState;UQS;ICE;lips;benchmark;__path="";__pathCounter=0;__renderDepth=0;constructor(t,n,{input:r,state:s,context:c,_static:a,handler:l,stylesheet:o,macros:d,declaration:m},b){super();if(this.lips=b.lips,b?.debug)this.debug=b.debug;if(b?.prepath)this.prepath=b.prepath;if(this.__name__=t,this.__path__=`${this.prepath}/${this.__name__}`,this.__template__=ze(n),this.declaration=m||{name:t},this.input=r||{},this.static=a||{},this.context={},this.state=this.lips.IUC.proxyState(this.__path__,s||{}),d&&this.setMacros(d),l&&this.setHandler(l),o&&this.setStylesheet(o),this.benchmark=new nn(this.debug),this.benchmark.inc("componentCount"),this.UQS=new tn(this),typeof this.onCreate=="function"&&this.onCreate.bind(this)(),this.emit("component:create",this),this.input&&Object.keys(this.input).length&&typeof this.onInput=="function")this.onInput.bind(this)(this.input),this.emit("component:input",this);this.__previous={input:et(this.input),state:et(this.state),context:et(this.context)};const[g,V]=zt(this.input),[N,M]=zt(this.state),[Y,tt]=zt(this.context);this.__setInput=V,this.__setState=M,this.__getState=N,this.lips.IUC.register(this.__path__,()=>{st(this.__previous?.state,this.state)&&this.__setState({...this.__getState(),...this.state})}),Array.isArray(c)&&c.length&&this.lips.useContext(c,(z)=>{if(!st(this.context,z))return;tt(z),this.context=z,typeof this.onContext=="function"&&this.onContext.bind(this)(),this.emit("component:context",this)}),this.ICE=dn(()=>{const z=g(),B=N(),U=this.context=Y();if(!this.isRendered){this.benchmark.reset();const{$log:w}=this.render("",void 0,void 0,this.FGUD);this.$=w,!m?.syntax&&this.$?.each((F,T)=>typeof T.setAttribute=="function"&&T.setAttribute("rel",this.__name__)),this.isRendered=!0,typeof this.onMount=="function"&&this.onMount.bind(this)(),this.emit("component:mount",this),this.lips.watcher.watch(this)}else this.__updateDepNodes__({state:B,input:z,context:U},this.__previous),typeof this.onUpdate=="function"&&this.onUpdate.bind(this)(),this.emit("component:update",this),this.__previous={input:et(z),state:et(B),context:et(U)},this.input=z;this.benchmark.log(),typeof this.onRender=="function"&&this.onRender.bind(this)(),this.emit("component:render",this)})}setContext(t,n){this.lips.setContext(t,n)}setInput(t){if(!st(this.input,t))return;this.__setInput(t),typeof this.onInput=="function"&&this.onInput.bind(this)(t)}subInput(t){if(typeof t!=="object")throw new Error("Invalid sub input data argument");return this.setInput(Ar(this.input,t)),this}setMacros(t){const n=ze(t),r=Q.default(n);if(!r.length)return;const s=this;r.each(function(){const c=Q.default(this),{argv:a,attrs:l}=s.__getAttributes__(c);if(!Object.keys(l))throw new Error("Invalid macro component definition");if(!l.literals.name)throw new Error("Undefined macro `name` attribute.");if(s.__macros.get(l.literals.name))console.warn(`Duplicate macro <${l.literals.name}> will be override`);if(!c.contents()?.length)throw new Error("Invalid macro component definition. Template content expected.");s.__macros.set(l.literals.name,{argv:a,$node:c})})}setHandler(t){Object.entries(t).map(([n,r])=>this[n]=r.bind(this))}setStylesheet(t){const n={sheet:t,meta:this.__name__==="__ROOT__"};this.__stylesheet=new pn(this.__name__,n)}get node(){if(!this.$)throw new Error("node() is expected to be call after component get rendered");return this.$}find(t){return this.$?.find(t)}render(t,n,r={},s,c){const a=s||new Map,l=[];if(n&&!n.length)return console.warn("Undefined node element to render"),{$log:n,dependencies:a};this.benchmark.startRender();const o=this;let d=Q.default();function m(f){const A=b(f);return o.__pathCounter++,o.__path?`${o.__path}/${A}`:`${t?t+"/":"#"}${A}`}function b(f){return(f==="component"?"c":"")+o.__pathCounter}function g(f){return f!==null&&typeof f==="object"&&typeof f.mesh==="function"&&typeof f.update==="function"}function V(f){return f!==null&&typeof f==="object"&&typeof f.default&&typeof f.default==="string"}function N(f){if(!f.attr(":dtag")||f.prop("tagName")!=="LIPS")throw new Error("Invalid dynamic tag name");const A=f.attr(":dtag"),v=o.__evaluate__(A,r);if(g(v)||v===null)return z(f,A,v);else if(V(v))return B(f,{template:v});else return B(f,{name:v})}function M(f){const A=f.attr(":args"),v=m("log");if(!A)return;if(o.__evaluate__(`console.log(${A})`,r),o.__isReactive__(A,r))o.__extractExpressionDeps__(A,r).forEach((p)=>o.__trackDep__(a,p,{$fragment:null,path:v,update:(_)=>o.__evaluate__(`console.log(${A})`,_),memo:r,batch:!0}))}function Y(f){const A=m("var"),{attrs:v}=o.__getAttributes__(f);if(!v)return;Object.entries(v.literals).forEach(([p,_])=>{if(r[p]&&r[p].type==="const")throw new Error(`Cannot override <const ${p}=[value]/> variable`);r[p]={value:_,type:"let"}}),Object.entries(v.expressions).forEach(([p,_])=>{if(Z.test(p)){const P=(G,R)=>{const D=o.__evaluate__(p.replace(Z,""),R||r);if(typeof D!=="object")throw new Error(`Invalid spread operator ${p}`);for(let C in D){if(r[C]&&r[C].type==="const")throw new Error(`Cannot override <const ${C}=[value]/> variable`);if(r[C]={value:D[C],type:"let"},R)R[C]=r[C],o.__updateVarDepNodes__(C,A,R)}if(G)return{memo:R}};o.__extractExpressionDeps__(p,r).forEach((G)=>o.__trackDep__(a,G,{$fragment:null,path:`${A}.${p}`,update:(R)=>P(!0,R),memo:r,batch:!0})),P()}else if(_){if(o.__isReactive__(_,r)){const P=o.__extractExpressionDeps__(_,r),G=(R,D)=>{if(r[p]&&r[p].type==="const")throw new Error(`Cannot override <const ${p}=[value]/> variable`);return R[p]=r[p]={value:o.__evaluate__(_,R),type:"let"},o.__updateVarDepNodes__(p,A,R),{memo:R}};P.forEach((R)=>o.__trackDep__(a,R,{$fragment:null,path:`${A}.${p}`,update:G,memo:r,batch:!0}))}if(r[p]&&r[p].type==="const")throw new Error(`Cannot override <const ${p}=[value]/> variable`);r[p]={value:o.__evaluate__(_,r),type:"let"}}}),o.benchmark.inc("elementCount")}function tt(f){const{attrs:A}=o.__getAttributes__(f);if(!A)return;Object.entries(A.literals).forEach(([v,p])=>{if(r[v]&&r[v].type==="const")throw new Error(`<const ${v}=[value]/> variable already defined`);if(!p)return;r[v]={value:p,type:"const"}}),Object.entries(A.expressions).forEach(([v,p])=>{if(Z.test(v)){const _=o.__evaluate__(v.replace(Z,""),r);if(typeof _!=="object")throw new Error(`Invalid spread operator ${v}`);for(let P in _){if(r[P]&&r[P].type==="const")throw new Error(`<const ${P}=[value]/> by spread operator ${v}. [${P}] variable already defined`);r[P]={value:_[P],type:"const"}}}else{if(r[v]&&r[v].type==="const")throw new Error(`<const ${v}=[value]/> variable already defined`);if(!p)return;r[v]={value:o.__evaluate__(p,r),type:"const"}}}),o.benchmark.inc("elementCount")}function z(f,A,v){const{attrs:p}=o.__getAttributes__(f),_=m("element"),P=o.__getBoundaries__(_);let G=Q.default(P.start),R={},D=v;if(D){p.literals&&Object.entries(p.literals).forEach(([$,I])=>R[$]={type:"arg",value:I}),p.expressions&&Object.entries(p.expressions).forEach(([$,I])=>{if(!D)return;if(Z.test($)){const S=o.__evaluate__($.replace(Z,""),r);if(typeof S!=="object")throw new Error(`Invalid spread operator ${$}`);for(let x in S){if(x!=="#"&&!D.argv.includes(x))continue;R[x]={type:"arg",value:S[x]}}}else{if($!=="#"&&!D.argv.includes($))return;R[$]={type:"arg",value:I?o.__evaluate__(I,r):!0}}});const C=D.mesh(R);if(C&&C.length)G=G.add(C);p.expressions&&Object.entries(p.expressions).forEach(([$,I])=>{if(!D)return;if(Z.test($)&&o.__isReactive__($,r)){const S=o.__extractExpressionDeps__($,r),x=(y,j)=>{if(!D)return;const X={},H=o.__evaluate__($.replace(Z,""),y);if(typeof H!=="object")throw new Error(`Invalid spread operator ${$}`);const O=[];for(let q in H){if(q!=="#"&&!D.argv.includes(q))continue;R[q]=X[q]={type:"arg",value:H[q]},(!y[q]||!$t(H[q],y[q].value))&&O.push(q)}O.length&&D.update(O,X,P)};S.forEach((y)=>o.__trackDep__(a,y,{$fragment:null,boundaries:P,path:`${_}.${$}`,update:x,memo:r,batch:!0}))}else if(($==="#"||D.argv.includes($))&&o.__isReactive__(I,r)){const S=o.__extractExpressionDeps__(I,r),x=(y,j)=>{if(!D)return;const X=R[$]={type:"arg",value:I?o.__evaluate__(I,y):!0};D.update([$],{[$]:X},P)};S.forEach((y)=>o.__trackDep__(a,y,{$fragment:null,boundaries:P,path:`${_}.${$}`,update:x,memo:r,batch:!0}))}})}if(o.__isReactive__(A,r)){const C=($,I)=>{const S=o.__evaluate__(A,$);let x;if(V(S))x=B(f,{template:S});else if(g(S))R="#"in R?{...$,...R["#"].value}:{...$,...R},D=S,x=D?D.mesh(R):null;if(!document.contains(P.start)||!document.contains(P.end))throw new Error("Dynamic element boundaries not found");const y=[];let j=P.start.nextSibling;while(j&&j!==P.end)y.push(j),j=j.nextSibling;Q.default(y).remove(),x&&Q.default(P.start).after(x)};o.__extractExpressionDeps__(A,r).forEach(($)=>o.__trackDep__(a,$,{$fragment:null,boundaries:P,path:_,update:C,batch:!0,memo:{...r,...R}}))}return G=G.add(P.end),G}function B(f,A){let v,p;if(A?.template)v=A.template,p=b("component");else{if(p=A?.name||f.prop("tagName")?.toLowerCase(),!p)throw new Error("Invalid component");if(p===o.__name__)throw new Error("Render component within itself is forbidden");v=o.lips.import(p)}if(!v||!p)throw new Error(`<${p}> template not found`);const _=m("component"),P=o.__getBoundaries__(_),{argv:G,attrs:R,events:D}=o.__getAttributes__(f),C={};let $={},I=Q.default(P.start),S=o.PCC.get(_);R.literals&&Object.entries(R.literals).forEach(([y,j])=>{if(y=="key")return;$[y]=j}),R.functions&&Object.entries(R.functions).forEach(([y,j])=>{$[y]=o.__evaluateFunction__(j,[],r),v.declaration?.syntax?C[gt+yt+y]=j:C[yt+y]=j}),R.expressions&&Object.entries(R.expressions).forEach(([y,j])=>{if(y=="key")return;if(Z.test(y)){const X=o.__evaluate__(y.replace(Z,""),r);if(typeof X!=="object")throw new Error(`Invalid spread operator ${y}`);for(let H in X)$[H]=X[H]}else $[y]=j?o.__evaluate__(j,r):!0;v.declaration?.syntax?C[gt+y]=j:C[y]=j});const x=f.contents();if(x.length){if($={...$,...o.__meshwire__({$node:f,fragmentPath:_,fragmentBoundaries:P,meshPath:null,argv:G,scope:r,xmlns:c,useAttributes:!0,declaration:v.declaration},C)},v.declaration){if(v.declaration.tags)Object.entries(v.declaration?.tags).forEach(([y,{type:j,many:X}])=>{switch(j){case"nexted":{let H=f.next(y);if(!H.length)return;if(X){$[y]=[];let O=0,q=!1;while(!q){if($[y].push(o.__meshwire__({$node:H,meshPath:`${y}[${O}]`,fragmentPath:_,fragmentBoundaries:P,argv:G,scope:r,xmlns:c,useAttributes:!0,declaration:v.declaration},C)),!H.next(y).length){q=!0;break}H=H.next(y),O++}}else $[y]=o.__meshwire__({$node:H,meshPath:y,fragmentPath:_,fragmentBoundaries:P,argv:G,scope:r,xmlns:c,useAttributes:!0,declaration:v.declaration},C)}break;case"child":{const H=f.children(y);if(X)$[y]=[],H.each(function(O){const q=Q.default(this),{argv:_t}=o.__getAttributes__(q);$[y].push(o.__meshwire__({$node:q,meshPath:`${y}[${O}]`,fragmentPath:_,fragmentBoundaries:P,argv:_t,scope:r,xmlns:c,useAttributes:!0,declaration:v.declaration},C))});else if(f.children(y).first().length){const O=f.children(y).first(),{argv:q}=o.__getAttributes__(O);$[y]=o.__meshwire__({$node:O,meshPath:y,fragmentPath:_,fragmentBoundaries:P,argv:q,scope:r,xmlns:c,useAttributes:!0,declaration:v.declaration},C)}}break}});else if(v.declaration.contents)$.__contents__=x}}if(S)S.setInput(et($)),I=I.add(S.node);else{const{declaration:y,state:j,_static:X,handler:H,context:O,default:q,stylesheet:_t}=v;S=new Ee(p,q||"",{state:et(j),input:et($),context:O,_static:et(X),handler:H,stylesheet:_t,declaration:y},{debug:o.debug,lips:o.lips,prepath:_}),I=I.add(S.node),o.PCC.set(_,S),Object.entries(D).forEach(([W,rt])=>!!S&&o.__attachEvent__(S,W,rt,r)),C&&Object.entries(C).forEach(([W,rt])=>{let Lt=!1,ct=!1;if(W.startsWith(gt))Lt=!0,W=W.replace(gt,"");if(W.startsWith(yt))ct=!0,W=W.replace(yt,"");if(Z.test(W)){const it=(pt)=>{const At={},Dt=o.__evaluate__(W.replace(Z,""),pt);if(typeof Dt!=="object")throw new Error(`Invalid spread operator ${W}`);for(let Ot in Dt)At[Ot]=Dt[Ot];S?.subInput(At)};if(o.__isReactive__(W,r))o.__extractExpressionDeps__(rt,r).forEach((pt)=>o.__trackDep__(a,pt,{$fragment:null,boundaries:P,path:`${_}.${W}`,update:it,syntax:Lt,memo:r,batch:!0}))}else{const it=(pt)=>{const At=ct?o.__evaluateFunction__(rt,[],pt):rt?o.__evaluate__(rt,pt):!0;S?.subInput({[W]:At})};if(o.__isReactive__(rt,r))o.__extractExpressionDeps__(rt,r).forEach((pt)=>o.__trackDep__(a,pt,{$fragment:null,boundaries:P,path:`${_}.${W}`,update:it,syntax:Lt,memo:r,batch:!0}))}}),I=I.add(P.end)}return o.benchmark.inc("componentCount"),I}function U(f){const A=f.prop("tagName")?.toLowerCase();if(!A)throw new Error("Invalid macro rendering call");const v=o.__macros.get(A);if(!v)throw new Error("Macro component not found");const p=m("macro"),_=o.__getBoundaries__(p),{attrs:P}=o.__getAttributes__(f),G={};let R={},D={},C=Q.default(_.start);if(P.literals&&Object.entries(P.literals).forEach(([x,y])=>R[x]={value:y,type:"arg"}),P.expressions&&Object.entries(P.expressions).forEach(([x,y])=>{if(Z.test(x)){const j=o.__evaluate__(x.replace(Z,""),r);if(typeof j!=="object")throw new Error(`Invalid spread operator ${x}`);for(let X in j)if(D[X]=j[X],v.argv.includes(X))R[X]={value:j[X],type:"arg"};G[x]=y}else{const j=y?o.__evaluate__(y,r):!0;if(D[x]=j,v.argv.includes(x))R[x]={value:j,type:"arg"};if(v.argv.includes(x))G[x]=y}v.argv.forEach((j)=>{if(R[j]!==void 0)return;R[j]={value:!1,type:"arg"}})}),v.argv.includes("__"))R.__={value:D,type:"arg"};const $={$node:v.$node,meshPath:null,fragmentPath:p,fragmentBoundaries:_,argv:v.argv,scope:r,xmlns:c,useAttributes:!0},I=o.__meshwire__($,G),S=I.renderer.mesh(R);return C=C.add(S),G&&Object.entries(G).forEach(([x,y])=>{let j=!1;if(new RegExp(`^${gt}`).test(x))j=!0,x=x.replace(gt,"");if(Z.test(x)){if(!o.__isReactive__(x,r))return;const X=o.__extractExpressionDeps__(x,r),H=(O)=>{const q={},_t=o.__evaluate__(x.replace(Z,""),O);if(typeof _t!=="object")throw new Error(`Invalid spread operator ${x}`);const W=[];for(let rt in _t)q[rt]={value:_t[rt],type:"arg"},(!O[rt]||!$t(_t[rt],O[rt].value))&&W.push(rt);return W.length&&I.renderer.update(W,q),{memo:{...O,...q}}};X.forEach((O)=>o.__trackDep__(a,O,{$fragment:null,boundaries:_,path:`${p}.${x}`,update:H,syntax:j,memo:{...r,...R},batch:!0}))}else if(o.__isReactive__(y,r)){const X=o.__extractExpressionDeps__(y,r),H=(O)=>{const q=O[x]={value:y?o.__evaluate__(y,O):!0,type:"arg"};return I.renderer.update([x],{[x]:q}),{memo:O}};X.forEach((O)=>o.__trackDep__(a,O,{$fragment:null,boundaries:_,path:`${p}.${x}`,update:H,syntax:j,memo:{...r,...R},batch:!0}))}}),C=C.add(_.end),o.benchmark.inc("elementCount"),C}function w(f){if(!f.length||!f.prop("tagName"))return f;const A=f.is("svg")||c,v=A?Q.default(document.createElementNS("http://www.w3.org/2000/svg",f.prop("tagName").toLowerCase())):Q.default(`<${f.prop("tagName").toLowerCase()}/>`),p=f.contents(),_=m("element");p.length&&v.append(o.__withPath__(_,()=>o.render(_+".n",p,r,a,A).$log));const{attrs:P,events:G}=o.__getAttributes__(f);P.literals&&Object.entries(P.literals).forEach(([D,C])=>v.attr(D,C));const R=(D,C=!1)=>{D&&Object.entries(D).forEach(([$,I])=>{switch($){case"@html":{const S=(x)=>{v.html(o.__evaluate__(I,x))};if(S(r),C&&o.__isReactive__(I,r))o.__extractExpressionDeps__(I,r).forEach((x)=>o.__trackDep__(a,x,{$fragment:v,path:`${_}.${$}`,update:S,memo:r,batch:!0}))}break;case"@text":{const S=(x)=>{let y=o.__evaluate__(I,x);if(!f.is("[no-translate]")){const{text:j}=o.lips.i18n.translate(y);y=j}v.text(y)};if(S(r),C&&o.__isReactive__(I,r))o.__extractExpressionDeps__(I,r).forEach((x)=>o.__trackDep__(a,x,{$fragment:v,path:`${_}.${$}`,update:S,memo:r,batch:!0}))}break;case"style":{const S=(x)=>{const y=o.__evaluate__(I,x);if(typeof y==="object"){let j="";Object.entries(y).forEach(([X,H])=>j+=`${X}:${H};`),j.length&&v.attr("style",j)}else v.attr("style",y)};if(S(r),C&&o.__isReactive__(I,r))o.__extractExpressionDeps__(I,r).forEach((x)=>o.__trackDep__(a,x,{$fragment:v,path:`${_}.${$}`,update:S,memo:r,batch:!0}))}break;default:{const S=(x)=>{const y=I?o.__evaluate__(I,x):I!==void 0?I:!0;y===void 0||y===!1?v.removeAttr($):v.attr($,y)};if(S(r),C&&o.__isReactive__(I,r))o.__extractExpressionDeps__(I,r).forEach((x)=>o.__trackDep__(a,x,{$fragment:v,path:`${_}.${$}`,update:S,memo:r,batch:!0}))}}})};return P.expressions&&Object.keys(P.expressions).forEach((D)=>{if(!Z.test(D))return;const C=($)=>{const I={},S=o.__evaluate__(D.replace(Z,""),$);if(typeof S!=="object")throw new Error(`Invalid spread operator ${D}`);for(let x in S)I[x]=S[x];R(I)};if(delete P.expressions[D],C(r),D&&o.__isReactive__(D,r))o.__extractExpressionDeps__(D,r).forEach(($)=>o.__trackDep__(a,$,{$fragment:v,path:`${_}.${D}`,update:C,memo:r,batch:!0}))}),R(P.expressions,!0),G&&Object.entries(G).forEach(([D,C])=>{l.push({_event:D,$fragment:v,instruction:C,scope:r})}),o.benchmark.inc("elementCount"),o.benchmark.inc("domInsertsCount"),v}function F(f){const A=m("element"),v=f.text(),p=Q.default(document.createTextNode(o.__interpolate__(v,r)));if(v&&o.__isReactive__(v,r)){const _=o.__extractTextDeps__(v,r),P=(G)=>{const R=o.__interpolate__(v,G);if(!p[0])return;p[0].textContent=R};_.forEach((G)=>o.__trackDep__(a,G,{path:A,$fragment:p,update:P,memo:r,batch:_.length>1}))}return o.benchmark.inc("elementCount"),o.benchmark.inc("domInsertsCount"),p}function T(f){if(f.get(0)?.nodeType===Node.COMMENT_NODE)return f;if(f.get(0)?.nodeType===Node.TEXT_NODE)return F(f);if(f.is("let"))return Y(f);else if(f.is("const"))return tt(f);else if(f.is("lips")&&f.attr(":dtag"))return N(f);else if(f.is("log"))return M(f);else if(o.__macros.has(f.prop("tagName")?.toLowerCase()))return U(f);else if(f.is("if, for, switch, async")||o.lips.has(f.prop("tagName")?.toLowerCase()))return B(f);else if(f.is("else-if, else"))return;return w(f)}try{this.__renderDepth++,n=n||Q.default(this.__template__),n.each(function(){const f=T(Q.default(this));if(f)d=d.add(f)}),l.forEach(({$fragment:f,_event:A,instruction:v,scope:p})=>{this.__attachEvent__(f,A,v,p)}),o.benchmark.inc("renderCount")}catch(f){console.error("Rendering Failed --",f),o.benchmark.trackError(f)}finally{if(this.__renderDepth--,this.benchmark.endRender(),this.benchmark.trackMemory(),this.__renderDepth===0)this.__path="",this.__pathCounter=0}return{$log:d,dependencies:a,events:l}}destroy(){this.ICE.dispose(),this.benchmark.dispose(),this.lips.IUC.unregister(this.__path__),this.lips.watcher.unwatch(this),this.VER.forEach(({element:t,_event:n})=>this.__detachEvent__(t,n)),this.VER=[];for(let t in this.PCC){const n=this.PCC.get(t);n?.destroy(),n?.delete(t)}if(this.$?.remove(),this.PCC?.clear(),this.FGUD?.clear(),this.state.reset(),this.__macros.clear(),this.__stylesheet?.clear(),this.__previous=null,this.state=null,this.input=null,this.context=null,this.$)this.$.each((t,n)=>{Q.default(n).off()}),this.$=null}__meshwire__(t,n){const r=this,{$node:s,meshPath:c,fragmentPath:a,fragmentBoundaries:l,argv:o,scope:d,xmlns:m,declaration:b,useAttributes:g}=t;let V,N=[];const M=[],Y=(U,w,F)=>{const T=`${a}.${c||"r"}${F!==void 0?`[${F}]`:""}`,{$log:f,dependencies:A,events:v}=r.render(T,U,{...d,...w},void 0,m);if(M.push(T),A?.forEach((p,_)=>{if(!r.FGUD?.has(_))r.FGUD.set(_,new Map);p.forEach((P,G)=>{P.partial?.length?P.partial.push(T):P.partial=[T],r.FGUD.get(_)?.set(G,P)})}),r.benchmark.inc("partialCount"),F!==void 0){const p=r.__getBoundaries__(T);N[F]={argvalues:w,boundaries:p};let _=Q.default(p.start);return _=_.add(f),_=_.add(p.end),_}return f},tt=(U,w,F)=>{if(r.benchmark.startRender(),U.forEach((T)=>{const f=r.FGUD.get(T);if(!f)return;f.forEach((A)=>{const v=M.find((p)=>A.partial?.find((_)=>p==_));if(!A.partial||!v)return;if(F!==void 0&&!v.endsWith(`r[${F}]`))return;if(l?.start&&!document.contains(l.start)){console.warn(`${c} -- partial boundaries missing in the DOM`),f.delete(A.path);return}if(A.memo?.[T]&&w?.[T]&&$t(A.memo[T],w[T]))return;if(A.memo={...d,...A.memo,...w},A.batch)r.UQS.queue({dep:T,dependent:A});else{const p=A.update(A.memo,"mesh-partial-updator");if(p)typeof p.memo==="object"&&f.set(A.path,{...A,memo:p.memo}),typeof p.cleanup==="function"&&p.cleanup()}r.benchmark.inc("dependencyUpdateCount")}),!f.size&&r.FGUD.delete(T)}),F!==void 0&&N[F])N[F].argvalues=w;r.benchmark.inc("partialUpdateCount"),r.benchmark.endRender()},z=(U)=>{if(!N[U])return;const w=N[U].boundaries;if(delete N[U],!document.contains(w.start)||!document.contains(w.end)){console.warn(`Partial mesh item<${U}> boundaries missing`);return}const F=[];let T=w.start.nextSibling;while(T&&T!==w.end)F.push(T),T=T.nextSibling;Q.default(F).remove(),w.start.remove(),w.end.remove()},B={renderer:{path:c,argv:o,mesh(U,w=!1){if(V=s.contents(),!V?.length)return null;if(b?.iterator){const F=U?.["#"].value;if(!Array.isArray(U?.["#"].value))throw new Error("Invalid iterator argvalues");if(!F.length)return null;let T=Q.default();return F.forEach((f,A)=>{if(!V?.length)return null;T=T.add(Y(V,f,A))}),T}else return Y(V,U)},update(U,w,F){if(!M.length)return;if(F=F||l,b?.iterator){const T=w?.["#"].value;if(!Array.isArray(T))return;if(Array.isArray(N)){if(N.length===T.length){for(let A=0;A<T.length;A++)!$t(N[A].argvalues,T[A])&&tt(Object.keys(T[A]),T[A],A);return}const f=Math.min(N.length,T.length);for(let A=0;A<f;A++)tt(Object.keys(T[A]),T[A],A);if(T.length>N.length){if(!V?.length)return;for(let A=N.length;A<T.length;A++){const v=Y(V,T[A],A);Q.default(F.end).before(v)}}else if(T.length<N.length)for(let A=T.length;A<N.length;A++)z(A)}}else tt(U,w)}}};if(g&&c){const{attrs:U}=r.__getAttributes__(s);U.literals&&Object.entries(U.literals).forEach(([w,F])=>B[w]=F),U.expressions&&Object.entries(U.expressions).forEach(([w,F])=>{if(Z.test(w)){const T=r.__evaluate__(w.replace(Z,""),d);if(typeof T!=="object")throw new Error(`Invalid spread operator ${w}`);for(let f in T)B[f]=T[f];n[`${b?.syntax?gt:""}${c}.${w}`]=F}else B[w]=F?r.__evaluate__(F,d):!0,n[`${b?.syntax?gt:""}${c}.${w}`]=F})}return B}__getBoundaries__(t){return this.benchmark.inc("domOperations"),this.benchmark.inc("domInsertsCount"),{start:document.createComment(`s:${this.prepath}.${t}`),end:document.createComment(`e:${this.prepath}.${t}`)}}__getAttributes__(t){const n=t.attrs(),r={},s={literals:{},functions:{},expressions:{}};let c=[];return n&&Object.entries(n).forEach(([a,l])=>{if(a==":dtag")return;if(a.startsWith(":")||a.startsWith(yt)||a.startsWith(It)||Z.test(a)||ve.test(a))if(ve.test(a)){const[o,d]=a.match(ve)||[];c=d.split(",")}else if(a.startsWith(It))r[a.replace(It,"")]=l;else if(a.startsWith(yt))s.functions[a.replace(yt,"")]=l;else{if(a.startsWith(":"))a=a.slice(1,a.length);s.expressions[a]=l||""}else s.literals[a]=l}),{argv:c,events:r,attrs:s}}__withPath__(t,n){const r=this.__path;this.__path=t;const s=n();return this.__path=r,s}__getPathParent__(t){const n=t.split("/");return n.pop(),n.join("/")}__hasSamePathParent__(t,n){return t.startsWith(n)}__evaluate__(t,n){try{t=t.trim();const r=this.state.toJSON();if(n){const s={};for(let a in n)s[a]=n[a].value;const c=`with( scope ){ return ${t}; }`;return new Function("self","input","state","static","context","scope",c)(this,this.input,r,this.static,this.context,s||{})}else{const s=`return ${t}`;return new Function("self","input","state","static","context",s)(this,this.input,r,this.static,this.context)}}catch(r){return t}}__evaluateFunction__(t,n,r){if(/(\s*\w+|\s*\([^)]*\)|\s*)\s*=>\s*(\s*\{[^}]*\}|\s*[^\n;"]+)/g.test(t))return this.__evaluate__(t,r)(...n);else{let[s,...c]=t.split(/\s*,\s*/),a;if(s=this.__evaluate__(s,r),typeof s==="function")a=s;else{if(typeof this[s]!=="function")throw new Error(`Undefined <${s}> handler method`);a=this[s].bind(this)}if(typeof a!=="function")throw new Error(`Expected <${s}> to be a function or handler method`);let l=c.map((o)=>this.__evaluate__(o,r));if(n.length)l=[...l,...n];return a(...l)}}__interpolate__(t,n){return t.replace(/{\s*([^{}]+)\s*}/g,(r,s)=>this.__evaluate__(s,n))}__attachEvent__(t,n,r,s){t.on(n,(...c)=>this.__evaluateFunction__(r,c,s)),this.VER.push({element:t,_event:n}),this.benchmark.inc("domUpdatesCount"),this.benchmark.inc("domRemovalsCount")}__detachEvent__(t,n){t.off(n),this.benchmark.inc("domOperations"),this.benchmark.inc("domRemovalsCount")}__extractTextDeps__(t,n){const r=new Set;return(t.match(/{\s*([^{}]+)\s*}/g)||[]).forEach((s)=>{const c=s.replace(/[{}]/g,"").trim();this.__extractExpressionDeps__(c,n).forEach((a)=>r.add(a))}),Array.from(r)}__extractExpressionDeps__(t,n){const r=/\b(state|input|context)(?:\.[a-zA-Z_]\w*)+(?=\[|\.|$|\s|;|,|\))/g,s=/\b(self)(?:\.[a-zA-Z_]\w*)+(?=\()/g;let c=[...Array.from(t.matchAll(r)),...Array.from(t.matchAll(s))];if(n&&Object.keys(n).length){const a=new RegExp(`\\b(${Object.keys(n).join("|")})`,"g");c=[...c,...Array.from(t.matchAll(a))]}return[...new Set(c.map((a)=>a[0]))]}__isReactive__(t,n){if(/(state|input|context|self)\.[\w.]+/.test(t))return!0;if(n&&Object.keys(n).length&&new RegExp(Object.keys(n).join("|")).test(t))return!0;return!1}__trackDep__(t,n,r){if(r.memo&&r.memo[n]&&r.memo[n].type==="let")r.haslet=!0;!t.has(n)&&t.set(n,new Map),t.get(n)?.set(r.path,r),this.benchmark.inc("dependencyTrackCount")}__valueDep__(t,n){return n.reduce((r,s)=>r?.[s],t)}__shouldUpdate__(t,n,r,s){if(t==="self")return!0;const c=this.__valueDep__(s[t],n),a=this.__valueDep__(r[t],n);return!$t(c,a)}__updateDepNodes__(t,n){if(!this.FGUD?.size)return;this.benchmark.inc("componentUpdateCount"),this.benchmark.startRender(),this.FGUD.forEach((r,s)=>{const[c,...a]=s.split(".");if(!this.__shouldUpdate__(c,a,t,n))return;r.forEach((l)=>{const{path:o,batch:d,$fragment:m,boundaries:b,update:g,memo:V,syntax:N}=l;try{if(!N&&(b?.start&&!document.contains(b.start))||m!==null&&!m.closest("body").length){r.delete(o);return}if(d)this.UQS.queue({dep:s,dependent:l});else{const M=g(V,"main-updator");if(M)typeof M.memo==="object"&&r.set(o,{...l,memo:M.memo}),typeof M.cleanup==="function"&&M.cleanup()}this.benchmark.inc("dependencyUpdateCount")}catch(M){console.error("failed to update dependency nodes --",M);return}}),!r.size&&this.FGUD?.delete(s)}),this.benchmark.endRender()}__updateVarDepNodes__(t,n,r){if(!this.FGUD?.size)return;this.benchmark.inc("partialUpdateCount"),this.benchmark.startRender(),this.FGUD.get(t)?.forEach((s,c)=>{if(!s.haslet||!this.__hasSamePathParent__(c,this.__getPathParent__(n)))return;if(s.memo={...s.memo,...r},s.batch)this.UQS.queue({dep:t,dependent:s});else{const a=s.update(s.memo,"var-partial-updator");typeof a?.cleanup==="function"&&a.cleanup()}}),this.benchmark.endRender()}appendTo(t){const n=typeof t=="string"?Q.default(t):t;return this.$?.length&&n.append(this.$),this.benchmark.inc("domOperations"),this}prependTo(t){const n=typeof t=="string"?Q.default(t):t;return this.$?.length&&n.prepend(this.$),this.benchmark.inc("domOperations"),this}replaceWith(t){const n=typeof t=="string"?Q.default(t):t;return this.$?.length&&n.replaceWith(this.$),this.benchmark.inc("domOperations"),this}}var fn={};Ft(fn,{state:()=>{return zr},handler:()=>{return Xr},default:()=>{return Hr},declaration:()=>{return qr}});var qr={name:"if",syntax:!0,tags:{"else-if":{type:"nexted",many:!0,optional:!0},else:{type:"nexted",optional:!0}}},zr={renderer:null},Xr={onInput(){if(!this.input.renderer)return;if(this.input.by)this.state.renderer=this.input.renderer;else{let t=!1;if(Array.isArray(this.input["else-if"])&&this.input["else-if"].length)this.input["else-if"].forEach((n)=>{if(t||!n.by)return;this.state.renderer=n.renderer,t=!0});if(!t)this.state.renderer=this.input.else?this.input.else.renderer:null}}},Hr="<{state.renderer}/>",hn={};Ft(hn,{state:()=>{return Qr},handler:()=>{return Jr},default:()=>{return to},declaration:()=>{return Wr},_static:()=>{return Zr}});var Wr={name:"for",syntax:!0,iterator:!0},Qr={argvlist:null},Zr={lastInput:null,processingBatch:!1},Jr={onInput(){if(this.static.processingBatch)return;if(!this.input.renderer)throw new Error("Undefined mesh renderer");let{in:t,from:n,to:r}=this.input;if(t===void 0&&n===void 0)throw new Error("Invalid <for> arguments");this.static.processingBatch=!0;try{if(n!==void 0){if(n=parseFloat(String(n)),r==null)throw new Error("Expected <from> <to> attributes of the for loop to be defined");if(r=parseFloat(String(r)),n===r)throw new Error("<from> and <to> attribute cannot have the same value");const s=n<r,c=Math.abs(r-n)+1;if(this.state.argvlist&&Array.isArray(this.state.argvlist)&&this.state.argvlist.length===c){const[l]=this.input.renderer.argv;if(l){let o=n,d=!0;for(let m=0;m<this.state.argvlist.length;m++){if(this.state.argvlist[m][l].value!==o){d=!1;break}o=s?o+1:o-1}if(d)return;o=n;for(let m=0;m<this.state.argvlist.length;m++)this.state.argvlist[m][l].value=o,o=s?o+1:o-1;return}}const a=[];for(let l=n;s?l<=r:l>=r;s?l++:l--){const o={},[d]=this.input.renderer.argv;if(d)o[d]={value:l,type:"arg"};a.push(o)}this.state.argvlist=a}else if(Array.isArray(t)){if(this.state.argvlist&&this.static.lastInput&&this.input.in===this.static.lastInput)return;if(!t.length){console.warn("empty for loop <in> attribute Array value"),this.state.argvlist=[];return}if(this.static.lastInput=t,this.state.argvlist&&Array.isArray(this.state.argvlist)&&this.state.argvlist.length===t.length){const[a,l]=this.input.renderer.argv;for(let o=0;o<t.length;o++){const d=this.state.argvlist[o];if(a)d[a].value=t[o]}return}const s=[];let c=0;for(let a of t){const l={},[o,d]=this.input.renderer.argv;if(o)l[o]={value:a,type:"arg"};if(d)l[d]={value:c,type:"arg"};s.push(l),c++}this.state.argvlist=s}else if(t instanceof Map){if(this.state.argvlist&&this.static.lastInput&&this.input.in===this.static.lastInput)return;if(!t.size){console.warn("empty for loop <in> attribute Map value"),this.state.argvlist=[];return}if(this.static.lastInput=t,this.state.argvlist&&Array.isArray(this.state.argvlist)&&this.state.argvlist.length===t.size){const[a,l,o]=this.input.renderer.argv;let d=0;for(let[m,b]of t){const g=this.state.argvlist[d];if(a)g[a].value=m;if(l)g[l].value=b;d++}return}const s=[];let c=0;for(let[a,l]of t){const o={},[d,m,b]=this.input.renderer.argv;if(d)o[d]={value:a,type:"arg"};if(m)o[m]={value:l,type:"arg"};if(b)o[b]={value:c,type:"arg"};s.push(o),c++}this.state.argvlist=s}else if(typeof t=="object"){if(this.state.argvlist&&this.static.lastInput&&this.input.in===this.static.lastInput)return;if(!Object.keys(t).length){console.warn("empty for loop <in> attribute Object value"),this.state.argvlist=[];return}this.static.lastInput=t;const s=Object.keys(t);if(this.state.argvlist&&Array.isArray(this.state.argvlist)&&this.state.argvlist.length===s.length){const[l,o,d]=this.input.renderer.argv;for(let m=0;m<s.length;m++){const b=s[m],g=this.state.argvlist[m];if(l)g[l].value=b;if(o)g[o].value=t[b]}return}const c=[];let a=0;for(let l in t){const o={},[d,m,b]=this.input.renderer.argv;if(d)o[d]={value:l,type:"arg"};if(m)o[m]={value:t[l],type:"arg"};if(b)o[b]={value:a,type:"arg"};c.push(o),a++}this.state.argvlist=c}}finally{this.static.processingBatch=!1}},updateItems(t){if(!this.input.renderer)throw new Error("Undefined mesh renderer");if(!Array.isArray(t)||!this.state.argvlist)return;this.static.processingBatch=!0;try{const[n]=this.input.renderer?.argv;if(!n)return;for(let{index:r,value:s}of t)if(r>=0&&r<this.state.argvlist.length)this.state.argvlist[r][n].value=s}finally{this.static.processingBatch=!1}},updateProperty(t,n){if(!this.input.renderer)throw new Error("Undefined mesh renderer");if(!this.state.argvlist)return;this.static.processingBatch=!0;try{for(let r=0;r<this.state.argvlist.length;r++){const s=this.state.argvlist[r];if(s[t])s[t].value=typeof n==="function"?n(s[t].value,r):n}}finally{this.static.processingBatch=!1}}},to="<{input.renderer} #=state.argvlist/>",_n={};Ft(_n,{state:()=>{return no},handler:()=>{return ro},default:()=>{return oo},declaration:()=>{return eo}});var eo={name:"async",syntax:!0,tags:{then:{type:"child"},catch:{type:"child",optional:!0},loading:{type:"child",optional:!0}}},no={renderer:null,props:{}},ro={onInput(){if(!this.input.await)throw new Error("Undefined async <await> attribute");if(!(this.input.await instanceof Promise))throw new Error("Expected async <await> attribute value to be a function");if(this.input.loading)this.state.renderer=this.input.loading.renderer,this.state.props={};this.input.await.then((t)=>{if(!this.input.then)return;this.state.renderer=this.input.then.renderer;const[n]=this.input.then.renderer.argv;this.state.props={[n]:{value:t,type:"arg"}}}).catch((t)=>{if(!this.input.catch)return;this.state.renderer=this.input.catch.renderer;const[n]=this.input.then.renderer.argv;this.state.props={[n]:{value:t,type:"arg"}}})}},oo="<{state.renderer} #=state.props/>",mn={};Ft(mn,{state:()=>{return so},handler:()=>{return uo},default:()=>{return ao},declaration:()=>{return io}});var io={name:"switch",syntax:!0,tags:{case:{type:"child",many:!0},default:{type:"child"}}},so={renderer:null},uo={onInput(){let t=[];for(let n of this.input.case)if(n.is==this.input.by||Array.isArray(n.is)&&n.is.includes(this.input.by))Array.isArray(n.is)?t=[...new Set([...t,...n.is])]:t.push(n.is),this.state.renderer=n.renderer;if(!t.includes(this.input.by))this.state.renderer=this.input.default?this.input.default.renderer:null}},ao="<{state.renderer}/>",vn={};Ft(vn,{state:()=>{return lo},handler:()=>{return ho},default:()=>{return _o},context:()=>{return fo},_static:()=>{return po}});var co=function(t){const n={};return t.split("&").map((r)=>{const[s,c]=r.split("=");n[s]=c}),n},lo={page:null,params:{},query:{}},po={global:!1,routes:[],defaultPath:null,currentPath:null,currentRoute:null},fo=["navigate"],ho={onInput(){if(!this.input.routes)return;if(this.input.global)this.static.global=this.input.global;if(this.static.routes=this.input.routes.map(({path:t,template:n,default:r})=>{if(r)this.static.defaultPath=t;const s=t.match(/:[^\/]*(\/|$)/gi)||[],c=t.replaceAll("/","\\/").replaceAll(/:[^\/]*(\/|$)/gi,"([^\\/]+)(?:\\/|$)");return{path:t,template:n,default:r,pathVars:s,pathRegex:new RegExp(`${c}$`,"i")}}),this.input.global){const t=window.location.pathname;this.static.defaultPath=this.static.defaultPath&&t=="/"&&t!==this.static.defaultPath?this.static.defaultPath:t?t+window.location.search:this.static.routes[0].path}},onAttach(){if(this.input.global)window.navigate=this.navigate.bind(this),window.addEventListener("popstate",(t)=>t.state&&this.navigate(t.state.path,!0));this.setContext("navigate",this.navigate.bind(this)),this.static.defaultPath&&this.navigate(this.static.defaultPath)},navigate(t,n){!n&&this.static.global&&history.pushState({path:t},"",t);const r=t.split("?");t=r[0];const s=r[1]?co(r[1]):{};let c=null;if(this.static.currentRoute)c={path:this.static.currentRoute.path,params:this.state.params},this.emit("before",{fromState:c,toState:{path:t,query:s}});const a=this.match(t);if(!a){this.static.currentRoute=null,this.state.params={},this.state.query={},this.emit("not-found",t);return}const{route:l,params:o}=a;this.emit("after",{fromState:c,toState:{path:l.path,params:o,query:s}}),this.static.currentPath=t,this.static.currentRoute=l,this.state.params=o,this.state.query=s,this.state.page=l.template},match(t){const n={};let r=!1;for(let s of this.static.routes){const{pathVars:c,pathRegex:a}=s,l=t.match(a);if(l!==null&&l.index===0){for(let o=0;o+1<l.length&&o<c.length;o++)n[c[o].replaceAll(/[\/:]/g,"")]=l[o+1];r=s;break}}return r?{route:r,params:n}:!1}},_o="<{state.page} params=state.params query=state.query/>";class Ce{debug=!1;store={};__root;i18n=new We;watcher;IUC;__setContext;__getContext;constructor(t){if(t?.debug)this.debug=t.debug;this.watcher=new Je,this.IUC=new Ze;const[n,r]=zt(t?.context||{});this.__setContext=r,this.__getContext=n,this.register("if",fn),this.register("for",hn),this.register("async",_n),this.register("switch",mn),this.register("router",vn)}register(t,n){return this.store[t]=n,this}unregister(t){return delete this.store[t],this}has(t){return t in this.store}import(t){if(!this.has(t))throw new Error(`<${t}> component not found`);if(!this.store[t].declaration?.syntax&&!this.store[t].default)throw new Error(`Invalid <${t}> component`);return this.store[t]}render(t,n,r){const{default:s,...c}=n,a={debug:this.debug,prepath:"0",lips:this},l=new Ee(t,s||"",{...c,input:r},a);return window.addEventListener("beforeunload",()=>{return this.dispose(),l.destroy(),null}),window.addEventListener("pagehide",(o)=>{!o.persisted&&this.dispose()}),document.addEventListener("visibilitychange",()=>{if(document.visibilityState!=="hidden")return;this.IUC.prepareForPotentialUnload()}),l}root(t,n){return this.__root=this.render("__ROOT__",t),this.__root.appendTo(n),this.__root}language(t){this.i18n.setLang(t)&&this.__root?.rerender()}setContext(t,n){const r=this.__getContext();if(typeof t==="string"){const s={...r,[t]:n};st(r,s)&&this.__setContext(s)}else if(!Array.isArray(t)){const s={...r,...t};st(r,s)&&this.__setContext(s)}else throw new Error("Invalid context data")}getContext(){return this.__getContext()}useContext(t,n){if(!t.length)return;dn(()=>{const r=this.__getContext();if(!r)return;const s=Object.fromEntries(t.map((c)=>[c,r[c]]));s&&typeof n==="function"&&Object.keys(s).length&&n(s)})}dispose(){this.watcher?.dispose(),this.__root?.destroy()}}var bn={Undo:"Undo",Redo:"Redo",Reinitialize:"Reinitialize",Settings:"Settings",Link:"Link","Device Screens":{"*":"Device Screens",UK:"Media Devices"},Bold:"Bold",Count:"Count"};var yn={Undo:"Annuler",Redo:"Refaire",Reinitialize:"R\xE9initialiser",Settings:"Param\xEAtre",Link:"Lien","Device Screens":"Dispositifs",Bold:"Gras",Button:"Bouton",Count:"Compter"};var Pt=new Ce;Pt.setContext({lang:"en-US",online:!0,getUser(t){return new Promise((n,r)=>{setTimeout(()=>n({name:t,email:"g.peter@mail.com"}),3000)})}});Pt.i18n.setDictionary("en",bn);Pt.i18n.setDictionary("fr",yn);Ge(Pt);Pt.root(fe,"body");setTimeout(()=>{Pt.setContext("online",!1)},5000);setTimeout(()=>window.navigate("/account?userid=1001"),2000);setTimeout(()=>window.navigate("/account?userid=20"),5000);setTimeout(()=>Pt.getContext().navigate("/product/00009?category=phone"),8000);

//# debugId=EDD84E32B48334C464756e2164756e21
